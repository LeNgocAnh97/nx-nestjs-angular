"use strict";(self.webpackChunkapps_flash_sale=self.webpackChunkapps_flash_sale||[]).push([[3571],{3571:(O,S,s)=>{s.r(S),s.d(S,{IcomLibsProductDetailComponent:()=>lt});var p=s(5861),e=s(5879),a=s(95),m=s(5545),v=s(3802),x=s(9364),f=s(2840),M=s(3599),b=s(6814),Z=s(8083),d=s(6254),A=s(2574),h=s(9382),_=s(2595),c=s(1659),k=s(5891),T=s(3304),U=s(2962),Q=s(6987);let C=(()=>{class i{ngOnInit(){console.log(this.product),this.product.created_at&&(this.product.created_at_format=T(this.product.created_at).format("DD/MM/YYYY HH:mm"),this.product.updated_at_format=T(this.product.updated_at).format("DD/MM/YYYY HH:mm"))}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-history"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:20,vars:6,consts:[["nzTitle","History",2,"width","300px"],[2,"color","#8b8b8b"],["nzType","vertical"]],template:function(o,n){1&o&&(e.TgZ(0,"nz-card",0)(1,"p")(2,"span",1),e._uU(3,"Creator:\xa0"),e.qZA(),e._uU(4),e.qZA(),e._UZ(5,"nz-divider",2),e.TgZ(6,"p")(7,"span",1),e._uU(8,"Create Time:\xa0"),e.qZA(),e._uU(9),e.qZA(),e._UZ(10,"nz-divider",2),e.TgZ(11,"p")(12,"span",1),e._uU(13,"Updater:\xa0"),e.qZA(),e._uU(14),e.qZA(),e._UZ(15,"nz-divider",2),e.TgZ(16,"p")(17,"span",1),e._uU(18,"Update Time:\xa0"),e.qZA(),e._uU(19),e.qZA()()),2&o&&(e.xp6(4),e.AsE(" [",null==n.product||null==n.product.creator_info?null:n.product.creator_info.customer_id,"] ",null==n.product||null==n.product.creator_info?null:n.product.creator_info.full_name," "),e.xp6(5),e.hij(" ",(null==n.product?null:n.product.created_at_format)||(null==n.product?null:n.product.created_at),""),e.xp6(5),e.AsE(" [",null==n.product||null==n.product.updater_info?null:n.product.updater_info.customer_id,"] ",null==n.product||null==n.product.updater_info?null:n.product.updater_info.full_name,""),e.xp6(5),e.hij(" ",(null==n.product?null:n.product.updated_at_format)||(null==n.product?null:n.product.updated_at),""))},dependencies:[U.vh,U.bd,Q.S,Q.g],encapsulation:2})}return i})();function Y(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-history",3),2&i){const t=e.oxw();e.Q6J("product",t.product)}}let H=(()=>{class i{constructor(){this.productService=(0,e.f3M)(c.k)}ngOnInit(){this.product&&(this.product.date_range=[T(this.product.start_time).toDate(),T(this.product.end_time).toDate()])}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-general"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[[1,"flex","w-full","h-full","justify-between"],[1,"w-full","mr-4",3,"model"],[3,"product",4,"ngIf"],[3,"product"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"icom-libs-product-add_edit",1),e.YNc(2,Y,1,1,"icom-libs-product-detail-history",2),e.qZA()),2&o&&(e.xp6(1),e.Q6J("model",n.product),e.xp6(1),e.Q6J("ngIf",n.product))},dependencies:[k.IcomLibsProductAddEditComponent,C,b.O5],encapsulation:2})}return i})();var w=s(9717),P=s(6990),z=s(7398),u=s(708),y=s(2669),D=s(855),L=s(1958);function F(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handlerSave(n))}),e._uU(2," Submit "),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handlerCancel(n))}),e._uU(4," Cancel "),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("nzLoading",t.isLoading)("nzType","primary")}}function R(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.toggleDisabled())}),e._uU(2," Edit "),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("nzType","primary"))}function G(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-history",13),2&i){const t=e.oxw(2);e.Q6J("product",t.model)}}function q(i,l){if(1&i&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4),e._UZ(3,"formly-form",5),e.TgZ(4,"div",6),e.YNc(5,F,5,2,"div",7),e.YNc(6,R,3,1,"div",7),e.qZA()()(),e.YNc(7,G,1,1,"icom-libs-product-detail-history",8),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled)),e.xp6(1),e.Q6J("ngIf",null==t.options||null==t.options.formState?null:t.options.formState.disabled),e.xp6(1),e.Q6J("ngIf",null==t.model?null:t.model.id)}}function j(i,l){1&i&&e._UZ(0,"nz-spin",14),2&i&&e.Q6J("nzSize","large")}let X=(()=>{class i{constructor(){this.form=new a.cw({}),this.options={formState:{disabled:!0}},this.fields=[],this.productService=(0,e.f3M)(c.k),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.model={subpool_id:0,pool_id:8},this.fields=[{key:"payment_method",type:"select-custom",props:{label:"Payment Method",classInclude:"w-[300px]",placeholder:"Select Payment Method",viewValue:"name",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("PAYMENT_METHOD").pipe((0,z.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"sale_price",type:"input",className:"",props:{label:"Sale price",required:!0,type:"number"},validators:["iniMin0"],expressions:{"props.disabled":"formState.disabled"}},{key:"purchase_cost",type:"input",className:"basis-6/12 ml-4",props:{label:"Purchase cost",required:!0,type:"number"},validators:["iniMin0"],expressions:{"props.disabled":"formState.disabled"}},{key:"pool_id",className:"basis-4/12",type:"select-custom",props:{placeholder:"Select Pool",label:"Pool",viewValue:"id",labelProp:"id",valueProp:"id",classInclude:"w-[300px]",required:!0,options:[{id:8,name:"Pool"}]},expressions:{"props.disabled":"formState.disabled"}},{key:"subpool_id",type:"select-custom",className:"basis-4/12 ml-4",props:{label:"Sub Pool",placeholder:"Select Sub Pool",viewValue:"id",required:!0,classInclude:"w-[300px]",labelProp:"id",valueProp:"id",options:[{id:0,name:"Sub Pool"}]},expressions:{"props.disabled":"formState.disabled"}}]}ngOnInit(){var t=this;return(0,p.Z)(function*(){try{t.loadingIndicator=!0,t.model=yield(0,u.n)(t.productService.getProductPrice(t.product?.id)),t.modelOrigin=(0,P.cloneDeep)(t.model)}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerSave(t){var o=this;return(0,p.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(r=>{o.form.controls[r].touched=!0});o.isLoading=!0,o.cdr.detectChanges(),o.form.markAsTouched(),o.form.submitted=!0;const n={...o.model};if(n.id)return yield(0,u.n)(o.productService.updateProductPrice(n)),o.IComMessageService.showAlertMessageDone("Edit product price success"),o.modelOrigin=(0,P.cloneDeep)(o.model),void o.toggleDisabled();yield(0,u.n)(o.productService.createProductPrice(n)),o.modelOrigin=(0,P.cloneDeep)(o.model),o.IComMessageService.showAlertMessageError("Edit product price success")}catch(n){o.IComMessageService.showAlertMessageError(n?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}})()}handlerCancel(t){t.stopPropagation(),t.preventDefault(),this.toggleDisabled(),this.form.reset(this.modelOrigin)}toggleDisabled(){this.options.formState.disabled=!this.options.formState.disabled}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-price"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","pt-4","bg-white","border","rounded-md"],["nz-form","",3,"formGroup"],[3,"model","fields","options","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],["nz-col","",1,"search-area","flex"],["nz-button","",3,"nzLoading","nzType","click"],["nz-button","",1,"ml-4",3,"click"],["nz-button","",3,"nzType","click"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(o,n){1&o&&(e.YNc(0,q,8,8,"div",0),e.YNc(1,j,1,1,"nz-spin",1)),2&o&&(e.Q6J("ngIf",!n.loadingIndicator),e.xp6(1),e.Q6J("ngIf",n.loadingIndicator))},dependencies:[v.u,a.UX,a._Y,a.JL,a.sg,m.X0,m.T7,f.sL,f.ix,D.w,L.dQ,b.O5,C,y.j,y.W],encapsulation:2})}return i})();function K(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handlerSave(n))}),e._uU(2," Submit "),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handlerCancel(n))}),e._uU(4," Cancel "),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("nzLoading",t.isLoading)("nzType","primary")}}function B(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.toggleDisabled())}),e._uU(2," Edit "),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("nzType","primary"))}function V(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-history",13),2&i){const t=e.oxw(2);e.Q6J("product",t.model)}}function W(i,l){if(1&i&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4),e._UZ(3,"formly-form",5),e.TgZ(4,"div",6),e.YNc(5,K,5,2,"div",7),e.YNc(6,B,3,1,"div",7),e.qZA()()(),e.YNc(7,V,1,1,"icom-libs-product-detail-history",8),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled)),e.xp6(1),e.Q6J("ngIf",null==t.options||null==t.options.formState?null:t.options.formState.disabled),e.xp6(1),e.Q6J("ngIf",null==t.model?null:t.model.id)}}function $(i,l){1&i&&e._UZ(0,"nz-spin",14),2&i&&e.Q6J("nzSize","large")}let ee=(()=>{class i{constructor(){this.form=new a.cw({}),this.fields=[],this.options={formState:{disabled:!0}},this.productService=(0,e.f3M)(c.k),this.IComMessageService=(0,e.f3M)(w.Q),this.changeDetectorRef=(0,e.f3M)(e.sBO),this.model={},this.fields=[{key:"voucher_type",type:"select-custom",templateOptions:{label:"Voucher Type",placeholder:"Select Voucher Type",classInclude:"w-[300px]",viewValue:"name",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("VOUCHER_TYPE").pipe((0,z.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"voucher_value",type:"input",className:"",expressions:{"props.disabled":"formState.disabled"},props:{label:"Voucher Value",type:"number",min:0}},{key:"expiry_policy",className:"basis-4/12",type:"select-custom",props:{placeholder:"Select Expiry policy",label:"Expiry policy",viewValue:"name",classInclude:"w-[300px]",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("VOUCHER_PROPERTY_EXPIRY_POLICY").pipe((0,z.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"expiry_date",type:"date",props:{label:"Expiry date",ShowTime:!0,required:!0,format:"dd-MM-yyyy HH:mm"},expressions:{"props.disabled":"formState.disabled"},hideExpression:t=>!t?.expiry_policy||"EXPIRY_DATE_FP"!==t?.expiry_policy},{key:"expiry_param",type:"input",className:"basis-6/12 ml-4",props:{label:"Expiry param",required:!0,type:"number"},hideExpression:t=>!t?.expiry_policy||"EXPIRY_DATE_NE"===t?.expiry_policy||"EXPIRY_DATE_SDED"===t?.expiry_policy||"EXPIRY_DATE_FP"===t?.expiry_policy,expressions:{"props.disabled":"formState.disabled"}}]}ngOnInit(){var t=this;return(0,p.Z)(function*(){try{t.loadingIndicator=!0,t.model=yield(0,u.n)(t.productService.getProductProperties(t.product?.id)),t.modelOrigin=(0,P.cloneDeep)(t.model)}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message)}finally{t.loadingIndicator=!1,t.changeDetectorRef.detectChanges()}})()}handlerSave(t){var o=this;return(0,p.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(r=>{o.form.controls[r].touched=!0});o.form.markAsTouched(),o.form.submitted=!0;const n={...o.model};if(o.isLoading=!0,o.changeDetectorRef.detectChanges(),n.id)return yield(0,u.n)(o.productService.updateProductProperties(n)),o.toggleDisabled(),o.IComMessageService.showAlertMessageDone("Edit product properties success"),o.isLoading=!1,void o.changeDetectorRef.detectChanges();delete n.id,yield(0,u.n)(o.productService.createProductProperties(n)),o.isLoading=!1,o.changeDetectorRef.detectChanges(),o.IComMessageService.showAlertMessageDone("Add product properties success")}catch(n){o.IComMessageService.showAlertMessageError(n?.error?.error_message)}finally{o.isLoading=!1,o.changeDetectorRef.detectChanges()}})()}handlerCancel(t){t.stopPropagation(),t.preventDefault(),this.toggleDisabled(),this.form.reset(this.modelOrigin)}toggleDisabled(){this.options.formState.disabled=!this.options.formState.disabled}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-properties"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","bg-white","border","pt-4","rounded-md"],["nz-form","",3,"formGroup"],[3,"model","fields","options","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],["nz-col","",1,"search-area","flex"],["nz-button","",3,"nzLoading","nzType","click"],["nz-button","",1,"ml-4",3,"click"],["nz-button","",3,"nzType","click"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(o,n){1&o&&(e.YNc(0,W,8,8,"div",0),e.YNc(1,$,1,1,"nz-spin",1)),2&o&&(e.Q6J("ngIf",!n.loadingIndicator),e.xp6(1),e.Q6J("ngIf",n.loadingIndicator))},dependencies:[v.u,a.UX,a._Y,a.JL,a.sg,m.X0,m.T7,f.sL,f.ix,D.w,L.dQ,b.O5,C,y.j,y.W],encapsulation:2,changeDetection:0})}return i})();const te=(i,l)=>[{prop:"",cellTemplate:i,sortable:!1,width:40},{prop:"",cellTemplate:l,sortable:!1,width:40},{prop:"language",width:200,sortable:!1},{prop:"name",width:300,sortable:!1},{prop:"description",width:300,sortable:!1}];var N=s(1221),J=s(1567);const ie=["statusRef"],ne=["removeRef"];function re(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.handlerAdd())}),e._uU(2," Add New "),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("nzType","primary"))}function le(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",17)(1,"button",18),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.handlerSave(n))}),e._uU(2," Save "),e.qZA(),e.TgZ(3,"button",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.handlerCancel())}),e._uU(4," Cancel "),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("nzType","primary")("nzLoading",t.isLoading)}}function se(i,l){if(1&i&&(e.ynx(0),e.TgZ(1,"form",12,13),e._UZ(3,"formly-form",14),e.qZA(),e.TgZ(4,"div",15),e.YNc(5,le,5,2,"div",16),e.qZA(),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("model",t.modelForm)("fields",t.fields)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled))}}const ae=function(){return[]};function ce(i,l){if(1&i&&(e.TgZ(0,"div",20),e._UZ(1,"ngx-datatable",21),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("rows",t.rows)("columns",t.configTable.columns||e.DdM(7,ae))("headerHeight",t.configTable.headerHeight||50)("columnMode","standard")("rowHeight",t.configTable.rowHeight||50)("scrollbarH",!0)("loadingIndicator",t.loadingIndicator)}}function de(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-history",22),2&i){const t=e.oxw(2);e.Q6J("product",t.modelForm)}}function ue(i,l){if(1&i&&(e.TgZ(0,"div",4)(1,"div",5),e.YNc(2,re,3,1,"div",6),e.YNc(3,se,6,5,"ng-container",7),e.YNc(4,ce,2,8,"div",8),e.qZA(),e.YNc(5,de,1,1,"icom-libs-product-detail-history",9),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",t.isAddNew),e.xp6(1),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",null==t.modelForm?null:t.modelForm.id)}}function pe(i,l){1&i&&e._UZ(0,"nz-spin",23),2&i&&e.Q6J("nzSize","large")}function me(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(n){const g=e.CHM(t).row,I=e.oxw();return e.KtG(I.handlerEdit(n,g))}),e._UZ(1,"i",25),e.qZA()}}function fe(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(n){const g=e.CHM(t).row,I=e.oxw();return e.KtG(I.handlerRemove(n,g))}),e._UZ(1,"span",26),e.qZA()}}let _e=(()=>{class i{constructor(t){this.router=t,this.form=new a.cw({}),this.options={},this.fields=[],this.productService=(0,e.f3M)(c.k),this.modalService=(0,e.f3M)(N.Sf),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.modelForm={}}ngOnInit(){this.fields=[{key:"name",type:"input",props:{label:"Name",placeholder:"Enter Name",type:"string",required:!0}},{key:"description",type:"input",props:{label:"Description",placeholder:"Enter Description",type:"string",required:!0}},{key:"language",type:"select-custom",templateOptions:{label:"Language",placeholder:"Select Language",viewValue:"name",labelProp:"name",required:!0,valueProp:"code",options:[{code:"vi",name:"Vietnamese"},{code:"en",name:"English"}]}},{key:"detail",type:"quill-editor",props:{label:"Detail",placeholder:"Enter Content",type:"string",required:!0}},{key:"term_and_condition",type:"quill-editor",props:{label:"Term and condition",placeholder:"Enter Content",type:"string",required:!0}}],this.configTable={loadingIndicator:!0,columns:te(this.statusRef,this.removeRef),headerHeight:50,rowHeight:"auto",pageLimit:10},this.loadPage()}loadPage(){var t=this;return(0,p.Z)(function*(){try{t.loadingIndicator=!0;const o=yield(0,u.n)(t.productService.getProductLanguage(t.product?.id||""));if(o&&o.data&&o.data){const n=[...o.data.items||[]];t.rows=n}}catch(o){console.log(o)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerAdd(){this.isAddNew=!this.isAddNew}handlerCancel(){this.isAddNew=!1,this.modelForm={}}handlerSave(t){var o=this;return(0,p.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(r=>{o.form.controls[r].touched=!0});o.form.markAsTouched(),o.form.submitted=!0;const n={product_id:o.product?.id,...o.modelForm};if(o.isLoading=!0,o.cdr.detectChanges(),!n.id)return delete n.id,o.rows?.some(g=>g.language==n.language)?void o.IComMessageService.showAlertMessageError("Record exist in table"):void o.productService.addLanguageProduct(n).subscribe(()=>{o.IComMessageService.showAlertMessageDone("Add language success"),o.handlerCancel(),o.loadPage()});yield(0,u.n)(o.productService.updateLanguageProduct(o.modelForm)),o.IComMessageService.showAlertMessageDone("Edit language success"),o.handlerCancel(),o.loadPage()}catch(n){o.IComMessageService.showAlertMessageError(n?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}})()}handlerEdit(t,o){t.stopPropagation(),this.modelForm=o,this.isAddNew=!0}handlerRemove(t,o){t.stopPropagation(),this.modalService.confirm({nzTitle:"Are you sure delete this product?",nzContent:`<b style="color: red;">${o.name}</b>`,nzOkText:"Delete",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDelete.bind(this,o),nzCancelText:"Cancel"},"error")}processDelete(t){return(0,u.n)(this.productService.deleteProductLanguage(t.id||"")).then(()=>{this.IComMessageService.showAlertMessageDone("Delete language success"),this.loadPage()}).catch(o=>{this.IComMessageService.showAlertMessageError(o?.error?.error_message)})}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(J.F0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-language"]],viewQuery:function(o,n){if(1&o&&(e.Gf(ie,7),e.Gf(ne,7)),2&o){let r;e.iGM(r=e.CRH())&&(n.statusRef=r.first),e.iGM(r=e.CRH())&&(n.removeRef=r.first)}},inputs:{fields:"fields",rows:"rows",product:"product"},standalone:!0,features:[e.jDz],decls:6,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],["statusRef",""],["removeRef",""],[1,"w-full","h-full","flex"],[1,"mb-4","w-full","h-full","flex","flex-col","bg-white","border","rounded-md"],["class","flex flex-end p-4",4,"ngIf"],[4,"ngIf"],["class","w-full h-full",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],[1,"flex","flex-end","p-4"],["nz-button","",1,"!flex","!items-center",3,"nzType","click"],[1,"overflow-auto","px-4","pt-4",3,"formGroup"],["myForm",""],[3,"model","fields","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["nz-col","",1,"search-area","flex"],["nz-button","",3,"nzType","nzLoading","click"],["nz-button","",1,"ml-4",3,"click"],[1,"w-full","h-full"],[1,"material","expandable","striped","w-full","h-full",3,"rows","columns","headerHeight","columnMode","rowHeight","scrollbarH","loadingIndicator"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"],[1,"name-container","cursor-pointer",3,"click"],["nz-icon","","nzType","edit","nzTheme","twotone",1,"cursor-pointer"],["nz-icon","","nzType","delete","nzTheme","twotone"]],template:function(o,n){1&o&&(e.YNc(0,ue,6,4,"div",0),e.YNc(1,pe,1,1,"nz-spin",1),e.YNc(2,me,2,0,"ng-template",null,2,e.W1O),e.YNc(4,fe,2,0,"ng-template",null,3,e.W1O)),2&o&&(e.Q6J("ngIf",!n.loadingIndicator),e.xp6(1),e.Q6J("ngIf",n.loadingIndicator))},dependencies:[v.u,a.UX,a._Y,a.JL,a.sg,m.X0,m.T7,f.sL,f.ix,D.w,L.dQ,x.xD,x.nE,b.O5,_.PV,_.Ls,C,y.j,y.W],encapsulation:2})}return i})();var ge=s(5592);const he=(i,l,t)=>[{prop:"",cellTemplate:i,sortable:!1,width:40},{prop:"",cellTemplate:l,sortable:!1,width:40},{prop:"banner",sortable:!1,cellTemplate:t,width:200},{prop:"name",sortable:!1,width:300},{prop:"type",sortable:!1,width:300}];var E=s(1394),be=s(6691);const ye=["statusRef"],xe=["removeRef"],ze=["avatarRef"];function Ie(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.handlerAdd())}),e._uU(2," Add New "),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("nzType","primary"))}function Te(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"nz-upload",21),e.NdJ("nzFileListChange",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.fileList=n)}),e.ynx(1),e.TgZ(2,"p",22),e._UZ(3,"span",23),e.qZA(),e.TgZ(4,"p",24),e._uU(5,"Upload Image"),e.qZA(),e.TgZ(6,"p",25),e._uU(7,"Size can't exceed 2 MB"),e.qZA(),e.BQk(),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("nzMultiple",!1)("nzFileList",t.fileList)("nzBeforeUpload",t.beforeUpload)}}function Ce(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",26)(1,"button",27),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.handlerSave())}),e._uU(2," Save "),e.qZA(),e.TgZ(3,"button",28),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.handlerCancel())}),e._UZ(4,"i",29),e._uU(5," Cancel "),e.qZA()()}if(2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("nzLoading",t.isLoading)("nzType","primary")}}function we(i,l){if(1&i&&(e.TgZ(0,"div",13)(1,"div",14)(2,"form",15,16),e._UZ(4,"formly-form",17),e.qZA()(),e.YNc(5,Te,8,3,"nz-upload",18),e.TgZ(6,"div",19),e.YNc(7,Ce,6,2,"div",20),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("model",t.modelForm)("fields",t.fields)("form",t.form),e.xp6(1),e.Q6J("ngIf",t.isAddNew),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled))}}const Pe=function(){return[]};function De(i,l){if(1&i&&(e.TgZ(0,"div",30),e._UZ(1,"ngx-datatable",31),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("rows",t.rows)("columns",t.configTable.columns||e.DdM(7,Pe))("headerHeight",t.configTable.headerHeight||50)("columnMode","standard")("rowHeight","auto")("scrollbarH",!0)("loadingIndicator",t.loadingIndicator)}}function Le(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-history",32),2&i){const t=e.oxw(2);e.Q6J("product",t.modelForm)}}function Se(i,l){if(1&i&&(e.TgZ(0,"div",5)(1,"div",6),e.YNc(2,Ie,3,1,"div",7),e.YNc(3,we,8,6,"div",8),e.YNc(4,De,2,8,"div",9),e.qZA(),e.YNc(5,Le,1,1,"icom-libs-product-detail-history",10),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",t.isAddNew),e.xp6(1),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",null==t.modelForm?null:t.modelForm.id)}}function Me(i,l){1&i&&e._UZ(0,"nz-spin",33),2&i&&e.Q6J("nzSize","large")}function Ze(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",34),e.NdJ("click",function(n){const g=e.CHM(t).row,I=e.oxw();return e.KtG(I.handlerEdit(n,g))}),e._UZ(1,"i",35),e.qZA()}}function Ae(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",34),e.NdJ("click",function(n){const g=e.CHM(t).row,I=e.oxw();return e.KtG(I.handlerRemove(n,g))}),e._UZ(1,"span",36),e.qZA()}}function Ne(i,l){if(1&i&&(e.TgZ(0,"div",37),e._UZ(1,"img",38),e.qZA()),2&i){const t=l.row;e.xp6(1),e.Q6J("src",t.url,e.LSH)}}let Je=(()=>{class i{constructor(t){this.msg=t,this.form=new a.cw({}),this.options={},this.fileList=[],this.fields=[],this.productService=(0,e.f3M)(c.k),this.modalService=(0,e.f3M)(N.Sf),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.beforeUpload=o=>new ge.y(n=>{const r="image/jpeg"===o.type||"image/png"===o.type;if(!r)return this.msg.error("You can only upload JPG file!"),void n.complete();const g=(o?.size||1)/1024/1024<2;return g?this.fileList&&this.fileList.length?(this.msg.error("Only Post One File"),void n.complete()):(n.next(r&&g),void n.complete()):(this.msg.error("Image must smaller than 2MB!"),void n.complete())}),this.modelForm={}}ngOnInit(){this.fields=(i=>[{key:"name",type:"input",props:{label:"Name",placeholder:"Enter Name",type:"string",required:!0}},{key:"type",type:"select-custom",templateOptions:{label:"Type",placeholder:"Select Type",viewValue:"name",labelProp:"name",required:!0,valueProp:"code",classInclude:"w-[300px]",options:this.productService.getOptionType("MEDIA_TYPE").pipe((0,z.U)(l=>l?.data))}}])(),this.configTable={loadingIndicator:!0,columns:he(this.statusRef,this.removeRef,this.avatarRef),headerHeight:50,rowHeight:"auto",pageLimit:10},this.loadPage()}loadPage(){var t=this;return(0,p.Z)(function*(){try{t.loadingIndicator=!0;const o=yield(0,u.n)(t.productService.getProductMedia(t.product?.id||""));if(o&&o.data&&o.data){const n=[...o.data.items||[]];t.rows=n}}catch(o){console.log(o)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerAdd(){this.isAddNew=!this.isAddNew,this.modelForm={},this.cdr.detectChanges()}handlerCancel(){this.isAddNew=!1,this.modelForm={},this.fileList=[],this.cdr.detectChanges()}handlerSave(){var t=this;return(0,p.Z)(function*(){try{if(!t.form.valid)return void Object.keys(t.form.controls).forEach(o=>{t.form.controls[o].touched=!0});t.form.markAsTouched(),t.form.submitted=!0,t.processUpload()}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message||"Upload Media Failed")}finally{t.isLoading=!1,t.cdr.detectChanges()}})()}processUpload(){var t=this;return(0,p.Z)(function*(){const o=new FormData;t.fileList[0]?.originFileObj&&o.append("image",t.fileList[0].originFileObj);const n={product_id:t.product?.id,...t.modelForm};t.isLoading=!0,t.cdr.detectChanges();let r=null;try{if(t.fileList[0]?.originFileObj&&(r=yield(0,u.n)(t.productService.uploadMediaProduct(o))),!n.id)return delete n.id,n.url=r.data?.path||"",yield(0,u.n)(t.productService.addMediaProduct(n)),t.IComMessageService.showAlertMessageDone("Add media success"),t.handlerCancel(),void t.loadPage();n.url=r?.data?.path||n?.url,yield(0,u.n)(t.productService.updateMediaProduct(n)),t.IComMessageService.showAlertMessageDone("Edit media success"),t.handlerCancel(),t.loadPage()}catch(g){t.IComMessageService.showAlertMessageError(g?.error?.error_message||"Upload media fail")}})()}handlerEdit(t,o){t.stopPropagation(),this.modelForm=o,this.fileList=[{uid:"-1",name:"Img",status:"done",url:this.modelForm.url,thumbUrl:this.modelForm.url}],this.isAddNew=!0,this.cdr.detectChanges()}handlerRemove(t,o){t.stopPropagation(),this.modalService.confirm({nzTitle:"Are you sure delete this media?",nzContent:`<b style="color: red;">${o.name}</b>`,nzOkText:"Delete",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDelete.bind(this,o),nzCancelText:"Cancel"},"error")}processDelete(t){return(0,u.n)(this.productService.deleteProductMedia(t.id||"")).then(()=>{this.IComMessageService.showAlertMessageDone("Delete media success"),this.loadPage()}).catch(o=>{this.IComMessageService.showAlertMessageError(o?.error?.error_message||"Delete Fail")})}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(be.dD))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-media"]],viewQuery:function(o,n){if(1&o&&(e.Gf(ye,7),e.Gf(xe,7),e.Gf(ze,7)),2&o){let r;e.iGM(r=e.CRH())&&(n.statusRef=r.first),e.iGM(r=e.CRH())&&(n.removeRef=r.first),e.iGM(r=e.CRH())&&(n.avatarRef=r.first)}},inputs:{fields:"fields",rows:"rows",product:"product"},standalone:!0,features:[e.jDz],decls:8,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],["statusRef",""],["removeRef",""],["avatarRef",""],[1,"w-full","h-full","flex"],[1,"mb-4","w-full","h-full","flex","flex-col","pr-4","pt-4","bg-white","border","rounded-md","overflow-hidden"],["class","flex flex-end pl-4",4,"ngIf"],["class","flex w-full h-full flex-col",4,"ngIf"],["class","w-full h-full mt-4",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],[1,"flex","flex-end","pl-4"],["nz-button","",1,"!flex","!items-center",3,"nzType","click"],[1,"flex","w-full","h-full","flex-col"],[1,""],[1,"mt-4",3,"formGroup"],["myForm",""],[3,"model","fields","form"],["class","ml-4 h-full basis-1/2 upload-list-inline flex flex-col","nzType","drag","nzListType","picture",3,"nzMultiple","nzFileList","nzBeforeUpload","nzFileListChange",4,"ngIf"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["nzType","drag","nzListType","picture",1,"ml-4","h-full","basis-1/2","upload-list-inline","flex","flex-col",3,"nzMultiple","nzFileList","nzBeforeUpload","nzFileListChange"],[1,"ant-upload-drag-icon"],["nz-icon","","nzType","inbox"],[1,"ant-upload-text"],[1,"ant-upload-hint"],["nz-col","",1,"search-area","flex"],["nz-button","",1,"!flex","!items-center",3,"nzLoading","nzType","click"],["nz-button","",1,"ml-4","!flex","!items-center",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[1,"w-full","h-full","mt-4"],[1,"material","expandable","striped","w-full","h-full",3,"rows","columns","headerHeight","columnMode","rowHeight","scrollbarH","loadingIndicator"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"],[1,"name-container","cursor-pointer",3,"click"],["nz-icon","","nzType","edit","nzTheme","twotone",1,"cursor-pointer"],["nz-icon","","nzType","delete","nzTheme","twotone"],[1,"name-container","cursor-pointer"],["width","200","height","100",3,"src"]],template:function(o,n){1&o&&(e.YNc(0,Se,6,4,"div",0),e.YNc(1,Me,1,1,"nz-spin",1),e.YNc(2,Ze,2,0,"ng-template",null,2,e.W1O),e.YNc(4,Ae,2,0,"ng-template",null,3,e.W1O),e.YNc(6,Ne,2,1,"ng-template",null,4,e.W1O)),2&o&&(e.Q6J("ngIf",!n.loadingIndicator),e.xp6(1),e.Q6J("ngIf",n.loadingIndicator))},dependencies:[v.u,a.UX,a._Y,a.JL,a.sg,m.X0,m.T7,f.sL,f.ix,D.w,L.dQ,x.xD,x.nE,b.O5,_.PV,_.Ls,E.cS,E.FY,C,y.j,y.W],encapsulation:2})}return i})();const Ee=["statusRef"],Oe=["removeRef"];function ke(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",6),e._UZ(1,"formly-form",7),e.TgZ(2,"div",8)(3,"div",9)(4,"button",10),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.handlerSave(n))}),e._uU(5," Submit "),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(3),e.Q6J("nzType","primary")("nzLoading",t.isLoading)}}const Ye=function(){return[]};let He=(()=>{class i{constructor(t){this.router=t,this.form=new a.cw({}),this.options={},this.fields=[],this.productService=(0,e.f3M)(c.k),this.iComLibsServicesInventoryService=(0,e.f3M)(c.NH),this.modalService=(0,e.f3M)(N.Sf),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.model={}}ngOnInit(){this.fields=(i=>[{key:"inventory_id",type:"select-custom",templateOptions:{label:"Inventory",placeholder:"Select Inventory",viewValue:"name",labelProp:"name",required:!0,valueProp:"id",options:this.iComLibsServicesInventoryService.searchInventory().pipe((0,z.U)(l=>l?.data?.items))}}])(),this.configTable={loadingIndicator:!0,columns:[{prop:"name",sortable:!1},{prop:"type",sortable:!1},{prop:"sold_stock",sortable:!1,name:"Quantity Sold"},{prop:"in_stock",sortable:!1,name:"Quantity Available"},{prop:"total_stock",sortable:!1,name:"Quantity Total"}],headerHeight:50,rowHeight:"auto",pageLimit:10},this.loadPage()}loadPage(){var t=this;return(0,p.Z)(function*(){try{t.loadingIndicator=!0;const o=yield(0,u.n)(t.productService.getProductInventories(t.product?.id||""));if(o&&o.data&&o.data){const n=[...o.data.items||[]];t.rows=n}}catch(o){console.log(o)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerClickAddProductToInventory(){this.isAddNew=!this.isAddNew}handlerCancel(){this.isAddNew=!1,this.model={}}handlerSave(t){var o=this;return(0,p.Z)(function*(){t.stopPropagation();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(r=>{o.form.controls[r].touched=!0});o.form.markAsTouched(),o.form.submitted=!0,o.isLoading=!0;const n={...o.model,product_id:o.product?.id};yield(0,u.n)(o.productService.getInventoryProducts(n)),o.IComMessageService.showAlertMessageDone("Add product to inventory success"),o.handlerCancel(),o.loadPage()}catch(n){o.IComMessageService.showAlertMessageError(n?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}})()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(J.F0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-inventory"]],viewQuery:function(o,n){if(1&o&&(e.Gf(Ee,7),e.Gf(Oe,7)),2&o){let r;e.iGM(r=e.CRH())&&(n.statusRef=r.first),e.iGM(r=e.CRH())&&(n.removeRef=r.first)}},inputs:{fields:"fields",rows:"rows",product:"product"},standalone:!0,features:[e.jDz],decls:7,vars:10,consts:[[1,"mb-4","w-full","h-full","flex","flex-col","!p-4","bg-white","border","rounded-md"],[1,""],["nz-button","",1,"!flex","!items-center",3,"nzType","click"],["class","w-full mt-4 bg-white ",4,"ngIf"],[1,"w-full","h-full","mt-4"],[1,"material","expandable","striped","w-full","h-full",3,"rows","columns","headerHeight","columnMode","rowHeight","scrollbarH","loadingIndicator"],[1,"w-full","mt-4","bg-white"],[3,"model","fields","options","form"],["nz-row",""],["nz-col","",1,"search-area","flex"],["nz-button","",3,"nzType","nzLoading","click"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return n.handlerClickAddProductToInventory()}),e._uU(3," Add Product To Inventory "),e.qZA()(),e.YNc(4,ke,6,6,"div",3),e.TgZ(5,"div",4),e._UZ(6,"ngx-datatable",5),e.qZA()()),2&o&&(e.xp6(2),e.Q6J("nzType","primary"),e.xp6(2),e.Q6J("ngIf",n.isAddNew),e.xp6(2),e.Q6J("rows",n.rows)("columns",n.configTable.columns||e.DdM(9,Ye))("headerHeight",n.configTable.headerHeight||50)("columnMode","force")("rowHeight",n.configTable.rowHeight||50)("scrollbarH",!0)("loadingIndicator",n.loadingIndicator))},dependencies:[v.u,a.UX,m.X0,m.T7,f.sL,f.ix,D.w,L.dQ,x.xD,x.nE,b.O5,_.PV],encapsulation:2,changeDetection:0})}return i})();var Fe=s(8213);function Re(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handlerSave(n))}),e._uU(2," Submit "),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handlerCancel(n))}),e._uU(4," Cancel "),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("nzType","primary")("nzLoading",t.isLoading)}}function Ge(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.toggleDisabled())}),e._uU(2," Edit "),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("nzType","primary"))}function qe(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-history",13),2&i){const t=e.oxw(2);e.Q6J("product",t.model)}}function je(i,l){if(1&i&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4),e._UZ(3,"formly-form",5),e.TgZ(4,"div",6),e.YNc(5,Re,5,2,"div",7),e.YNc(6,Ge,3,1,"div",7),e.qZA()()(),e.YNc(7,qe,1,1,"icom-libs-product-detail-history",8),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled)),e.xp6(1),e.Q6J("ngIf",null==t.options||null==t.options.formState?null:t.options.formState.disabled),e.xp6(1),e.Q6J("ngIf",null==t.model?null:t.model.id)}}function Xe(i,l){1&i&&e._UZ(0,"nz-spin",14),2&i&&e.Q6J("nzSize","large")}let Ke=(()=>{class i{constructor(){this.form=new a.cw({}),this.options={formState:{disabled:!0}},this.fields=[],this.productService=(0,e.f3M)(c.k),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.model={},this.fields=[{validators:{validation:[{name:"fieldMatch",options:{errorPath:"value"}}]},fieldGroup:[{key:"type",type:"select-custom",props:{label:"Payment Type",placeholder:"Select Type",viewValue:"name",classInclude:"w-[300px]",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("PRODUCT_DISCOUNT_TYPE").pipe((0,z.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}}]},{key:"value",type:"input",className:"",props:{label:"Value",required:!0,type:"number"},expressions:{"props.disabled":"formState.disabled"}},{key:"status",className:"basis-4/12",type:"Status",props:{placeholder:"Select Status",label:"Pool",viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:this.productService.getOptionType("PRODUCT_DISCOUNT_STATUS").pipe((0,z.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"date_range",type:"icom-range-picker",props:{required:!0,className:"mt-4",label:"Valid",nzShowTime:!0,format:"dd-MM-yyyy HH:mm"},expressions:{"props.disabled":"formState.disabled"}},{key:"minimum_order_value",type:"input",className:"",props:{label:"Minimum order value",required:!0,type:"number"},expressions:{"props.disabled":"formState.disabled"}},{key:"maximum_discount_amount",type:"input",className:"",props:{label:"Maximum discount amount",required:!0,type:"number"},expressions:{"props.disabled":"formState.disabled"}}]}ngOnInit(){var t=this;return(0,p.Z)(function*(){try{if(t.loadingIndicator=!0,t.cdr.detectChanges(),t.model=yield(0,u.n)(t.productService.getProductDiscount(t.product?.id)),t.modelOrigin=(0,P.cloneDeep)(t.model),!t.model.valid_from||!t.model.valid_until)return;t.model.date_range=[T(t.model.valid_from).toDate(),T(t.model.valid_until).toDate()]}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerSave(t){var o=this;return(0,p.Z)(function*(){if(t.stopPropagation(),t.preventDefault(),o.form.valid)try{o.form.markAsTouched(),o.form.submitted=!0;const n={...o.model};if(o.isLoading=!0,o.cdr.detectChanges(),(0,Fe.NT)(n,"valid_from,valid_until"),n.id)return yield(0,u.n)(o.productService.updateProductDiscount(n)),o.IComMessageService.showAlertMessageDone("Edit product discount success"),void o.toggleDisabled();delete n.id,yield(0,u.n)(o.productService.createProductDiscount(n)),o.IComMessageService.showAlertMessageError("Edit product discount success")}catch(n){o.IComMessageService.showAlertMessageError(n?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}else Object.keys(o.form.controls).forEach(n=>{o.form.controls[n].touched=!0})})()}handlerCancel(t){t.stopPropagation(),t.preventDefault(),this.toggleDisabled(),this.form.reset(this.modelOrigin)}toggleDisabled(){this.options.formState.disabled=!this.options.formState.disabled}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail-discount"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","pt-4","bg-white","border","rounded-md"],["nz-form","",3,"formGroup"],[3,"model","fields","options","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],["nz-col","",1,"search-area","flex"],["nz-button","",3,"nzType","nzLoading","click"],["nz-button","",1,"ml-4",3,"click"],["nz-button","",3,"nzType","click"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(o,n){1&o&&(e.YNc(0,je,8,8,"div",0),e.YNc(1,Xe,1,1,"nz-spin",1)),2&o&&(e.Q6J("ngIf",!n.loadingIndicator),e.xp6(1),e.Q6J("ngIf",n.loadingIndicator))},dependencies:[v.u,a.UX,a._Y,a.JL,a.sg,m.X0,m.T7,f.sL,f.ix,D.w,L.dQ,b.O5,C,y.j,y.W],encapsulation:2})}return i})();var Be=s(4629);function Ve(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-general",14),2&i){const t=e.oxw(2);e.Q6J("product",t.productTemp)}}function We(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-language",14),2&i){const t=e.oxw(2);e.Q6J("product",t.product)}}function $e(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-price",14),2&i){const t=e.oxw(2);e.Q6J("product",t.product)}}function et(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-properties",14),2&i){const t=e.oxw(2);e.Q6J("product",t.product)}}function tt(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-media",14),2&i){const t=e.oxw(2);e.Q6J("product",t.product)}}function ot(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-inventory",14),2&i){const t=e.oxw(2);e.Q6J("product",t.product)}}function it(i,l){if(1&i&&e._UZ(0,"icom-libs-inventory-items-list",15),2&i){const t=e.oxw(2);e.Q6J("inventoryId",-1)("productId",t.product.id||0)}}function nt(i,l){if(1&i&&e._UZ(0,"icom-libs-product-detail-discount",14),2&i){const t=e.oxw(2);e.Q6J("product",t.product)}}function rt(i,l){1&i&&(e.TgZ(0,"nz-page-header-footer",2)(1,"div",3)(2,"nz-tabset",4)(3,"nz-tab",5),e.YNc(4,Ve,1,1,"ng-template",6),e.qZA(),e.TgZ(5,"nz-tab",7),e.YNc(6,We,1,1,"ng-template",6),e.qZA(),e.TgZ(7,"nz-tab",8),e.YNc(8,$e,1,1,"ng-template",6),e.qZA(),e.TgZ(9,"nz-tab",9),e.YNc(10,et,1,1,"ng-template",6),e.qZA(),e.TgZ(11,"nz-tab",10),e.YNc(12,tt,1,1,"ng-template",6),e.qZA(),e.TgZ(13,"nz-tab",11),e.YNc(14,ot,1,1,"ng-template",6),e.qZA(),e.TgZ(15,"nz-tab",12),e.YNc(16,it,1,2,"ng-template",6),e.qZA(),e.TgZ(17,"nz-tab",13),e.YNc(18,nt,1,1,"ng-template",6),e.qZA()()()()),2&i&&(e.xp6(2),e.Q6J("nzSelectedIndex",0))}let lt=(()=>{class i{constructor(t){this.routeActive=t,this.productService=(0,e.f3M)(c.k),this.cdr=(0,e.f3M)(e.sBO),this.productId=this.routeActive.snapshot.params.id}ngOnInit(){var t=this;return(0,p.Z)(function*(){try{t.product=yield(0,u.n)(t.productService.getProduct(t.productId)),t.productTemp=(0,P.cloneDeep)(t.product),t.cdr.detectChanges()}catch(o){console.log(o)}})()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(J.gz))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["icom-libs-product-detail"]],standalone:!0,features:[e.jDz],decls:4,vars:2,consts:[["nzBackIcon","",1,"site-page-header","h-full","w-full","flex","flex-col"],["class","w-full h-full overflow-auto",4,"ngIf"],[1,"w-full","h-full","overflow-auto"],[1,"w-full","h-full"],[3,"nzSelectedIndex"],["nzTitle","General"],["nz-tab",""],["nzTitle","Languages"],["nzTitle","Price"],["nzTitle","Properties"],["nzTitle","Media"],["nzTitle","Inventory"],["nzTitle","Inventory Items"],["nzTitle","Discounts"],[3,"product"],[3,"inventoryId","productId"]],template:function(o,n){1&o&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-title"),e._uU(2),e.qZA(),e.YNc(3,rt,19,1,"nz-page-header-footer",1),e.qZA()),2&o&&(e.xp6(2),e.Oqu((null==n.product?null:n.product.name)||""),e.xp6(1),e.Q6J("ngIf",n.product&&n.product.id))},dependencies:[x.xD,v.u,a.UX,m.X0,f.sL,M.U5,Z.ZJ,d.KJ,d.$O,d.u9,d.$,A.zf,h.we,h.xH,h.xw,h.cj,_.PV,H,X,b.O5,ee,_e,Je,He,Ke,Be.IcomLibInventoryListItemsComponent],encapsulation:2,changeDetection:0})}return i})()},6987:(O,S,s)=>{s.d(S,{S:()=>Z,g:()=>b});var p=s(7582),e=s(5879),a=s(7754),m=s(6814),v=s(8324),x=s(9388);function f(d,A){if(1&d&&(e.ynx(0),e._uU(1),e.BQk()),2&d){const h=e.oxw(2);e.xp6(1),e.Oqu(h.nzText)}}function M(d,A){if(1&d&&(e.TgZ(0,"span",1),e.YNc(1,f,2,1,"ng-container",2),e.qZA()),2&d){const h=e.oxw();e.xp6(1),e.Q6J("nzStringTemplateOutlet",h.nzText)}}let b=(()=>{class d{constructor(){this.nzType="horizontal",this.nzOrientation="center",this.nzDashed=!1,this.nzPlain=!1}static#e=this.\u0275fac=function(_){return new(_||d)};static#t=this.\u0275cmp=e.Xpm({type:d,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:16,hostBindings:function(_,c){2&_&&e.ekj("ant-divider-horizontal","horizontal"===c.nzType)("ant-divider-vertical","vertical"===c.nzType)("ant-divider-with-text",c.nzText)("ant-divider-plain",c.nzPlain)("ant-divider-with-text-left",c.nzText&&"left"===c.nzOrientation)("ant-divider-with-text-right",c.nzText&&"right"===c.nzOrientation)("ant-divider-with-text-center",c.nzText&&"center"===c.nzOrientation)("ant-divider-dashed",c.nzDashed)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzDashed:"nzDashed",nzPlain:"nzPlain"},exportAs:["nzDivider"],decls:1,vars:1,consts:[["class","ant-divider-inner-text",4,"ngIf"],[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function(_,c){1&_&&e.YNc(0,M,2,1,"span",0),2&_&&e.Q6J("ngIf",c.nzText)},dependencies:[m.O5,v.f],encapsulation:2,changeDetection:0})}return(0,p.gn)([(0,a.yF)()],d.prototype,"nzDashed",void 0),(0,p.gn)([(0,a.yF)()],d.prototype,"nzPlain",void 0),d})(),Z=(()=>{class d{static#e=this.\u0275fac=function(_){return new(_||d)};static#t=this.\u0275mod=e.oAB({type:d});static#o=this.\u0275inj=e.cJS({imports:[x.vT,m.ez,v.T]})}return d})()}}]);