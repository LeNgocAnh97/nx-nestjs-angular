"use strict";(self.webpackChunkapps_flash_sale=self.webpackChunkapps_flash_sale||[]).push([[2696],{2696:(Q,g,o)=>{o.r(g),o.d(g,{IcomLibsFlashSaleListComponent:()=>J});var f=o(5861),m=o(6236),e=o(5879),d=o(9663),h=o(6814),u=o(95),L=o(3802),z=o(5545),T=o(2840),v=o(2595),c=o(2787),_=o(1221),A=o(9466),E=o(9717),D=o(1567),Z=o(1659),S=o(708),y=o(4905),b=o(8216),C=o(6109),P=o(855),U=o(1958),x=o(3460);const w=function(s,p){return{"text-green-500":s,"text-red-500":p}};function F(s,p){if(1&s){const n=e.EpF();e.TgZ(0,"tr")(1,"td",22),e._uU(2),e.qZA(),e.TgZ(3,"td",22),e._uU(4),e.qZA(),e.TgZ(5,"td",22)(6,"div",23),e._uU(7),e.qZA()(),e.TgZ(8,"td",22),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td",22),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td",22),e._uU(15),e.qZA(),e.TgZ(16,"td",24),e._uU(17),e.ALo(18,"findValueById"),e.qZA(),e.TgZ(19,"td",22),e._uU(20),e.ALo(21,"date"),e.qZA(),e.TgZ(22,"td",22),e._uU(23),e.qZA(),e.TgZ(24,"td")(25,"div",25)(26,"button",26),e._uU(27," H\xe0nh \u0111\u1ed9ng "),e._UZ(28,"span",27),e.qZA(),e.TgZ(29,"nz-dropdown-menu",null,28)(31,"ul",29)(32,"li",30),e.NdJ("click",function(t){const i=e.CHM(n).$implicit,r=e.oxw();return e.KtG(r.handlerView(t,i))}),e._uU(33,"Xem"),e.qZA(),e.TgZ(34,"li",30),e.NdJ("click",function(t){const i=e.CHM(n).$implicit,r=e.oxw();return e.KtG(r.handlerEdit(t,i))}),e._uU(35,"S\u1eeda"),e.qZA()()()()()()}if(2&s){const n=p.$implicit,l=p.index,t=e.MAs(30),a=e.oxw();e.xp6(2),e.hij(" ",((null==a.pagination?null:a.pagination.page)-1)*(null==a.pagination?null:a.pagination.limit)+l+1," "),e.xp6(2),e.Oqu(n.code),e.xp6(2),e.Q6J("nzTooltipTitle",n.name),e.xp6(1),e.hij(" ",n.name||"-"," "),e.xp6(2),e.Oqu(e.xi3(10,14,n.start_time,"dd/MM/yyyy HH:mm")),e.xp6(3),e.Oqu(e.xi3(13,17,n.end_time,"dd/MM/yyyy HH:mm")),e.xp6(3),e.Oqu((null==n.flash_sale_config||null==n.flash_sale_config.products?null:n.flash_sale_config.products.length)||0),e.xp6(1),e.Q6J("ngClass",e.WLB(26,w,"ACTIVE"===n.status,"INACTIVE"===n.status)),e.xp6(1),e.hij(" ",e.xi3(18,20,n.status,a.ListStatus)||"-"," "),e.xp6(3),e.Oqu(e.xi3(21,23,n.created_at,"dd/MM/yyyy HH:mm")),e.xp6(3),e.Oqu(n.created_by_name),e.xp6(3),e.Q6J("nzType","primary")("nzShape","round")("nzDropdownMenu",t)}}function I(s,p){if(1&s&&(e.TgZ(0,"div",31),e._uU(1),e.qZA()),2&s){const n=e.oxw();e.xp6(1),e.hij(" T\u1ed5ng s\u1ed1 b\u1ea3n ghi: ",(null==n.pagination?null:n.pagination.total_rows)||0," ")}}const M=function(){return{y:"calc(100vh - 430px)"}},N=function(){return[10,15,20,30,40,50]};let J=(()=>{class s{constructor(){this.listOfData=[],this.form=new u.cw({}),this.model={},this.ListStatus=(0,y.EC)(),this.rows=[],this.options={formState:{hidden:!1}},this.fields=[{className:"flex flex-col",fieldGroupClassName:"flex w-full justify-center",fieldGroup:[{key:"name",type:"search-input",className:"basis-6/12",props:{placeholder:"T\xecm ki\u1ebfm theo m\xe3, t\xean flash sale",nzPrefixIcon:"search"}}]},{className:"flex flex-row flex-wrap",fieldGroupClassName:"flex w-full",fieldGroup:[{key:"status",type:"select-custom",className:"basis-6/12",props:{placeholder:"Tr\u1ea1ng th\xe1i",valueProp:"id",labelProp:"value",label:"Tr\u1ea1ng th\xe1i",viewValue:"value",options:(0,y.EC)()},expressions:{hide:"!formState.hidden"}},{key:"effect",type:"select-custom",className:"basis-6/12",props:{placeholder:"Hi\u1ec7u l\u1ef1c",valueProp:"id",labelProp:"value",viewValue:"value",label:"Hi\u1ec7u l\u1ef1c",options:[{id:"non expired",value:"C\xf2n hi\u1ec7u l\u1ef1c"},{id:"expired",value:"H\u1ebft hi\u1ec7u l\u1ef1c"}]},expressions:{hide:"!formState.hidden"}}]}],this.modalService=(0,e.f3M)(_.Sf),this.viewContainerRef=(0,e.f3M)(e.s_b),this.icomLibsDynamicComponentService=(0,e.f3M)(A.G),this.cdr=(0,e.f3M)(e.sBO),this.router=(0,e.f3M)(D.F0),this.iComLibsServicesProjectDynamicHomeService=(0,e.f3M)(Z.KL),this.iComLibsServicesProjectFlashSaleService=(0,e.f3M)(Z.Rm),this.IComMessageService=(0,e.f3M)(E.Q)}ngOnInit(){this.loadPage(1)}drop(n){const l=n.previousIndex,t=n.currentIndex;(0,m.bA)(this.listOfData,l,t),console.log(`Item was moved from ${l} to ${t}`)}handlerSearch(n){n.stopPropagation(),n.preventDefault(),this.loadPage(1)}handlerReset(){this.form.reset(),this.loadPage(1)}loadPage(n=1,l=10){var t=this;return(0,f.Z)(function*(){try{t.loading=!0;const i={...{...t.model},size:l,page:n},r=yield(0,S.n)(t.iComLibsServicesProjectFlashSaleService.list({...i}));if(r&&r.data&&r.data.items)return t.rows=r.data.items||[],void(t.pagination=r.data.pagination);t.rows=[],t.pagination=r.data.pagination}catch(a){console.log(a)}finally{t.loading=!1,t.cdr.detectChanges()}})()}handlerToggleCollapse(n){n.stopPropagation(),n.preventDefault(),this.options.formState.hidden=!this.options.formState.hidden}handlerView(n,l){n.stopPropagation(),n.preventDefault(),this.router.navigateByUrl(`flash-sale/list/detail?id=${l._id}&mode=view`)}handlerEdit(n,l){var t=this;return(0,f.Z)(function*(){n.stopPropagation(),n.preventDefault();try{const a=l?._id||"";if((yield(0,S.n)(t.iComLibsServicesProjectFlashSaleService.detail(+a)))?.data?.is_transaction_exists)return void t.IComMessageService.showAlertMessageError("Flash sale \u0111\xe3 c\xf3 giao d\u1ecbch th\xe0nh c\xf4ng. B\u1ea1n kh\xf4ng \u0111\u01b0\u1ee3c ph\xe9p s\u1eeda.");t.router.navigateByUrl(`flash-sale/list/detail?id=${l._id}&mode=edit`)}catch(a){const r=a?.error?.error_message;t.IComMessageService.showAlertMessageError(r)}})()}handlerActivate(n){n.stopPropagation(),n.preventDefault()}showModal(n){n.stopPropagation(),n.preventDefault(),this.router.navigateByUrl("flash-sale/list/detail?mode=add")}handlerOpenGroupSale(n){n.stopPropagation(),n.preventDefault(),this.router.navigateByUrl("flash-sale/list/group")}onPageChange(n){this.loadPage(n,this.pagination.limit)}onPageSizeChange(n){this.loadPage(1,n)}static#e=this.\u0275fac=function(l){return new(l||s)};static#n=this.\u0275cmp=e.Xpm({type:s,selectors:[["icom-libs-flash-sale-list"]],standalone:!0,features:[e.jDz],decls:51,vars:24,consts:[[1,"flex","w-full","h-full","flex-col"],[1,"w-full","!p-2","bg-white","border","rounded-md"],["nz-button","",3,"nzType","click"],["nz-form","",1,"!p-4","bg-white","border","rounded-md","mt-4",3,"formGroup","keydown.enter"],[1,"w-full","items-center"],[3,"model","fields","options","form"],["nz-row","",1,"flex","justify-between"],[1,""],["nz-icon","","nzType","plus","nzTheme","outline"],["nz-col","",1,"search-area","flex","items-center"],["nz-button","",1,"!flex","!items-center",3,"nzType","click"],["nz-icon","","nzType","search","nzTheme","outline"],["nz-button","",1,"ml-4","!flex","!items-center",3,"click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[1,"ml-4","items-center","flex",3,"click"],["nz-icon","",1,"ml-2",3,"nzType"],[1,"w-full","h-full","mt-4","overflow-hidden"],["nzShowSizeChanger","","cdkDropList","",1,"h-100",3,"nzScroll","nzData","nzLoading","nzTotal","nzPageSize","nzNoResult","nzPageIndex","nzFrontPagination","nzPageSizeOptions","nzFooter","nzPageIndexChange","nzPageSizeChange","cdkDropListDropped"],["flashSaleTable","","sectionTable",""],["nzWidth","10%",1,"text-xs"],[4,"ngFor","ngForOf"],["footerTemplate",""],[1,"text-xs","!p-2"],["appShowTooltipOnOverflow","","nz-tooltip","",1,"overflow-hidden","text-ellipsis","whitespace-nowrap",3,"nzTooltipTitle"],[1,"text-xs","!p-2",3,"ngClass"],[1,"name-container"],["nz-button","","nz-button","","nz-dropdown","",3,"nzType","nzShape","nzDropdownMenu"],["nz-icon","","nzType","down"],["menu4","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[1,"footer-content"]],template:function(l,t){if(1&l&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(i){return t.handlerOpenGroupSale(i)}),e._uU(3," Qu\u1ea3n l\xfd nh\xf3m flash sale "),e.qZA()(),e.TgZ(4,"form",3),e.NdJ("keydown.enter",function(i){return t.handlerSearch(i)}),e.TgZ(5,"div",4),e._UZ(6,"formly-form",5),e.qZA(),e.TgZ(7,"div",6)(8,"div",7)(9,"button",2),e.NdJ("click",function(i){return t.showModal(i)}),e._UZ(10,"span",8),e._uU(11," Th\xeam m\u1edbi "),e.qZA()(),e.TgZ(12,"div",9)(13,"button",10),e.NdJ("click",function(i){return t.handlerSearch(i)}),e._UZ(14,"i",11),e._uU(15," L\u1ecdc "),e.qZA(),e.TgZ(16,"button",12),e.NdJ("click",function(){return t.handlerReset()}),e._UZ(17,"i",13),e._uU(18," L\xe0m m\u1edbi "),e.qZA(),e.TgZ(19,"a",14),e.NdJ("click",function(i){return t.handlerToggleCollapse(i)}),e._uU(20),e._UZ(21,"span",15),e.qZA()()()(),e.TgZ(22,"div",16)(23,"nz-table",17,18),e.NdJ("nzPageIndexChange",function(i){return t.onPageChange(i)})("nzPageSizeChange",function(i){return t.onPageSizeChange(i)})("cdkDropListDropped",function(i){return t.drop(i)}),e.TgZ(26,"thead")(27,"tr")(28,"th",19),e._uU(29,"STT"),e.qZA(),e.TgZ(30,"th",19),e._uU(31,"M\xe3"),e.qZA(),e.TgZ(32,"th",19),e._uU(33,"T\xean"),e.qZA(),e.TgZ(34,"th",19),e._uU(35,"T\u1eeb ng\xe0y"),e.qZA(),e.TgZ(36,"th",19),e._uU(37,"\u0110\u1ebfn ng\xe0y"),e.qZA(),e.TgZ(38,"th",19),e._uU(39,"S\u1ed1 l\u01b0\u1ee3ng s\u1ea3n ph\u1ea9m"),e.qZA(),e.TgZ(40,"th",19),e._uU(41,"Tr\u1ea1ng th\xe1i"),e.qZA(),e.TgZ(42,"th",19),e._uU(43,"Th\u1eddi gian t\u1ea1o"),e.qZA(),e.TgZ(44,"th",19),e._uU(45,"Ng\u01b0\u1eddi t\u1ea1o"),e.qZA(),e._UZ(46,"th",19),e.qZA()(),e.TgZ(47,"tbody"),e.YNc(48,F,36,29,"tr",20),e.qZA()()()(),e.YNc(49,I,2,1,"ng-template",null,21,e.W1O)),2&l){const a=e.MAs(24),i=e.MAs(50);e.xp6(2),e.Q6J("nzType","link"),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(3),e.Q6J("nzType","primary"),e.xp6(4),e.Q6J("nzType","primary"),e.xp6(7),e.hij(" ",t.options.formState.hidden?"Thu g\u1ecdn":"M\u1edf r\u1ed9ng"," "),e.xp6(1),e.Q6J("nzType",t.options.formState.hidden?"up":"down"),e.xp6(2),e.Q6J("nzScroll",e.DdM(22,M))("nzData",t.rows)("nzLoading",t.loading)("nzTotal",null==t.pagination?null:t.pagination.total_rows)("nzPageSize",10)("nzNoResult","Kh\xf4ng c\xf3 d\u1eef li\u1ec7u.")("nzPageIndex",null==t.pagination?null:t.pagination.page)("nzFrontPagination",!1)("nzPageSizeOptions",e.DdM(23,N))("nzData",t.rows)("nzFooter",i),e.xp6(25),e.Q6J("ngForOf",a.data)}},dependencies:[m._t,m.Wj,d.HQ,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,h.uU,h.ax,L.u,u.UX,u._Y,u.JL,u.sg,z.X0,z.T7,T.sL,T.ix,P.w,U.dQ,v.PV,v.Ls,c.b1,x.wO,x.u9,c.cm,c.RR,c.wA,_.Qp,b._,h.mk,C.cg,C.SY],encapsulation:2,changeDetection:0})}return s})()}}]);