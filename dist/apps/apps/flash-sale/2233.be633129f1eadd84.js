"use strict";(self.webpackChunkapps_flash_sale=self.webpackChunkapps_flash_sale||[]).push([[2233],{2233:(he,Y,r)=>{r.r(Y),r.d(Y,{IComLibsCampaignManagementDetailComponent:()=>Lt});var E=r(5861),e=r(5879),z=r(6814),U=r(2595),T=r(6254),S=r(2574),X=r(9382),W=r(8083),ee=r(2962),M=r(9704),v=r(2840),d=r(95),_=r(5545),I=r(3802),x=r(2669),Z=r(3304),p=r(7398);function P(o){const s=o.parent?.value?.start_time,t=o.parent?.value?.end_time;return s&&t&&Z(t).isBefore(s)?{startTimeInvalid:!0}:null}var f=r(3599),w=r(1659);let te=(()=>{class o{constructor(){this.form=new d.cw({}),this.fields=[],this.options={formState:{disabled:!1}},this.icomFunctionControl=new e.vpe,this.campaignService=(0,e.f3M)(w.wb),this.fields=((o,s)=>[{key:"name",type:"input",className:"",props:{placeholder:"Nh\u1eadp t\xean chi\u1ebfn d\u1ecbch",label:"T\xean chi\u1ebfn d\u1ecbch",type:"string",required:!0},validators:{validation:[{name:"noWhitespace",options:{errorPath:"value"}}]},expressions:{"props.disabled":"formState.disabled"}},{key:"type_start_time",type:"radio",className:"basis-6/12",defaultValue:"SPECTIME",props:{label:"Th\u1eddi gian b\u1eaft \u0111\u1ea7u",required:!0,viewValue:"title",labelProp:"title",valueProp:"id",options:s.getListTimeStart().pipe((0,p.U)(t=>t.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"start_time",type:"date",className:"basis-6/12",props:{ShowTime:!0,format:"dd-MM-yyyy HH:mm:ss",placeholder:"DD-MM-YYYY hh:mm:ss",required:!0,emitTimeLocal:!0,DisabledDate:t=>{const n=new Date;return n.setHours(0,0,0,0),t<n},change:(t,n)=>{t?.parent?.fieldGroup?.find(a=>"end_time"===a.key)&&o.get("end_time").updateValueAndValidity()}},hideExpression:t=>!t?.type_start_time||"SPECTIME"!==t?.type_start_time,expressions:{"props.disabled":"formState.disabled"},validators:{validation:[P]}},{key:"type_end_time",type:"radio",className:"basis-6/12",defaultValue:"SPECTIME",props:{label:"Th\u1eddi gian k\u1ebft th\xfac",required:!0,viewValue:"title",labelProp:"title",valueProp:"id",options:s.getListTimeEnd().pipe((0,p.U)(t=>t.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"end_time",type:"date",className:"basis-6/12",props:{required:!0,placeholder:"DD-MM-YYYY hh:mm:ss",emitTimeLocal:!0,ShowTime:!0,format:"dd-MM-yyyy HH:mm:ss",DisabledDate:t=>{const n=new Date;return n.setHours(0,0,0,0),t<n},change:(t,n)=>{t?.parent?.fieldGroup?.find(a=>"start_time"===a.key)&&o.get("start_time").updateValueAndValidity()}},hideExpression:t=>!t?.type_end_time||"SPECTIME"!==t?.type_end_time,expressions:{"props.disabled":"formState.disabled"},expressionProperties:{"props.DisabledDate":(t,n,i)=>{const a=n?.model?.start_time;return a?l=>Z(l).isBefore(Z(a)):l=>!1}},validators:{validation:[P]}},{key:"description",type:"quill-editor",className:"basis-6/12",props:{label:"Th\u1ec3 l\u1ec7 ch\u01b0\u01a1ng tr\xecnh",placeholder:"Nh\u1eadp th\u1ec3 l\u1ec7",required:!0},expressions:{"props.disabled":"formState.disabled"}},{fieldGroupClassName:"w-full items-center mt-4",key:"customer_group",expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{type:"array",key:"config",expressions:{"props.disabled":"formState.disabled"},props:{label:"Kh\xe1ch h\xe0ng",addText:"Th\xeam Kh\xe1ch h\xe0ng"},fieldArray:{wrappers:["group"],hideExpression:t=>"after_specific_day"===t.operator||"before_specific_day"===t.operator,fieldGroup:[{key:"type",type:"select-custom",className:"basis-6/12",props:{label:"Kh\xe1ch h\xe0ng",placeholder:"Ch\u1ecdn \u0111i\u1ec1u ki\u1ec7n",viewValue:"name",labelProp:"name",valueProp:"id",options:[{name:"H\u1ed3 s\u01a1 kh\xe1ch h\xe0ng ",id:"customer_profile"}]}},{key:"attribute",type:"select-custom",props:{placeholder:"Ch\u1ecdn \u0111i\u1ec1u ki\u1ec7n",viewValue:"name",labelProp:"name",valueProp:"id",options:[{name:"Theo th\u1eddi gian \u0111\u0103ng k\xfd m\u1edbi",id:"thoi_gian_dang_ky"},{name:"Theo s\u1ed1 \u0111i\u1ec7n tho\u1ea1i",id:"phone"}],change:t=>{t.model&&"thoi_gian_dang_ky"===t?.model?.attribute&&!t?.model?.operator&&(t.model.operator="before_duration",t.model.group="customer"),t.model&&"phone"===t?.model?.attribute&&!t?.model?.operator&&(t.model.operator="in",t.model.group="customer"),t.formControl.markAsTouched()}},hideExpression:t=>!t?.type||"customer_profile"!==t?.type},{fieldGroupClassName:"flex row items-center mt-4",key:"",hideExpression:t=>!t?.attribute||"thoi_gian_dang_ky"!==t?.attribute,fieldGroup:[{key:"value",type:"nz-input-number",props:{placeholder:"Nh\u1eadp s\u1ed1",type:"number",min:0}},{key:"unit",type:"select-custom",className:" ml-4",defaultValue:"day",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"day",name:"Ng\xe0y"}]}}]},{key:"value",hideExpression:t=>(console.log(t),!t?.attribute||"phone"!==t?.attribute),type:"tags",props:{}}]}}]}])(this.form,this.campaignService)}ngOnInit(){"view"===this.mode&&(this.options.formState.disabled=!0),this.icomFunctionControl.emit({save:this.handleSave.bind(this)}),this.data.type_click_action_selected=""}handleSave(){return this.form.valid?(this.form.markAsTouched(),this.form.submitted=!0,!0):(Object.keys(this.form.controls).forEach(t=>{this.form.controls[t].touched=!0}),!1)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-general"]],inputs:{data:"data",mode:"mode"},outputs:{icomFunctionControl:"icomFunctionControl"},standalone:!0,features:[e.jDz],decls:4,vars:6,consts:[[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","bg-white","border","rounded-md"],["nz-form","",1,"bg-white","rounded-md","h-full","flex","flex-col","!p-4","overflow-y-auto",3,"formGroup","nzLayout"],[3,"model","fields","options","form"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e._UZ(3,"formly-form",3),e.qZA()()()),2&n&&(e.xp6(2),e.Q6J("formGroup",i.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",i.data)("fields",i.fields)("options",i.options)("form",i.form))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,x.j,f.U5,f.Lr],encapsulation:2,changeDetection:0})}return o})();var F=r(1221),Q=r(8213),B=r(5592),J=r(7921),N=r(3997),j=r(6328);function ne(o,s){let t="";return n=>{!n.dirty&&"edit"===s&&(t=n.value);const i=[];return o?.forEach(a=>{i.push(a.name)}),i.filter(a=>n?.value?.trim()===a)?.length&&t!==n?.value?.trim()?{uniqueName:"T\xean n\xe0y \u0111\xe3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng."}:null}}let k=(()=>{class o{constructor(){this.form=new d.cw({}),this.fields=[],this.options={formState:{disabled:!1}},this.icomFunctionControl=new e.vpe,this.nzModalData=(0,e.f3M)(F.uB),this.iComLibsServicesProjectCampaignV3Service=(0,e.f3M)(w.wb)}ngOnInit(){this.fields=((o,s,t)=>[{key:"name",type:"input",className:"",props:{placeholder:"Nh\u1eadp t\xean nhi\u1ec7m v\u1ee5",label:"T\xean nhi\u1ec7m v\u1ee5",type:"string",required:!0},validators:{validation:[{name:"noWhitespace",options:{errorPath:"value"}},ne(this.missions,this.modeExtend)]},expressions:{"props.disabled":"formState.disabled"}},{key:"avatar",type:"upload",className:"",props:{label:"Icon \u0111\u1ea1i di\u1ec7n",size:102400,required:!0,labelType:"Image",width:200,height:200},expressions:{"props.disabled":"formState.disabled"}},{key:"type",type:"select-custom",className:"basis-6/12",props:{label:"Lo\u1ea1i nhi\u1ec7m v\u1ee5",placeholder:"Ch\u1ecdn lo\u1ea1i nhi\u1ec7m v\u1ee5",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getTypeMissions().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"info",type:"quill-editor",className:"basis-6/12",props:{label:"Th\xf4ng tin nhi\u1ec7m v\u1ee5",placeholder:"Nh\u1eadp m\xf4 t\u1ea3"},expressions:{"props.disabled":"formState.disabled"}},{key:"description",type:"textarea",className:"basis-6/12",props:{label:"M\xf4 t\u1ea3 nhi\u1ec7m v\u1ee5",placeholder:"Nh\u1eadp th\xf4ng tin"},expressions:{"props.disabled":"formState.disabled"}},{key:"sponsor",props:{required:!0,label:"Nh\xe0 t\xe0i tr\u1ee3",addText:"Th\xeam nh\xe0 t\xe0i tr\u1ee3"},expressions:{"props.disabled":"formState.disabled"},type:"array",fieldArray:{fieldGroupClassName:"flex row items-center",fieldGroup:[{key:"id",type:"select-custom",className:"basis-8/12",props:{label:"Nh\xe0 t\xe0i tr\u1ee3",placeholder:"Ch\u1ecdn nh\xe0 t\xe0i tr\u1ee3",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getContributor().pipe((0,p.U)(n=>n.data))}},{key:"value",type:"nz-input-number",className:"basis-4/12 ml-4",props:{placeholder:"Nh\u1eadp t\u1ef7 l\u1ec7 t\xe0i tr\u1ee3",label:"T\u1ef7 l\u1ec7 t\xe0i tr\u1ee3",type:"number",min:0,max:100,required:!0}},{key:"balance",type:"input",className:"basis-4/12 ml-4",props:{label:"T\xe0i kho\u1ea3n k\xfd qu\u1ef9",disabled:!0,required:!0},hooks:{onInit:n=>{(n?.formControl?.parent?.get("id")).valueChanges.subscribe(l=>{const g=n?.parent?.fieldGroup?.find(L=>"id"===L.key)?.props?.options;let A;g instanceof B.y?g.subscribe(L=>{A=L.find(Zt=>Zt.id===l),n?.formControl?.setValue(A?.balance||0)}):Array.isArray(g)&&(A=g.find(L=>L.value===l),n?.formControl?.setValue(A?.balance||0))})}}}]}},{key:"pool",type:"select-custom",props:{label:"Lo\u1ea1i \u0111i\u1ec3m th\u01b0\u1edfng C\u1ea5p 1",type:"text",placeholder:"C\u1ea5p 1 (Pool)",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getPool().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"sub_pool",type:"select-custom",props:{label:"Lo\u1ea1i \u0111i\u1ec3m th\u01b0\u1edfng C\u1ea5p 2",type:"text",placeholder:"C\u1ea5p 2 (Pool)",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:[]},expressions:{"props.disabled":"formState.disabled"},hooks:{onInit:n=>{const i=n?.form?.get("pool");i&&(n.templateOptions.options=i.valueChanges.pipe((0,J.O)(i.value),(0,N.x)(),(0,j.b)(a=>o.getSubPool({pool_id:a}).pipe((0,p.U)(l=>(l?.data?.find(h=>n?.model?.sub_pool===h.id)||n.formControl.setValue(null),l.data))))))}}},{key:"action",type:"select-custom",props:{label:"H\xe0nh \u0111\u1ed9ng th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5",type:"text",placeholder:" Ch\u1ecdn h\xe0nh \u0111\u1ed9ng",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getActionMission().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"lock",type:"checkbox",props:{label:"Kh\xf3a th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5 sau khi tham gia ",description:"Kh\xe1ch h\xe0ng ch\u1ec9 c\u1ea7n x\xe1c nh\u1eadn tham gia nhi\u1ec7m v\u1ee5 1 l\u1ea7n  (v\xed d\u1ee5 \u1ea5n button Th\u1ef1c hi\u1ec7n) th\xec c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5 b\u1ea5t k\u1ef3 l\xfac n\xe0o trong th\u1eddi gian di\u1ec5n ra chi\u1ebfn d\u1ecbch m\xe0 kh\xf4ng c\u1ea7n \u1ea5n l\u1ea1i."},expressions:{"props.disabled":"formState.disabled"}},{key:"click_action_type",type:"select-custom",className:"basis-6/12",props:{label:"X\u1eed l\xfd khi \u1ea5n n\xfat th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5",placeholder:"Ch\u1ecdn x\u1eed l\xfd",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getListActionType().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled"},hooks:{onInit:n=>{const i=n.formControl?.parent,a=i?.get("click_action_type");a&&a.valueChanges.pipe((0,J.O)(a.value),(0,N.x)()).subscribe(l=>{n?.props?.options instanceof B.y&&n?.props?.options.subscribe(h=>{const g=h.find(L=>L.id===l),A=i?.get("specific_type_click_action_selected");A&&A.setValue("input"===g?.type?"input":"select")})})}}},{key:"specific_type_click_action_selected",defaultValue:"",className:"hidden",type:"input"},{key:"click_action_param",hideExpression:(n,i,a)=>"input"!==a?.parent?.model.specific_type_click_action_selected,type:"input",className:"basis-6/12",props:{label:"Gi\xe1 tr\u1ecb tham s\u1ed1",placeholder:"Nh\u1eadp gi\xe1 tr\u1ecb"},expressions:{"props.disabled":"formState.disabled"}},{key:"click_action_param",type:"select-custom",className:"basis-6/12",hideExpression:(n,i,a)=>"input"===a?.parent?.model.specific_type_click_action_selected,props:{label:"Tham s\u1ed1",placeholder:"Ch\u1ecdn tham s\u1ed1",options:[],viewValue:"title",labelProp:"title",valueProp:"id"},expressions:{"props.disabled":"formState.disabled"},hooks:{onInit:n=>{const i=n?.form?.get("click_action_type");i&&(n.templateOptions.options=i.valueChanges.pipe((0,J.O)(i.value),(0,N.x)(),(0,j.b)(a=>o.getListActionParam(a).pipe((0,p.U)(l=>(l.data.find(h=>n?.model?.click_action_param===h.id)||n.formControl.setValue(null),l.data))))))}}}])(this.iComLibsServicesProjectCampaignV3Service),this.model=this.nzModalData.model,this.icomFunctionControl.emit({save:this.handleSave.bind(this)}),"view"===this.mode&&(this.options.formState.disabled=!0)}handleSave(){if(!this.form.invalid)return!0;(0,Q.c2)(this.form)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-mission-information"]],inputs:{mode:"mode",modeExtend:"modeExtend",model:"model",isAdd:"isAdd",missions:"missions"},outputs:{icomFunctionControl:"icomFunctionControl"},standalone:!0,features:[e.jDz],decls:2,vars:6,consts:[["nz-form","",3,"formGroup","nzLayout"],[3,"model","fields","options","form"]],template:function(n,i){1&n&&(e.TgZ(0,"form",0),e._UZ(1,"formly-form",1),e.qZA()),2&n&&(e.Q6J("formGroup",i.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",i.model)("fields",i.fields)("options",i.options)("form",i.form))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,x.j,f.U5,f.Lr,M.N6],encapsulation:2,changeDetection:0})}return o})();var c=r(9717);let C=(()=>{class o{constructor(){this.form=new d.cw({}),this.fields=[],this.campaignService=(0,e.f3M)(w.wb),this.productService=(0,e.f3M)(w.k),this.icomMessageService=(0,e.f3M)(c.Q),this.icomFunctionControl=new e.vpe}ngOnInit(){this.fields=((o,s,t)=>[{key:"reward",expressions:{"props.disabled":"formState.disabled"},wrappers:["collapse"],props:{label:"Ph\u1ea7n th\u01b0\u1edfng cho ng\u01b0\u1eddi th\u1ef1c hi\u1ec7n h\xe0nh \u0111\u1ed9ng",changeChecked:(n,i)=>{i.fieldGroup.find(l=>"is_active"===l.key).model.is_active=n},setChecked:n=>n?.fieldGroup?.find(a=>"is_active"===a.key)?.model?.is_active},fieldGroup:[{key:"name",type:"input",className:"",props:{placeholder:"Nh\u1eadp t\xean ph\u1ea7n th\u01b0\u1edfng",label:"T\xean ph\u1ea7n th\u01b0\u1edfng",type:"string"},validators:{validation:[{name:"noWhitespace",options:{errorPath:"value"}}]},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"is_active",defaultValue:!1,type:"checkbox",className:"hidden"},{key:"reward_level",type:"select-custom",props:{label:"M\u1ee9c th\u01b0\u1edfng",placeholder:"Ch\u1ecdn m\u1ee9c th\u01b0\u1edfng",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getRewardLevel().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"type",type:"select-custom",props:{label:"H\xecnh th\u1ee9c th\u01b0\u1edfng",placeholder:"Ch\u1ecdn h\xecnh th\u1ee9c th\u01b0\u1edfng",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getRewardForm().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"type_value",type:"nz-input-number",props:{label:" Nh\u1eadp s\u1ed1 ph\u1ea7n th\u01b0\u1edfng",placeholder:"Nh\u1eadp gi\xe1 tr\u1ecb",min:0,max:999999,type:"number"},hideExpression:n=>"random"!==n.type,expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"items",type:"array",props:{label:"Lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng",addText:"Th\xeam ph\u1ea7n th\u01b0\u1edfng",required:!0},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"},fieldArray:{wrappers:["group"],props:{label:""},expressions:{"props.disabled":"formState.disabled","props.required":n=>n?.options?.formState?.mainModel?.reward?.is_active||!1},fieldGroup:[{key:"type",type:"select-custom",props:{label:"Lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng",placeholder:"Ch\u1ecdn lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getTypeReward().pipe((0,p.U)(n=>n.data)),functionCheckExist:(n,i)=>{const a=n.options?.formState.mainModel,l=a&&a?.reward?.items,h=[];l?.forEach(g=>{h.push(g?.type||"")}),i?.length&&i?.forEach(g=>{h.includes(g.id)&&(g.disabled=!0)})}},expressions:{"props.required":n=>n?.options?.formState?.mainModel?.reward?.is_active||!1}},{key:"value",type:"nz-input-number",className:"",props:{placeholder:"Nh\u1eadp \u0110i\u1ec3m th\u01b0\u1edfng",label:"Gi\xe1 tr\u1ecb",type:"number",required:!0,min:0},hideExpression:n=>!n?.type||"point"!==n?.type,expressions:{"props.required":n=>n?.options?.formState?.mainModel?.reward?.is_active||!1}},{key:"id",type:"select-custom",props:{label:"Voucher",placeholder:"Ch\u1ecdn voucher",viewValue:"name",labelProp:"name",valueProp:"id",required:!0,multiple:!0,options:s.getProductFromCampaigns().pipe((0,p.U)(n=>n?.data))},hideExpression:n=>!n?.type||"voucher"!==n?.type,expressions:{"props.required":n=>n?.options?.formState?.mainModel?.reward?.is_active||!1}}]}},{key:"message_template",type:"select-custom",expressions:{"props.disabled":"formState.disabled"},props:{label:"Th\xf4ng b\xe1o",placeholder:"Ch\u1ecdn m\u1eabu th\xf4ng b\xe1o",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getMessageTemplate().pipe((0,p.U)(n=>n.data))}}]},{key:"reward_reference",expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"},props:{label:"Ph\u1ea7n th\u01b0\u1edfng cho ng\u01b0\u1eddi gi\u1edbi thi\u1ec7u",changeChecked:(n,i)=>{i.fieldGroup.find(l=>"is_active"===l.key).model.is_active=n},setChecked:n=>n?.fieldGroup?.find(a=>"is_active"===a.key)?.model?.is_active},className:" mt-4",wrappers:["collapse"],fieldGroup:[{key:"name",type:"input",className:"",props:{placeholder:"Nh\u1eadp t\xean ph\u1ea7n th\u01b0\u1edfng",label:"T\xean ph\u1ea7n th\u01b0\u1edfng",type:"string"},validators:{validation:[{name:"noWhitespace",options:{errorPath:"value"}}]},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"is_active",defaultValue:!1,type:"checkbox",hide:!0},{key:"reward_level",type:"select-custom",props:{label:"M\u1ee9c th\u01b0\u1edfng",placeholder:"Ch\u1ecdn m\u1ee9c th\u01b0\u1edfng",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getRewardLevel().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"type",type:"select-custom",props:{label:"H\xecnh th\u1ee9c th\u01b0\u1edfng",placeholder:"Ch\u1ecdn h\xecnh th\u1ee9c th\u01b0\u1edfng",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getRewardForm().pipe((0,p.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"type_value",type:"nz-input-number",props:{label:" Nh\u1eadp s\u1ed1 ph\u1ea7n th\u01b0\u1edfng",placeholder:"Nh\u1eadp gi\xe1 tr\u1ecb",min:0,max:999999,type:"number"},hideExpression:n=>"random"!==n.type,expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}},{key:"items",type:"array",props:{label:"Lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng",addText:"Th\xeam ph\u1ea7n th\u01b0\u1edfng"},expressions:{"props.disabled":"formState.disabled","props.required":n=>n?.options?.formState?.mainModel?.reward_reference?.is_active||!1},fieldArray:{wrappers:["group"],expressions:{"props.disabled":"formState.disabled","props.required":n=>n?.options?.formState?.mainModel?.reward_reference?.is_active||!1},fieldGroup:[{key:"type",type:"select-custom",props:{label:"Lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng",placeholder:"Ch\u1ecdn lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng",viewValue:"title",labelProp:"title",valueProp:"id",functionCheckExist:(n,i)=>{const a=n.options?.formState.mainModel,l=a&&a?.reward_reference?.items,h=[];l?.forEach(g=>{h.push(g?.type||"")}),i?.length&&i?.forEach(g=>{h.includes(g.id)&&(g.disabled=!0)})},options:o.getTypeReward().pipe((0,p.U)(n=>n.data))},expressions:{"props.required":n=>n?.options?.formState?.mainModel?.reward_reference?.is_active||!1}},{key:"value",type:"nz-input-number",className:"",props:{placeholder:"Nh\u1eadp \u0110i\u1ec3m th\u01b0\u1edfng",label:"Gi\xe1 tr\u1ecb",type:"number",min:0},hideExpression:n=>!n?.type||"point"!==n?.type,expressions:{"props.required":n=>n?.options?.formState?.mainModel?.reward_reference?.is_active||!1}},{key:"id",type:"select-custom",props:{label:"Voucher",placeholder:"Ch\u1ecdn voucher",viewValue:"name",labelProp:"name",valueProp:"id",multiple:!0,options:s.getProductFromCampaigns().pipe((0,p.U)(n=>n?.data))},hideExpression:n=>!n?.type||"voucher"!==n?.type,expressions:{"props.required":n=>n?.options?.formState?.mainModel?.reward_reference?.is_active||!1}}]}},{key:"message_template",type:"select-custom",expressions:{"props.disabled":"formState.disabled"},props:{label:"Th\xf4ng b\xe1o",placeholder:"Ch\u1ecdn m\u1eabu th\xf4ng b\xe1o",viewValue:"title",labelProp:"title",valueProp:"id",options:o.getMessageTemplate().pipe((0,p.U)(n=>n.data))}}]}])(this.campaignService,this.productService),this.options={formState:{disabled:!1,required:!1,mainModel:this.model}},this.icomFunctionControl.emit({save:this.handleSave.bind(this)}),"view"===this.mode&&(this.options.formState.disabled=!0)}handleSave(){if(this.form.invalid)return void(0,Q.c2)(this.form);const t=this.model?.reward?.items?.find(i=>"voucher"===i.type),n=this.model?.reward_reference?.items?.find(i=>"voucher"===i.type);if("random"===this.model?.reward?.type&&t&&this.model?.reward?.type_value>t?.id?.length)this.icomMessageService.showAlertMessageError("V\u1edbi h\xecnh th\u1ee9c th\u01b0\u1edfng ng\u1eabu nhi\xean, s\u1ed1 ph\u1ea7n th\u01b0\u1edfng cho m\u1ed7i kh\xe1ch h\xe0ng ph\u1ea3i nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 voucher \u0111\xe3 ch\u1ecdn.");else if("random"===this.model?.reward?.type&&this.model?.reward?.items?.find(i=>"point"===i.type))this.icomMessageService.showAlertMessageError("H\xecnh th\u1ee9c th\u01b0\u1edfng ng\u1eabu nhi\xean ch\u1ec9 \xe1p d\u1ee5ng cho lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng voucher.");else if("random"===this.model?.reward?.type&&n&&this.model?.reward_reference?.type_value>n?.id?.length)this.icomMessageService.showAlertMessageError("V\u1edbi h\xecnh th\u1ee9c th\u01b0\u1edfng ng\u1eabu nhi\xean, s\u1ed1 ph\u1ea7n th\u01b0\u1edfng cho m\u1ed7i kh\xe1ch h\xe0ng ph\u1ea3i nh\u1ecf h\u01a1n ho\u1eb7c b\u1eb1ng s\u1ed1 voucher \u0111\xe3 ch\u1ecdn.");else{if("random"!==this.model?.reward?.type||"random"!==this.model?.reward_reference?.type||!this.model?.reward_reference?.items?.find(i=>"point"===i.type))return!0;this.icomMessageService.showAlertMessageError("H\xecnh th\u1ee9c th\u01b0\u1edfng ng\u1eabu nhi\xean ch\u1ec9 \xe1p d\u1ee5ng cho lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng voucher.")}}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-mission-reward"]],inputs:{mode:"mode",isAdd:"isAdd",data:"data",model:"model"},outputs:{icomFunctionControl:"icomFunctionControl"},standalone:!0,features:[e.jDz],decls:2,vars:6,consts:[["nz-form","",3,"formGroup","nzLayout"],[3,"model","fields","options","form"]],template:function(n,i){1&n&&(e.TgZ(0,"form",0),e._UZ(1,"formly-form",1),e.qZA()),2&n&&(e.Q6J("formGroup",i.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",i.model)("fields",i.fields)("options",i.options)("form",i.form))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,x.j,f.U5,f.Lr,M.N6],encapsulation:2,changeDetection:0})}return o})();var y=r(6976),O=r(5695);const ie={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let H;const ge=new Uint8Array(16);function fe(){if(!H&&(H=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!H))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return H(ge)}const b=[];for(let o=0;o<256;++o)b.push((o+256).toString(16).slice(1));const G=function _e(o,s,t){if(ie.randomUUID&&!s&&!o)return ie.randomUUID();const n=(o=o||{}).random||(o.rng||fe)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,s){t=t||0;for(let i=0;i<16;++i)s[t+i]=n[i];return s}return function oe(o,s=0){return b[o[s+0]]+b[o[s+1]]+b[o[s+2]]+b[o[s+3]]+"-"+b[o[s+4]]+b[o[s+5]]+"-"+b[o[s+6]]+b[o[s+7]]+"-"+b[o[s+8]]+b[o[s+9]]+"-"+b[o[s+10]]+b[o[s+11]]+b[o[s+12]]+b[o[s+13]]+b[o[s+14]]+b[o[s+15]]}(n)},ae=o=>[{fieldGroupClassName:"flex row  mt-4",key:"",fieldGroup:[{key:"value",type:"nz-input-number",className:"basis-2/12 w-36",props:{placeholder:"Nh\u1eadp s\u1ed1",type:"number",min:0,required:!0},expressions:{"props.disabled":"formState.disabled"}},{key:"unit",type:"select-custom",className:"basis-1/12 ml-4",defaultValue:"day",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"day",name:"Ng\xe0y"}]},expressions:{"props.disabled":"formState.disabled"}},{key:"sub_value",type:"select-custom",className:"basis-8/12 ml-4",props:{label:"T\xednh t\u1eeb th\u1eddi \u0111i\u1ec3m",placeholder:"Ch\u1ecdn h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n",viewValue:"title",labelProp:"title",required:!0,valueProp:"id",options:o.getActionMission().pipe((0,p.U)(s=>s.data))},expressions:{"props.disabled":"formState.disabled"}}]}],Ce=o=>[{fieldGroupClassName:"flex row items-center mt-4",key:"",fieldGroup:[{key:"sub_value",type:"select-custom",className:"basis-5/12",props:{placeholder:"Ch\u1ecdn h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n",viewValue:"title",labelProp:"title",required:!0,valueProp:"id",options:o.getActionMission().pipe((0,p.U)(s=>s.data))},expressions:{"props.disabled":"formState.disabled"}}]}],be=o=>[{key:"sub_value_2",type:"select-custom",className:"basis-5/12 mt-4",props:{placeholder:"Ch\u1ecdn h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n",viewValue:"title",label:"Ph\u1ee5 thu\u1ed9c h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n ch\u01b0a x\u1ea3y ra",labelProp:"title",valueProp:"id",required:!0,options:o.getActionMission().pipe((0,p.U)(s=>s.data))}},{key:"sub_value",type:"select-custom",className:"basis-5/12 ml-4",props:{placeholder:"Ch\u1ecdn h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n",viewValue:"title",label:"Ph\u1ee5 thu\u1ed9c h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n \u0111\xe3 x\u1ea3y ra",labelProp:"title",required:!0,valueProp:"id",options:o.getActionMission().pipe((0,p.U)(s=>s.data))}}],le=[{id:"1",name:"Th\u1eddi h\u1ea1n tham gia chi\u1ebfn d\u1ecbch",groupId:"customer",items:[{type:"by_action_by_event",name:"Theo h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n",groupId:"customer",items:[]}]},{id:"2",name:"S\u1ed1 l\u1ea7n th\u1ef1c hi\u1ec7n",groupId:"action",items:[{type:"count_task_complete",name:"S\u1ed1 l\u1ea7n t\xednh ho\xe0n th\xe0nh nhi\u1ec7m v\u1ee5",groupId:"customer",items:[]},{type:"max_action_number",name:"S\u1ed1 l\u1ea7n t\u1ed1i \u0111a",groupId:"customer",items:[]}]},{id:"3",name:"Th\u1eddi gian li\xean quan",groupId:"reward",items:[{type:"time_limited_rewards",name:"Th\u1eddi h\u1ea1n x\xe9t th\u01b0\u1edfng",groupId:"reward",items:[]}]},{id:"4",name:"S\u1ed1 ph\u1ea7n th\u01b0\u1edfng",groupId:"reward",items:[{type:"campaign_limits",name:"Gi\u1edbi h\u1ea1n theo chi\u1ebfn d\u1ecbch",groupId:"reward",items:[]}]},{id:"5",name:"H\xe0nh \u0111\u1ed9ng li\xean quan",groupId:"reward",items:[{type:"action_event_record_rewards",name:"H\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n ghi nh\u1eadn th\u01b0\u1edfng",groupId:"reward",items:[]},{type:"action_event_dependent",name:"H\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n ph\u1ee5 thu\u1ed9c",groupId:"reward",items:[]}]},{id:"6",name:"H\u1ed3 s\u01a1 kh\xe1ch h\xe0ng",groupId:"customer_reference",items:[{type:"thoi_gian_dang_ky",name:"Theo th\u1eddi gian \u0111\u0103ng k\xfd m\u1edbi",groupId:"customer_reference",items:[{type:"count_task_complete",name:"S\u1ed1 l\u1ea7n t\xednh ho\xe0n th\xe0nh nhi\u1ec7m v\u1ee5",groupId:"customer_reference",items:[]},{type:"max_action_number",name:"S\u1ed1 l\u1ea7n t\u1ed1i \u0111a",groupId:"customer_reference",items:[]}]}]}];function xe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"li",7)(1,"ul",8)(2,"nz-list-item-action")(3,"a",9),e.NdJ("click",function(i){const l=e.CHM(t).$implicit,h=e.oxw(2);return e.KtG(h.handlerClick(i,l))}),e._uU(4,"+"),e.qZA()()(),e._uU(5),e.qZA()}if(2&o){const t=s.$implicit;e.xp6(5),e.hij(" ",t.name," ")}}function ze(o,s){if(1&o&&(e.TgZ(0,"ul",5),e.YNc(1,xe,6,1,"li",6),e.qZA()),2&o){const t=e.oxw();e.Q6J("nzDataSource",t.listFormula),e.xp6(1),e.Q6J("ngForOf",t.listFormula)}}function Te(o,s){if(1&o&&(e.TgZ(0,"nz-tag",10),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("nzMode","closeable"),e.xp6(1),e.hij(" ",t.name," ")}}let Me=(()=>{class o{constructor(){this.form=new d.cw({}),this.fields=[],this.options={formState:{disabled:!0}},this.listFormula=[],this.listFormulaSelected=[],this.icomSave=new e.vpe,this.cdr=(0,e.f3M)(e.sBO),this.model={},this.fields=[{key:"group",type:"select-custom",defaultValue:"customer",props:{label:"Ti\xeau ch\xed c\u1ea5p 1",viewValue:"name",labelProp:"name",valueProp:"id",options:[{id:"customer",name:"Kh\xe1ch h\xe0ng"},{id:"action",name:"H\xe0nh \u0111\u1ed9ng/ S\u1ef1 ki\u1ec7n"},{id:"reward",name:"Ph\u1ea7n th\u01b0\u1edfng"},{id:"customer_reference",name:"Ng\u01b0\u1eddi \u0111\u01b0\u1ee3c m\u1eddi"}]}},{key:"sub_group",type:"select-custom",props:{label:"Ti\xeau ch\xed c\u1ea5p 2",viewValue:"name",labelProp:"name",valueProp:"id",options:[]},hooks:{onInit:t=>{const n=le,i=t?.parent?.get?.("group").formControl;t.props.options=i?.valueChanges.pipe((0,J.O)(i.value),(0,N.x)(),(0,p.U)(()=>{const a=i.value,l=n.filter(g=>g.groupId===a);return l.find(g=>a===g.id)||t.formControl.setValue(null),l&&l&&l.length&&(this.listItemSelected=l||[]),l}))}}}]}ngOnInit(){setTimeout(()=>{this.form.controls.sub_group?.valueChanges.subscribe({next:t=>{let n=[];this.listItemSelected.forEach(i=>{const a=[i].find(l=>l.id===t)?.items;a&&a.length&&(n=a)}),this.listFormula=n,this.cdr.detectChanges()}})},200)}handlerClick(t,n){t.stopPropagation(),t.preventDefault(),!(this.listFormulaSelected&&this.listFormulaSelected.length&&this.listFormulaSelected.find(i=>i.type===n.type))&&(this.listFormulaSelected.push(n),this.cdr.detectChanges())}trackByFn(t,n){return n.id}handlerSave(){this.icomSave.emit(this.listFormulaSelected.map(t=>({...t,id:t.id||G()})))}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-mission-condition-modal"]],outputs:{icomSave:"icomSave"},standalone:!0,features:[e.jDz],decls:5,vars:9,consts:[["nz-form","",3,"formGroup","nzLayout"],[3,"model","fields","options","form"],["nz-list","","nzBordered","","nzSize","small",3,"nzDataSource",4,"ngIf"],[1,"mt-4","w-full","h-full"],[3,"nzMode",4,"ngFor","ngForOf","ngForTrackBy"],["nz-list","","nzBordered","","nzSize","small",3,"nzDataSource"],["nz-list-item","","nzNoFlex","",4,"ngFor","ngForOf"],["nz-list-item","","nzNoFlex",""],["nz-list-item-actions",""],[3,"click"],[3,"nzMode"]],template:function(n,i){1&n&&(e.TgZ(0,"form",0),e._UZ(1,"formly-form",1),e.qZA(),e.YNc(2,ze,2,2,"ul",2),e.TgZ(3,"div",3),e.YNc(4,Te,2,2,"nz-tag",4),e.qZA()),2&n&&(e.Q6J("formGroup",i.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",i.model)("fields",i.fields)("options",i.options)("form",i.form),e.xp6(1),e.Q6J("ngIf",i.listFormula&&i.listFormula.length),e.xp6(2),e.Q6J("ngForOf",i.listFormulaSelected)("ngForTrackBy",i.trackByFn))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,z.O5,x.j,f.U5,f.Lr,M.N6,y.Ph,y.n_,y.AA,y.nk,y.KC,z.ax,O.X,O.j],encapsulation:2,changeDetection:0})}return o})();var Ie=r(2787),we=r(9691);let Ee=(()=>{class o{transform(t){let n="";return t.group&&(n+=[{id:"customer",name:"Kh\xe1ch h\xe0ng"},{id:"action",name:"H\xe0nh \u0111\u1ed9ng/ S\u1ef1 ki\u1ec7n"},{id:"reward",name:"Ph\u1ea7n th\u01b0\u1edfng"},{id:"customer_reference",name:"Ng\u01b0\u1eddi \u0111\u01b0\u1ee3c m\u1eddi"}].find(i=>i.id===t.group)?.name||""),t.type&&(n+=" - ",n+=le.find(i=>i.groupId===t.group)?.name||""),n}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275pipe=e.Yjl({name:"icomLibsCampaignConvertTooltipConditionPipe",type:o,pure:!0,standalone:!0})}return o})();var R=r(855),$=r(1958),de=r(2920);function Se(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handlerAddCondition(i))}),e._uU(1," Th\xeam \u0111i\u1ec1u ki\u1ec7n "),e.qZA()}}function Fe(o,s){if(1&o&&(e.TgZ(0,"form",13),e._UZ(1,"formly-form",14),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw(2);e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t)("fields",t.fields)("options",n.options)("form",t.form)}}function ke(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(2).$implicit,l=e.oxw(2);return e.KtG(l.handlerRemove(i,a))}),e._uU(1),e.qZA()}2&o&&(e.Q6J("nzType","default")("nzDanger",!0),e.xp6(1),e.hij(" ","X\xf3a"," "))}const De=function(){return{type:"info-circle",theme:"outline"}};function Ae(o,s){if(1&o&&(e.TgZ(0,"div",7),e.ynx(1),e.TgZ(2,"nz-form-label",8),e.ALo(3,"icomLibsCampaignConvertTooltipConditionPipe"),e.TgZ(4,"span",9),e._uU(5),e.qZA()(),e.TgZ(6,"div",10),e.YNc(7,Fe,2,5,"form",11),e.YNc(8,ke,2,3,"button",12),e.qZA(),e.BQk(),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(2),e.Q6J("nzTooltipTitle",e.lcZ(3,5,t))("nzTooltipIcon",e.DdM(7,De)),e.xp6(3),e.hij(" ",(null==t?null:t.name)||""," "),e.xp6(2),e.Q6J("ngIf",t.fields),e.xp6(1),e.Q6J("ngIf","edit"===n.mode)}}function Ne(o,s){if(1&o&&(e.ynx(0),e.YNc(1,Ae,9,8,"div",6),e.BQk()),2&o){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf",!t.specific_hidden)}}function Le(o,s){if(1&o&&(e.ynx(0),e.YNc(1,Ne,2,1,"ng-container",5),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.dataCondition.config)}}let Ze=(()=>{class o{constructor(){this.fields=[],this.options={formState:{disabled:!1}},this.modalService=(0,e.f3M)(F.Sf),this.viewContainerRef=(0,e.f3M)(e.s_b),this.nzModalData=(0,e.f3M)(F.uB),this.cdr=(0,e.f3M)(e.sBO),this.campaignService=(0,e.f3M)(w.wb),this.icomFunctionControl=new e.vpe,this.model={}}ngOnInit(){this.icomFunctionControl.emit({save:this.handleSave.bind(this)}),this.dataCondition&&!this.dataCondition.config&&(this.dataCondition.config=[]),"view"===this.mode&&(this.options.formState.disabled=!0),this.mapFormField()}mapFormField(){const t=(o=>[{type:"by_action_by_event",fields:[...ae(o),{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],group:"customer",specific_name_formula:"Theo h\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n",form:new d.cw({})},{type:"count_task_complete",group:"action",specific_name_formula:"S\u1ed1 l\u1ea7n t\xednh ho\xe0n th\xe0nh nhi\u1ec7m v\u1ee5",fields:[{key:"value",type:"nz-input-number",className:"w-36 flex",props:{placeholder:"Nh\u1eadp s\u1ed1 l\u1ea7n",nzPlaceHolder:"Nh\u1eadp s\u1ed1 l\u1ea7n",type:"number",required:!0,min:0},expressions:{"props.disabled":"formState.disabled"}},{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],form:new d.cw({})},{type:"max_action_number",group:"action",specific_name_formula:"S\u1ed1 l\u1ea7n t\u1ed1i \u0111a",fields:[{key:"value",type:"nz-input-number",className:"w-36 flex",props:{placeholder:"Nh\u1eadp s\u1ed1 l\u1ea7n",nzPlaceHolder:"Nh\u1eadp s\u1ed1 l\u1ea7n",type:"number",required:!0,min:0},expressions:{"props.disabled":"formState.disabled"}},{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],form:new d.cw({})},{type:"time_limited_rewards",group:"reward",specific_name_formula:"Th\u1eddi h\u1ea1n x\xe9t th\u01b0\u1edfng",fields:[...ae(o),{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],form:new d.cw({})},{type:"campaign_limits",group:"reward",specific_name_formula:"Gi\u1edbi h\u1ea1n theo chi\u1ebfn d\u1ecbch",fields:[{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],form:new d.cw({})},{type:"action_event_record_rewards",group:"reward",specific_name_formula:"H\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n ghi nh\u1eadn th\u01b0\u1edfng",fields:[...Ce(o),{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],form:new d.cw({})},{type:"action_event_dependent",group:"reward",specific_name_formula:"H\xe0nh \u0111\u1ed9ng/ s\u1ef1 ki\u1ec7n ph\u1ee5 thu\u1ed9c",fields:[...be(o),{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],form:new d.cw({})},{type:"thoi_gian_dang_ky",fields:[{key:"after_specific_day",type:"date",className:"mt-4",props:{className:"mt-4",format:"dd-MM-yyyy",required:!0,nzShowTime:!1,label:"T\u1eeb",placeholder:"DD/MM/YYYY",emitTimeLocal:!0,onlyDay:!0},expressions:{"props.disabled":"formState.disabled"}},{key:"before_specific_day",type:"date",className:"mt-4",props:{label:"\u0110\u1ebfn",className:"mt-4",format:"dd-MM-yyyy",placeholder:"DD/MM/YYYY",required:!0,nzShowTime:!1,emitTimeLocal:!0,onlyDay:!0},expressions:{"props.disabled":"formState.disabled"}},{key:"operator",type:"select-custom",className:"flex",defaultValue:"&&",props:{viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:[{id:"&&",name:"V\xe0"},{id:"||",name:"Ho\u1eb7c"}]},expressions:{"props.disabled":"formState.disabled"}}],group:"customer_reference",specific_name_formula:"Th\u1eddi h\u1ea1n c\u1ee5 th\u1ec3",form:new d.cw({})}])(this.campaignService);this.dataCondition.config.forEach((n,i)=>{const a=t.find(l=>l.type===n.type);a&&(this.dataCondition.config[i]={...n,...a})})}handlerAddCondition(t){t.stopPropagation(),t.preventDefault();const n=this.modalService.create({nzTitle:"Th\xeam \u0111i\u1ec1u ki\u1ec7n \xe1p d\u1ee5ng",nzContent:Me,nzMaskClosable:!1,nzClosable:!1,nzViewContainerRef:this.viewContainerRef,nzWidth:968,nzFooter:[{label:"\u0110\xf3ng",onClick:()=>n.destroy()},{label:"L\u01b0u",type:"primary",loading:!1,onClick(){n.getContentComponent().handlerSave(),n.destroy()}}]});n.getContentComponent().icomSave.subscribe(a=>{this.dataCondition.config&&this.dataCondition.config.push(...a),this.dataCondition.config=[...this.dataCondition.config],this.mapFormField(),this.cdr.detectChanges()})}handleSave(){let t=!1;return this.dataCondition.config&&this.dataCondition.config.forEach(i=>{if(i?.form){if(i?.form&&!i?.form?.valid)return Object.keys(i.form.controls).forEach(a=>{i.form.controls[a].touched=!0}),void(t=!0);i.form.markAsTouched(),i.form.submitted=!0}}),!t&&(this.dataCondition?.config||this.dataCondition?.config.length?(this.dataCondition.relationship="",this.dataMission&&this.dataMission.click_action_param&&"APP_SCREEN_WORKER_PROFILE"===this.dataMission.click_action_param&&!this.dataCondition.config.find(i=>"uuid2"===i.id)&&this.dataCondition.config?.push({attribute:"full_name",group:"customer",id:"uuid2",operator:"is_not_empty",type:"customer_profile",specific_hidden:!0},{attribute:"email",group:"customer",id:"uuid3",operator:"is_not_empty",type:"customer_profile",specific_hidden:!0},{attribute:"birthdate",group:"customer",id:"uuid4",operator:"is_not_empty",type:"customer_profile",specific_hidden:!0},{attribute:"address_city",group:"customer",id:"uuid5",operator:"is_not_empty",type:"customer_profile",specific_hidden:!0}),this.dataCondition?.config?.find(i=>"thoi_gian_dang_ky"===i.type&&"customer_reference"===i.group)&&(this.dataCondition?.config?.find(i=>"after_specific_day"===i.operator)&&(this.dataCondition.config=this.dataCondition?.config.filter(i=>"after_specific_day"!==i.operator)),this.dataCondition?.config?.find(i=>"before_specific_day"===i.operator)&&(this.dataCondition.config=this.dataCondition?.config.filter(i=>"before_specific_day"!==i.operator)),this.dataCondition.config.push(...this.convertObject(this.dataCondition?.config?.find(i=>"thoi_gian_dang_ky"===i.type)))),console.log(this.dataCondition),this.dataCondition.config.forEach((i,a)=>{this.dataCondition.relationship+=` ${i.id} ${a!==this.dataCondition.config.length-1?"&&":""}`,delete i.fields,delete i.form}),!0):void 0)}convertObject(t){const n=[];return t.after_specific_day&&n.push({operator:"after_specific_day",attribute:"thoi_gian_dang_ky",type:"customer_profile",group:"customer_reference",specific_hidden:!0,value:t.after_specific_day,id:G()}),t.before_specific_day&&n.push({operator:"before_specific_day",attribute:"thoi_gian_dang_ky",value:t.before_specific_day,group:"customer_reference",type:"customer_profile",id:G(),specific_hidden:!0}),n}handlerRemove(t,n){t.stopPropagation(),t.preventDefault(),this.dataCondition.config=this.dataCondition.config?.filter(i=>i.id!==n.id),this.dataCondition.relationship="",this.dataCondition?.config?.forEach(i=>{this.dataCondition.relationship+=` ${i.id} ${i.operator} `}),this.cdr.detectChanges()}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-mission-condition"]],inputs:{dataCondition:"dataCondition",dataMission:"dataMission",isAdd:"isAdd",mode:"mode"},outputs:{icomFunctionControl:"icomFunctionControl"},standalone:!0,features:[e.jDz],decls:4,vars:2,consts:[[1,"w-full","h-full"],[1,"flex","justify-end"],["class","flex","nz-button","","nzType","primary",3,"click",4,"ngIf"],[4,"ngIf"],["nz-button","","nzType","primary",1,"flex",3,"click"],[4,"ngFor","ngForOf"],["class","flex flex-col mt-2 border p-2 rounded-sm",4,"ngIf"],[1,"flex","flex-col","mt-2","border","p-2","rounded-sm"],["nzRequired","",1,"!w-full","!text-left",3,"nzTooltipTitle","nzTooltipIcon"],[1,"text-xs","font-semibold"],[1,"flex","items-baseline"],["class","ml-4 w-full","nz-form","",3,"formGroup",4,"ngIf"],["class","ml-4","nz-button","",3,"nzType","nzDanger","click",4,"ngIf"],["nz-form","",1,"ml-4","w-full",3,"formGroup"],[3,"model","fields","options","form"],["nz-button","",1,"ml-4",3,"nzType","nzDanger","click"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Se,2,0,"button",2),e.qZA(),e.YNc(3,Le,2,1,"ng-container",3),e.qZA()),2&n&&(e.xp6(2),e.Q6J("ngIf","edit"===i.mode),e.xp6(1),e.Q6J("ngIf",(null==i.dataCondition?null:i.dataCondition.config)&&(null==i.dataCondition||null==i.dataCondition.config?null:i.dataCondition.config.length)))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,v.ix,R.w,$.dQ,z.O5,x.j,f.U5,de.t3,f.Lr,f.iK,M.N6,z.ax,Ie.b1,we.LV,d.u5,Ee],encapsulation:2,changeDetection:0})}return o})();const Pe=["customFooter"],Je=function(){return[]};function Ue(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-campaign-management-detail-mission-information",9),e.NdJ("icomFunctionControl",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handlerFunctionControl(i))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("model",t.model)("mode",t.nzModalData.mode)("modeExtend",t.nzModalData.modeExtend)("missions",t.nzModalData.missions||e.DdM(4,Je))}}function Qe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-campaign-management-detail-mission-reward",10),e.NdJ("icomFunctionControl",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handlerFunctionControl(i))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("model",t.model)("data",t.model)("mode",t.nzModalData.mode)}}function Oe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-campaign-management-detail-mission-condition",11),e.NdJ("icomFunctionControl",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handlerFunctionControl(i))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("mode",t.nzModalData.mode)("dataCondition",null==t.model?null:t.model.condition)("dataMission",t.model)}}function Ve(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handlerPrev(i))}),e.TgZ(1,"span"),e._uU(2,"Quay l\u1ea1i"),e.qZA()()}}function Ge(o,s){1&o&&(e.ynx(0),e.YNc(1,Ve,3,0,"button",13),e.BQk())}function Ye(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handlerNextStep(i))}),e.TgZ(1,"span"),e._uU(2,"Ti\u1ebfp t\u1ee5c"),e.qZA()()}}function qe(o,s){1&o&&(e.ynx(0),e.YNc(1,Ye,3,0,"button",15),e.BQk())}function Be(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(3);return e.KtG(a.handlerSave(i))}),e.TgZ(1,"span"),e._uU(2,"L\u01b0u"),e.qZA()()}}function je(o,s){1&o&&(e.ynx(0),e.YNc(1,Be,3,0,"button",15),e.BQk())}function He(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handlerClose(i))}),e.TgZ(1,"span"),e._uU(2,"\u0110\xf3ng"),e.qZA()()}}function Re(o,s){if(1&o&&(e.TgZ(0,"nz-space"),e.YNc(1,Ge,2,0,"ng-container",12),e.YNc(2,qe,2,0,"ng-container",12),e.YNc(3,je,2,0,"ng-container",12),e.ynx(4),e.YNc(5,He,3,0,"button",13),e.BQk(),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.current>0),e.xp6(1),e.Q6J("ngIf",t.current<2),e.xp6(1),e.Q6J("ngIf",2===t.current&&"edit"===t.nzModalData.mode)}}let $e=(()=>{class o{constructor(){this.nzModalData=(0,e.f3M)(F.uB),this.cdr=(0,e.f3M)(e.sBO),this.icomSave=new e.vpe,this.current=0}ngOnInit(){this.model=this.nzModalData.model,this.model&&!this.model.condition&&(this.model.condition={}),this.model&&!this.model.reward&&(this.model.reward={}),this.model&&!this.model.reward_reference&&(this.model.reward_reference={})}ngAfterViewInit(){const t=this.modal;t.updateConfig({nzFooter:this.templateFooter}),t.containerInstance.cdr.detectChanges(),this.cdr.detectChanges()}handlerNextStep(t){if(t.stopPropagation(),t.preventDefault(),this.eventFunctionControl&&this.eventFunctionControl.save&&this.eventFunctionControl.save())return this.current++,void this.cdr.detectChanges();"view"===this.nzModalData.mode&&(this.current++,this.cdr.detectChanges())}handlerFunctionControl(t){this.eventFunctionControl=t}handlerPrev(t){t.stopPropagation(),t.preventDefault(),this.current--,this.cdr.detectChanges()}handlerSave(t){t.stopPropagation(),t.preventDefault(),this.eventFunctionControl&&this.eventFunctionControl.save&&this.eventFunctionControl.save()&&(this.icomSave.emit(this.model),this.cdr.detectChanges())}handlerClose(t){t.stopPropagation(),t.preventDefault(),this.icomSave.emit(),this.cdr.detectChanges()}handlerIndexChange(t){if(this.current!==t){if("view"===this.nzModalData.mode&&(this.current===t+1||this.current===t-1))return void(this.current=t);"edit"===this.nzModalData.mode&&this.eventFunctionControl&&this.eventFunctionControl.save&&this.eventFunctionControl.save()&&(this.current+=1)}}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-mission-add_edit"]],viewQuery:function(n,i){if(1&n&&e.Gf(Pe,5),2&n){let a;e.iGM(a=e.CRH())&&(i.templateFooter=a.first)}},inputs:{model:"model",isAdd:"isAdd",modal:"modal"},outputs:{icomSave:"icomSave"},standalone:!0,features:[e.jDz],decls:10,vars:4,consts:[["nzProgressDot","",3,"nzCurrent","nzIndexChange"],["nzDescription","1. Th\xf4ng tin chung"],["nzDescription","2. Ph\u1ea7n th\u01b0\u1edfng"],["nzDescription","3. \u0110i\u1ec1u ki\u1ec7n \xe1p d\u1ee5ng"],[1,"steps-content","mt-4","p-4","w-full","border","border-zinc-300"],[3,"model","mode","modeExtend","missions","icomFunctionControl",4,"ngIf"],[3,"model","data","mode","icomFunctionControl",4,"ngIf"],[3,"mode","dataCondition","dataMission","icomFunctionControl",4,"ngIf"],["customFooter",""],[3,"model","mode","modeExtend","missions","icomFunctionControl"],[3,"model","data","mode","icomFunctionControl"],[3,"mode","dataCondition","dataMission","icomFunctionControl"],[4,"ngIf"],["nz-button","","nzType","default",3,"click",4,"nzSpaceItem"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"click"]],template:function(n,i){1&n&&(e.TgZ(0,"nz-steps",0),e.NdJ("nzIndexChange",function(l){return i.handlerIndexChange(l)}),e._UZ(1,"nz-step",1)(2,"nz-step",2)(3,"nz-step",3),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,Ue,1,5,"icom-libs-campaign-management-detail-mission-information",5),e.YNc(6,Qe,1,3,"icom-libs-campaign-management-detail-mission-reward",6),e.YNc(7,Oe,1,3,"icom-libs-campaign-management-detail-mission-condition",7),e.qZA(),e.YNc(8,Re,6,3,"ng-template",null,8,e.W1O)),2&n&&(e.Q6J("nzCurrent",i.current),e.xp6(5),e.Q6J("ngIf",0===i.current),e.xp6(1),e.Q6J("ngIf",1===i.current),e.xp6(1),e.Q6J("ngIf",2===i.current))},dependencies:[I.u,d.UX,_.X0,v.sL,v.ix,R.w,$.dQ,z.O5,x.j,f.U5,M.N6,M.iy,M.$W,S.zf,S.NU,S.$1,C,k,Ze],encapsulation:2,changeDetection:0})}return o})();var pe=r(804),Xe=r(8125),K=r(6990),We=r(2572),et=r(2530),me=r(2996);function tt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handlerAddNew(i,void 0,"edit"))}),e._uU(2," Th\xeam nhi\u1ec7m v\u1ee5 "),e.qZA()()}}function nt(o,s){1&o&&e._UZ(0,"nz-empty",11),2&o&&e.Q6J("nzNotFoundContent","Kh\xf4ng t\xecm th\u1ea5y nhi\u1ec7m v\u1ee5.")}function it(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.handleEditMission(i,a,"view"))}),e._uU(1),e.qZA()}2&o&&(e.xp6(1),e.hij(" ","Xem"," "))}function ot(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.handlerCopy(i,a))}),e._uU(1),e.qZA()}2&o&&(e.Q6J("nzType","default"),e.xp6(1),e.hij(" ","Sao ch\xe9p"," "))}function at(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.handleEditMission(i,a,"edit"))}),e._uU(1),e.qZA()}2&o&&(e.xp6(1),e.hij(" ","S\u1eeda"," "))}function st(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.handlerRemove(i,a))}),e._uU(1),e.qZA()}2&o&&(e.Q6J("nzType","default")("nzDanger",!0),e.xp6(1),e.hij(" ","X\xf3a"," "))}function rt(o,s){if(1&o&&(e.ynx(0),e._UZ(1,"nz-statistic",30),e.BQk()),2&o){const t=s.ngIf;e.xp6(1),e.Q6J("nzValue",(null==t?null:t.title)||"")}}function lt(o,s){if(1&o&&(e.TgZ(0,"span",33),e._uU(1),e.ALo(2,"number"),e.qZA(),e.TgZ(3,"span",34),e._uU(4),e.ALo(5,"number"),e.qZA()),2&o){const t=e.oxw().ngIf,n=e.oxw().$implicit;e.xp6(1),e.AsE("",(null==t?null:t.title)||""," / ",e.lcZ(2,3,(null==t?null:t.balance)||0),""),e.xp6(3),e.hij("(",e.lcZ(5,5,(null==n||null==n.sponsor?null:n.sponsor[0].value)||0),"%)")}}function dt(o,s){if(1&o&&(e.ynx(0),e._UZ(1,"nz-statistic",31),e.YNc(2,lt,6,7,"ng-template",null,32,e.W1O),e.BQk()),2&o){const t=e.MAs(3);e.xp6(1),e.Q6J("nzValueTemplate",t)}}function pt(o,s){if(1&o&&(e.ynx(0),e._UZ(1,"nz-statistic",35),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("nzValue","normal"===t.type?"Nhi\u1ec7m v\u1ee5 th\xf4ng th\u01b0\u1eddng":"Nhi\u1ec7m v\u1ee5 \u0111\u1eb7c bi\u1ec7t")}}function mt(o,s){1&o&&(e.TgZ(0,"span"),e._uU(1,"\xa0\xa0\xa0 "),e.qZA())}function ct(o,s){if(1&o&&(e.TgZ(0,"div"),e._UZ(1,"i",39),e.TgZ(2,"span",34),e._uU(3),e.qZA(),e.YNc(4,mt,2,0,"span",21),e.qZA()),2&o){const t=s.$implicit,n=s.index,i=e.oxw().ngIf;e.xp6(1),e.Q6J("nzType","point"===(null==t?null:t.type)?"point":"gift"),e.xp6(2),e.Oqu("point"===(null==t?null:t.type)?"\u0110i\u1ec3m th\u01b0\u1edfng":"Voucher"),e.xp6(1),e.Q6J("ngIf",n<i.length-1)}}function ut(o,s){if(1&o&&(e.TgZ(0,"div",37),e.YNc(1,ct,5,3,"div",38),e.qZA()),2&o){const t=s.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function ht(o,s){if(1&o&&e.YNc(0,ut,2,1,"div",36),2&o){const t=e.oxw().$implicit;e.Q6J("ngIf",null==t||null==t.reward?null:t.reward.items)}}function gt(o,s){if(1&o&&(e.TgZ(0,"div",14)(1,"nz-page-header")(2,"nz-page-header-title",15),e._uU(3),e.qZA(),e.TgZ(4,"nz-page-header-extra")(5,"div",9),e.YNc(6,it,2,1,"button",16),e.YNc(7,ot,2,2,"button",17),e.YNc(8,at,2,1,"button",18),e.YNc(9,st,2,3,"button",19),e.qZA()(),e.TgZ(10,"nz-page-header-content")(11,"nz-row",20),e.YNc(12,rt,2,1,"ng-container",21),e.ALo(13,"icomCampaignDetailMissionParseValue"),e.YNc(14,dt,4,1,"ng-container",21),e.ALo(15,"icomCampaignDetailMissionParseValue"),e._UZ(16,"nz-statistic",22),e.qZA(),e.TgZ(17,"nz-row",23),e.YNc(18,pt,2,1,"ng-container",21),e.ynx(19),e._UZ(20,"nz-statistic",24),e.YNc(21,ht,1,1,"ng-template",null,25,e.W1O),e.BQk(),e._UZ(23,"nz-statistic",26),e.qZA()()()()),2&o){const t=s.$implicit,n=e.MAs(22),i=e.oxw(2);e.xp6(3),e.hij("",(null==t?null:t.name)||""," "),e.xp6(3),e.Q6J("ngIf","view"===i.mode),e.xp6(1),e.Q6J("ngIf","edit"===i.mode),e.xp6(1),e.Q6J("ngIf","edit"===i.mode),e.xp6(1),e.Q6J("ngIf","edit"===i.mode),e.xp6(3),e.Q6J("ngIf",e.xi3(13,10,t.action,i.listDataActionMission)),e.xp6(2),e.Q6J("ngIf",e.xi3(15,13,null==t.sponsor||null==t.sponsor[0]?null:t.sponsor[0].id,i.listDataContributor)),e.xp6(2),e.Q6J("nzValue",(null==t||null==t.reward?null:t.reward.name)||""),e.xp6(2),e.Q6J("ngIf",t.type),e.xp6(2),e.Q6J("nzValueTemplate",n)}}function ft(o,s){if(1&o&&(e.TgZ(0,"div",12),e.YNc(1,gt,24,16,"div",13),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==t.data?null:t.data.missions)}}let _t=(()=>{class o{constructor(){this.form=new d.cw({}),this.fields=[],this.options={formState:{disabled:!1}},this.modalService=(0,e.f3M)(F.Sf),this.viewContainerRef=(0,e.f3M)(e.s_b),this.cdr=(0,e.f3M)(e.sBO),this.campaignService=(0,e.f3M)(w.wb),this.IComMessageService=(0,e.f3M)(c.Q),this.icomFunctionControl=new e.vpe,this.listDataActionMission=[],this.listDataContributor=[],this.fields=(o=>[{fieldGroupClassName:"flex row items-center",key:"",fieldGroup:[{key:"order_type",type:"select-custom",className:"basis-5/12",props:{label:"Th\u1ee9 t\u1ef1 th\u1ef1c hi\u1ec7n",placeholder:"Ch\u1ecdn th\u1ee9 t\u1ef1",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getListOrderAction().pipe((0,p.U)(s=>s.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"quantity",type:"nz-input-number",className:"basis-2/12 ml-4",props:{label:"S\u1ed1 nhi\u1ec7m v\u1ee5 t\u1ed1i \u0111a",placeholder:"Nh\u1eadp s\u1ed1",required:!0,type:"number",min:1},expressions:{"props.disabled":"formState.disabled"}},{key:"order_by",type:"select-custom",className:"basis-5/12 ml-4",props:{label:" ",placeholder:"Select Category",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:o.getListOrderActionBy().pipe((0,p.U)(s=>s.data))},expressions:{"props.disabled":"formState.disabled"}}]}])(this.campaignService)}ngOnInit(){this.icomFunctionControl.emit({save:this.handleSave.bind(this)}),"view"===this.mode&&(this.options.formState.disabled=!0),(0,We.a)([this.campaignService.getActionMission(),this.campaignService.getContributor()]).subscribe(t=>{const[n,i]=t;this.listDataActionMission=n?.data,this.listDataContributor=i?.data,this.cdr.detectChanges()})}handlerAddNew(t,n,i){t.stopPropagation(),t.preventDefault();const a=this.modalService.create({nzTitle:n&&"copy"!==i?`S\u1eeda nhi\u1ec7m v\u1ee5: ${n.name}`:"Th\xeam nhi\u1ec7m v\u1ee5",nzContent:$e,nzMaskClosable:!1,nzKeyboard:!1,nzClosable:!0,nzViewContainerRef:this.viewContainerRef,nzData:{model:(0,K.cloneDeep)(n)||{},isAdd:!0,mode:"copy"===i?"edit":i,missions:this.data.missions||[],modeExtend:i},nzWidth:968,nzFooter:[]}),l=a.getContentComponent();l.icomSave.subscribe(h=>{if(!h)return a.close(),void this.cdr.detectChanges();(!this.data?.missions||!this.data?.missions?.length)&&(this.data.missions=[]),h.id?this.mergeObjects(n,h):this.data.missions?.push({...h,id:G()}),a.close(),this.cdr.detectChanges()}),l.modal=a}handleEditMission(t,n,i){t.stopPropagation(),t.preventDefault(),this.handlerAddNew(t,n,i)}mergeObjects(t,n){for(const i in n)n.hasOwnProperty(i)&&(t.hasOwnProperty(i),t[i]=n[i])}handlerRemove(t,n){t.stopPropagation(),this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n xo\xe1 nhi\u1ec7m v\u1ee5 ${n.name} kh\xf4ng ?`,nzOkText:"C\xf3",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!0,nzOnOk:this.processDeleteMission.bind(this,n),nzCancelText:"Kh\xf4ng"},"error")}handlerCopy(t,n){t.stopPropagation(),this.handlerAddNew(t,{...n,id:""},"copy")}handleSave(){return this.form.valid?(this.form.markAsTouched(),this.form.submitted=!0,!!this.data?.missions?.length||(this.IComMessageService.showAlertMessageError("B\u1ea1n ch\u01b0a ch\u1ecdn nhi\u1ec7m v\u1ee5."),!1)):(Object.keys(this.form.controls).forEach(t=>{this.form.controls[t].touched=!0}),!1)}processDeleteMission(t){this.data.missions=this.data?.missions?.filter(n=>n.id!==t.id),this.cdr.detectChanges()}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-mission"]],inputs:{data:"data",mode:"mode"},outputs:{icomFunctionControl:"icomFunctionControl"},standalone:!0,features:[e.jDz],decls:9,vars:9,consts:[[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","bg-white","border","pl-4","pt-4","rounded-md"],["nz-form","",1,"pr-4",3,"formGroup","nzLayout"],[3,"model","fields","options","form"],["class","flex",4,"ngIf"],[1,"w-full","h-full","overflow-auto","pr-4"],["nzNotFoundImage","simple","class","h-full w-full flex justify-center items-center border border-slate-300 flex-col !m-0 pt-2",3,"nzNotFoundContent",4,"ngIf"],["class","!mt-4",4,"ngIf"],[1,"h-3"],[1,"flex"],["nz-button","","nzType","primary",3,"click"],["nzNotFoundImage","simple",1,"h-full","w-full","flex","justify-center","items-center","border","border-slate-300","flex-col","!m-0","pt-2",3,"nzNotFoundContent"],[1,"!mt-4"],["class","border border-slate-300 mt-4",4,"ngFor","ngForOf"],[1,"border","border-slate-300","mt-4"],[1,"!text-sm"],["nz-button","","nzType","primary",3,"click",4,"ngIf"],["class","ml-4","nz-button","",3,"nzType","click",4,"ngIf"],["nz-button","","class","ml-4","nzType","primary",3,"click",4,"ngIf"],["class","ml-4","nz-button","",3,"nzType","nzDanger","click",4,"ngIf"],["nzType","flex","nzJustify","space-between","nzAlign","middle"],[4,"ngIf"],["nzTitle","T\xean ph\u1ea7n th\u01b0\u1edfng",3,"nzValue"],["nzType","flex","nzJustify","space-between","nzAlign","middle",1,"mt-4"],["nzTitle","Lo\u1ea1i ph\u1ea7n th\u01b0\u1edfng ",3,"nzValueTemplate"],["templateTypeReward",""],["nzTitle","H\xe0nh \u0111\u1ed9ng th\u1ef1c hi\u1ec7n b v\u1ee5",2,"visibility","hidden"],["nz-button","",1,"ml-4",3,"nzType","click"],["nz-button","","nzType","primary",1,"ml-4",3,"click"],["nz-button","",1,"ml-4",3,"nzType","nzDanger","click"],["nzTitle","H\xe0nh \u0111\u1ed9ng th\u1ef1c hi\u1ec7n nhi\u1ec7m v\u1ee5",3,"nzValue"],["nzTitle","Nh\xe0 t\xe0i tr\u1ee3 / T\xe0i kho\u1ea3n k\xfd qu\u1ef9 (T\u1ef7 l\u1ec7)",3,"nzValueTemplate"],["templateTime",""],[1,"text-xs"],[1,"text-xs","ml-2"],["nzTitle","Lo\u1ea1i nhi\u1ec7m v\u1ee5",3,"nzValue"],["class","flex items-center",4,"ngIf"],[1,"flex","items-center"],[4,"ngFor","ngForOf"],["nz-icon","",1,"text-xl",3,"nzType"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e._UZ(3,"formly-form",3),e.qZA(),e.YNc(4,tt,3,0,"div",4),e.TgZ(5,"div",5),e.YNc(6,nt,1,1,"nz-empty",6),e.YNc(7,ft,2,1,"div",7),e._UZ(8,"div",8),e.qZA()()()),2&n&&(e.xp6(2),e.Q6J("formGroup",i.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",i.data)("fields",i.fields)("options",i.options)("form",i.form),e.xp6(1),e.Q6J("ngIf","edit"===i.mode),e.xp6(2),e.Q6J("ngIf",!(null!=i.data&&i.data.missions&&null!=i.data&&i.data.missions.length)),e.xp6(1),e.Q6J("ngIf",(null==i.data?null:i.data.missions)&&(null==i.data?null:i.data.missions.length)))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,v.ix,R.w,$.dQ,z.O5,x.j,f.U5,de.SK,f.Lr,pe.Xo,pe.p9,Xe.q6,z.ax,et.P,me.A2,me.my,T.KJ,T.$O,T.u9,T.u5,T.Jp,z.JJ,U.PV,U.Ls],encapsulation:2,changeDetection:0})}return o})();var ce=r(708),ue=r(1567),Ct=r(1993);let yt=(()=>{class o{constructor(){this.form=new d.cw({}),this.fields=[],this.options={formState:{disabled:!1}},this.icomFunctionControl=new e.vpe,this.cdr=(0,e.f3M)(e.sBO),this.fields=[{fieldGroupClassName:"flex items-center",key:"",wrappers:["group"],props:{label:"C\u1ea5u h\xecnh m\xe0n home c\u1ee7a app"},expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"home_icon",type:"upload",className:"",props:{label:"Icon t\u1ea1i m\xe0n trang ch\u1ee7 nhi\u1ec7m v\u1ee5",size:102400,labelType:"Image",width:400,height:400},expressions:{"props.disabled":"formState.disabled"}}]},{fieldGroupClassName:" items-center",key:"",wrappers:["group"],props:{label:"Trang ch\u1ee7 nhi\u1ec7m v\u1ee5"},expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"main_icon",type:"upload",className:"basis-6/12",props:{label:"Icon t\u1ea1i m\xe0n trang ch\u1ee7 nhi\u1ec7m v\u1ee5",size:102400,required:!0,labelType:"Image",width:400,height:400},expressions:{"props.disabled":"formState.disabled"}},{key:"header_img",type:"upload",className:"basis-6/12",props:{label:"Icon header",size:1048576,required:!0,labelType:"Image",width:1500,height:2e3},expressions:{"props.disabled":"formState.disabled"}},{key:"progress_bar_text",type:"input",props:{placeholder:"Nh\u1eadp n\u1ed9i dung header",label:"N\u1ed9i dung progress bar",type:"string",required:!0,maxLength:40},expressions:{"props.disabled":"formState.disabled"}},{fieldGroupClassName:"flex row",key:"",expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"main_color",type:"color-picker",className:"basis-2/12",templateOptions:{label:"Background color",required:!0},expressions:{"props.disabled":"formState.disabled"}},{key:"main_img_type",type:"select-custom",className:"basis-6/12 ml-4",props:{label:"Lo\u1ea1i \u1ea3nh",required:!0,placeholder:"Ch\u1ecdn lo\u1ea1i \u1ea3nh",viewValue:"name",labelProp:"name",valueProp:"id",options:[{id:"RED",name:"RED"},{id:"ORANGE",name:"ORANGE"}]},expressions:{"props.disabled":"formState.disabled"}}]}]}]}ngOnInit(){this.icomFunctionControl.emit({save:this.handleSave.bind(this)}),"view"===this.mode&&(this.options.formState.disabled=!0)}handleSave(){return this.form.valid?(this.form.markAsTouched(),this.form.submitted=!0,!0):(Object.keys(this.form.controls).forEach(t=>{this.form.controls[t].touched=!0}),!1)}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail-layout"]],inputs:{data:"data",mode:"mode"},outputs:{icomFunctionControl:"icomFunctionControl"},standalone:!0,features:[e.jDz],decls:4,vars:6,consts:[[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","bg-white","border","rounded-md"],["nz-form","",1,"bg-white","rounded-md","h-full","flex","flex-col","!p-4","overflow-y-auto",3,"formGroup","nzLayout"],[3,"model","fields","options","form"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e._UZ(3,"formly-form",3),e.qZA()()()),2&n&&(e.xp6(2),e.Q6J("formGroup",i.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",i.data)("fields",i.fields)("options",i.options)("form",i.form))},dependencies:[I.u,d.UX,d._Y,d.JL,d.sg,_.X0,_.T7,v.sL,x.j,f.U5,f.Lr],encapsulation:2,changeDetection:0})}return o})();function vt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-campaign-management-detail-general",14),e.NdJ("icomFunctionControl",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handlerFunctionControl(i))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("data",t.dataCampaign)("mode",t.mode)}}function xt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-campaign-management-detail-mission",15),e.NdJ("icomFunctionControl",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handlerFunctionControl(i))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("mode",t.mode)("data",null==t.dataCampaign?null:t.dataCampaign.config_mission)}}function zt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-campaign-management-detail-layout",15),e.NdJ("icomFunctionControl",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handlerFunctionControl(i))}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("mode",t.mode)("data",null==t.dataCampaign?null:t.dataCampaign.config_layout)}}function Tt(o,s){if(1&o&&(e.TgZ(0,"div",11),e.YNc(1,vt,1,2,"icom-libs-campaign-management-detail-general",12),e.YNc(2,xt,1,2,"icom-libs-campaign-management-detail-mission",13),e.YNc(3,zt,1,2,"icom-libs-campaign-management-detail-layout",13),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0===t.current),e.xp6(1),e.Q6J("ngIf",1===t.current),e.xp6(1),e.Q6J("ngIf",2===t.current)}}function Mt(o,s){1&o&&e._UZ(0,"nz-spin",16),2&o&&e.Q6J("nzSize","large")}function It(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handlerCancel(i))}),e.TgZ(1,"span"),e._uU(2,"H\u1ee7y"),e.qZA()()}}function wt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.pre())}),e.TgZ(1,"span"),e._uU(2,"Quay l\u1ea1i"),e.qZA()()}}function Et(o,s){1&o&&(e.ynx(0),e.YNc(1,wt,3,0,"button",9),e.BQk())}function St(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.next())}),e.TgZ(1,"span"),e._uU(2,"Ti\u1ebfp t\u1ee5c"),e.qZA()()}}function Ft(o,s){1&o&&(e.ynx(0),e.YNc(1,St,3,0,"button",18),e.BQk())}function kt(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handlerSaveDraft(i))}),e.TgZ(1,"span"),e._uU(2,"L\u01b0u nh\xe1p"),e.qZA()()}if(2&o){const t=e.oxw(2);e.Q6J("nzLoading",t.isLoading)}}function Dt(o,s){1&o&&(e.ynx(0),e.YNc(1,kt,3,1,"button",20),e.BQk())}function At(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.handlerSave(i))}),e.TgZ(1,"span"),e._uU(2,"L\u01b0u"),e.qZA()()}if(2&o){const t=e.oxw(2);e.Q6J("nzLoading",t.isLoading)}}function Nt(o,s){1&o&&(e.ynx(0),e.YNc(1,At,3,1,"button",22),e.BQk())}let Lt=(()=>{class o{constructor(){this.campaignService=(0,e.f3M)(w.wb),this.IComMessageService=(0,e.f3M)(c.Q),this.router=(0,e.f3M)(ue.F0),this.destroyRef=(0,e.f3M)(e.ktI),this.route=(0,e.f3M)(ue.gz),this.cdr=(0,e.f3M)(e.sBO),this.modalService=(0,e.f3M)(F.Sf),this.current=0,this.dataCampaign={config_mission:{},config_layout:{}},this.mode="view",this.isLoadingFirst=!0}ngOnInit(){this.route.queryParams.pipe((0,Ct.sL)(this.destroyRef)).subscribe(t=>{if(!t)return;const n=t.id;this.mode=t.mode,this.isLoadingFirst=!0,this.cdr.detectChanges(),this.campaignService.detail({id:+n}).subscribe(i=>{this.dataCampaign=i.data,this.dataCampaignOrigin=(0,K.cloneDeep)(this.dataCampaign),this.isLoadingFirst=!1,this.cdr.detectChanges()},i=>{this.isLoadingFirst=!1,this.cdr.detectChanges()})})}pre(){this.current-=1}next(){this.eventFunctionControl&&this.eventFunctionControl.save&&this.eventFunctionControl.save()&&(this.current+=1),"view"===this.mode&&(this.current+=1)}handlerIndexChange(t){if(this.current!==t){if("view"===this.mode&&(this.current===t+1||this.current===t-1))return void(this.current=t);"edit"===this.mode&&this.eventFunctionControl&&this.eventFunctionControl.save&&this.eventFunctionControl.save()&&(this.current+=1)}}handlerFunctionControl(t){this.eventFunctionControl=t}handlerSave(t){var n=this;return(0,E.Z)(function*(){t.stopPropagation(),t.preventDefault(),(!n.eventFunctionControl||!n.eventFunctionControl.save||n.eventFunctionControl.save())&&n.modalService.confirm({nzTitle:"B\u1ea1n c\xf3 mu\u1ed1n l\u01b0u chi\u1ebfn d\u1ecbch?",nzContent:`<b style="color: red;">${n.dataCampaign.name}</b>`,nzOkText:"L\u01b0u",nzOkType:"primary",nzMaskClosable:!1,nzClosable:!0,nzOnOk:n.processSubmit.bind(n),nzCancelText:"\u0110\xf3ng"},"info")})()}trimFormFields(){const t=this.dataCampaign;Object.keys(t).forEach(n=>{"string"==typeof t[n]&&(t[n]=t[n].trim())})}processSubmit(){var t=this;return(0,E.Z)(function*(){try{t.isLoading=!0,t.trimFormFields(),(!t.dataCampaign.status||"DRAFT"===t.dataCampaign.status)&&(t.dataCampaign.status="INACTIVE"),t.eventFunctionControl&&t.eventFunctionControl.save&&t.eventFunctionControl.save()&&(t.addSpecificGeneral(),yield(0,ce.n)(t.campaignService.addEditCampaign(t.dataCampaign)),t.IComMessageService.showAlertMessageDone(t.dataCampaign?.id?"S\u1eeda chi\u1ebfn d\u1ecbch th\xe0nh c\xf4ng.":"T\u1ea1o m\u1edbi chi\u1ebfn d\u1ecbch th\xe0nh c\xf4ng."),t.router.navigateByUrl("campaign/management"),t.dataCampaignOrigin=(0,K.cloneDeep)(t.dataCampaign))}catch(n){console.log(n),t.IComMessageService.showAlertMessageError(n?.error?.error_message||"S\u1eeda chi\u1ebfn d\u1ecbch th\u1ea5t b\u1ea1i")}finally{t.isLoading=!1,t.cdr.detectChanges()}})()}handlerSaveDraft(t){var n=this;return(0,E.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!n.dataCampaign.name)return void n.IComMessageService.showAlertMessageError("Vui l\xf2ng nh\u1eadp t\xean chi\u1ebfn d\u1ecbch");n.trimFormFields(),n.isLoading=!0,n.dataCampaign.status="DRAFT",n.addSpecificGeneral();const i=yield(0,ce.n)(n.campaignService.addEditCampaign(n.dataCampaign));i&&i.data&&(0,Q.PM)(i.data,n.dataCampaign),n.IComMessageService.showAlertMessageDone("L\u01b0u nh\xe1p chi\u1ebfn d\u1ecbch th\xe0nh c\xf4ng"),n.dataCampaignOrigin=(0,K.cloneDeep)(n.dataCampaign)}catch(i){console.log(i),n.IComMessageService.showAlertMessageError(i?.error?.error_message||"S\u1eeda chi\u1ebfn d\u1ecbch th\u1ea5t b\u1ea1i")}finally{n.isLoading=!1,n.cdr.detectChanges()}})()}handlerCancel(t){t?.stopPropagation(),t?.preventDefault(),"view"!==this.mode?this.modalService.confirm({nzTitle:this.dataCampaign?.id?"B\u1ea1n c\xf3 h\u1ee7y b\u1ecf thao t\xe1c ?":"B\u1ea1n c\xf3 mu\u1ed1n h\u1ee7y th\xeam m\u1edbi chi\u1ebfn d\u1ecbch kh\xf4ng?",nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzMaskClosable:!1,nzClosable:!0,nzOnOk:()=>this.router.navigateByUrl("campaign/management"),nzCancelText:"\u0110\xf3ng"},"info"):this.router.navigateByUrl("campaign/management")}addSpecificGeneral(){if([{id:"uuid2",group:"customer",type:"customer_profile",value:this.dataCampaign.start_time,attribute:"thoi_gian_dang_ky",operator:"after_specific_day"},{id:"uuid3",group:"customer",type:"customer_profile",value:this.dataCampaign.end_time,attribute:"thoi_gian_dang_ky",operator:"before_specific_day"}].forEach(n=>{const i=this.dataCampaign?.customer_group?.config?.find(a=>a.id===n.id);i?Object.assign(i,n):this.dataCampaign?.customer_group?.config?.push(n)}),this.dataCampaign.customer_group&&(this.dataCampaign.customer_group.relationship=""),this.dataCampaign?.customer_group?.config&&this.dataCampaign?.customer_group?.config?.length){const n=this.dataCampaign?.customer_group?.config;n.forEach(i=>{i.id=i.id||G()}),n?.forEach((i,a)=>{this.dataCampaign.customer_group.relationship+=` ${i.id} ${a!==n.length-1?"&&":""}`})}this.dataCampaign?.config_mission?.missions&&this.dataCampaign?.config_mission?.missions?.length&&(this.dataCampaign?.config_mission?.missions).forEach((i,a)=>{i.id=a+1})}static#e=this.\u0275fac=function(n){return new(n||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-campaign-management-detail"]],standalone:!0,features:[e.jDz],decls:18,vars:8,consts:[["nzBackIcon","",1,"h-full","w-full","flex","flex-col","p-0","!absolute","top-0","left-0","!bg-[#f0f2f5]",3,"nzBack"],[1,"w-full","h-full","flex","overflow-hidden"],["nzProgressDot","","nzDirection","vertical",1,"border-r","border-y-zinc-400","!p-4","bg-white","rounded-lg",2,"flex-basis","content",3,"nzCurrent","nzIndexChange"],["nzTitle","1. Th\xf4ng tin chung","nzDescription","C\u1ea5u h\xecnh c\xe1c th\xf4ng tin chung c\u1ee7a chi\u1ebfn d\u1ecbch"],["nzTitle","2. C\u1ea5u h\xecnh nhi\u1ec7m v\u1ee5"],["nzTitle","3. C\u1ea5u h\xecnh App"],["class","steps-content pl-4 w-full 0",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"flex","justify-end","mb-4"],["nz-button","","nzType","default",3,"click",4,"nzSpaceItem"],[4,"ngIf"],[1,"steps-content","pl-4","w-full","0"],[3,"data","mode","icomFunctionControl",4,"ngIf"],[3,"mode","data","icomFunctionControl",4,"ngIf"],[3,"data","mode","icomFunctionControl"],[3,"mode","data","icomFunctionControl"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default",3,"nzLoading","click",4,"nzSpaceItem"],["nz-button","","nzType","default",3,"nzLoading","click"],["nz-button","","nzType","primary",3,"nzLoading","click",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"nzLoading","click"]],template:function(n,i){1&n&&(e.TgZ(0,"nz-page-header",0),e.NdJ("nzBack",function(){return i.handlerCancel()}),e.TgZ(1,"nz-page-header-title"),e._uU(2),e.qZA(),e.TgZ(3,"nz-page-header-content",1)(4,"nz-steps",2),e.NdJ("nzIndexChange",function(l){return i.handlerIndexChange(l)}),e._UZ(5,"nz-step",3)(6,"nz-step",4)(7,"nz-step",5),e.qZA(),e.YNc(8,Tt,4,3,"div",6),e.YNc(9,Mt,1,1,"nz-spin",7),e.qZA(),e.TgZ(10,"nz-page-header-footer",8)(11,"nz-space"),e.ynx(12),e.YNc(13,It,3,0,"button",9),e.BQk(),e.YNc(14,Et,2,0,"ng-container",10),e.YNc(15,Ft,2,0,"ng-container",10),e.YNc(16,Dt,2,0,"ng-container",10),e.YNc(17,Nt,2,0,"ng-container",10),e.qZA()()()),2&n&&(e.xp6(2),e.Oqu((null==i.dataCampaignOrigin?null:i.dataCampaignOrigin.name)||"T\u1ea1o m\u1edbi"),e.xp6(2),e.Q6J("nzCurrent",i.current),e.xp6(4),e.Q6J("ngIf",!i.isLoadingFirst),e.xp6(1),e.Q6J("ngIf",i.isLoadingFirst),e.xp6(5),e.Q6J("ngIf",i.current>0),e.xp6(1),e.Q6J("ngIf",i.current<2),e.xp6(1),e.Q6J("ngIf","edit"===i.mode),e.xp6(1),e.Q6J("ngIf",2===i.current&&"edit"===i.mode))},dependencies:[z.ez,z.O5,W.ZJ,T.KJ,T.$O,T.u9,T.u5,T.$,S.zf,S.NU,S.$1,X.we,U.PV,ee.vh,M.N6,M.iy,M.$W,v.sL,v.ix,R.w,$.dQ,te,_t,yt,x.j,x.W],encapsulation:2,changeDetection:0})}return o})()},2669:(he,Y,r)=>{r.d(Y,{W:()=>j,j:()=>ne});var E=r(7582),e=r(5879),z=r(8645),U=r(5619),T=r(7328),S=r(4825),X=r(7921),W=r(3997),ee=r(4664),M=r(9360),v=r(2420),d=r(8251),_=r(4829),x=r(9773),Z=r(874),p=r(7754),q=r(9388),P=r(6814),f=r(7131);function w(m,k){1&m&&(e.TgZ(0,"span",3),e._UZ(1,"i",4)(2,"i",4)(3,"i",4)(4,"i",4),e.qZA())}function te(m,k){}function F(m,k){if(1&m&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&m){const u=e.oxw(2);e.xp6(1),e.Oqu(u.nzTip)}}function Q(m,k){if(1&m&&(e.TgZ(0,"div")(1,"div",5),e.YNc(2,te,0,0,"ng-template",6),e.YNc(3,F,2,1,"div",7),e.qZA()()),2&m){const u=e.oxw(),c=e.MAs(1);e.xp6(1),e.ekj("ant-spin-rtl","rtl"===u.dir)("ant-spin-spinning",u.isLoading)("ant-spin-lg","large"===u.nzSize)("ant-spin-sm","small"===u.nzSize)("ant-spin-show-text",u.nzTip),e.xp6(1),e.Q6J("ngTemplateOutlet",u.nzIndicator||c),e.xp6(1),e.Q6J("ngIf",u.nzTip)}}function B(m,k){if(1&m&&(e.TgZ(0,"div",9),e.Hsn(1),e.qZA()),2&m){const u=e.oxw();e.ekj("ant-spin-blur",u.isLoading)}}const J=["*"],N="spin";let j=(()=>{class m{constructor(u,c,C){this.nzConfigService=u,this.cdr=c,this.directionality=C,this._nzModuleName=N,this.nzIndicator=null,this.nzSize="default",this.nzTip=null,this.nzDelay=0,this.nzSimple=!1,this.nzSpinning=!0,this.destroy$=new z.x,this.spinning$=new U.X(this.nzSpinning),this.delay$=new T.t(1),this.isLoading=!1,this.dir="ltr"}ngOnInit(){this.delay$.pipe((0,X.O)(this.nzDelay),(0,W.x)(),(0,ee.w)(c=>0===c?this.spinning$:this.spinning$.pipe(function I(m){return(0,M.e)((k,u)=>{let c=!1,C=null,y=null;const O=()=>{if(y?.unsubscribe(),y=null,c){c=!1;const V=C;C=null,u.next(V)}};k.subscribe((0,d.x)(u,V=>{y?.unsubscribe(),c=!0,C=V,y=(0,d.x)(u,O,v.Z),(0,_.Xf)(m(V)).subscribe(y)},()=>{O(),u.complete()},void 0,()=>{C=y=null}))})}(C=>(0,S.H)(C?c:0)))),(0,x.R)(this.destroy$)).subscribe(c=>{this.isLoading=c,this.cdr.markForCheck()}),this.nzConfigService.getConfigChangeEventForComponent(N).pipe((0,x.R)(this.destroy$)).subscribe(()=>this.cdr.markForCheck()),this.directionality.change?.pipe((0,x.R)(this.destroy$)).subscribe(c=>{this.dir=c,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnChanges(u){const{nzSpinning:c,nzDelay:C}=u;c&&this.spinning$.next(this.nzSpinning),C&&this.delay$.next(this.nzDelay)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static#e=this.\u0275fac=function(c){return new(c||m)(e.Y36(Z.jY),e.Y36(e.sBO),e.Y36(q.Is,8))};static#t=this.\u0275cmp=e.Xpm({type:m,selectors:[["nz-spin"]],hostVars:2,hostBindings:function(c,C){2&c&&e.ekj("ant-spin-nested-loading",!C.nzSimple)},inputs:{nzIndicator:"nzIndicator",nzSize:"nzSize",nzTip:"nzTip",nzDelay:"nzDelay",nzSimple:"nzSimple",nzSpinning:"nzSpinning"},exportAs:["nzSpin"],features:[e.TTD],ngContentSelectors:J,decls:4,vars:2,consts:[["defaultTemplate",""],[4,"ngIf"],["class","ant-spin-container",3,"ant-spin-blur",4,"ngIf"],[1,"ant-spin-dot","ant-spin-dot-spin"],[1,"ant-spin-dot-item"],[1,"ant-spin"],[3,"ngTemplateOutlet"],["class","ant-spin-text",4,"ngIf"],[1,"ant-spin-text"],[1,"ant-spin-container"]],template:function(c,C){1&c&&(e.F$t(),e.YNc(0,w,5,0,"ng-template",null,0,e.W1O),e.YNc(2,Q,4,12,"div",1),e.YNc(3,B,2,2,"div",2)),2&c&&(e.xp6(2),e.Q6J("ngIf",C.isLoading),e.xp6(1),e.Q6J("ngIf",!C.nzSimple))},dependencies:[P.O5,P.tP],encapsulation:2})}return(0,E.gn)([(0,Z.oS)()],m.prototype,"nzIndicator",void 0),(0,E.gn)([(0,p.Rn)()],m.prototype,"nzDelay",void 0),(0,E.gn)([(0,p.yF)()],m.prototype,"nzSimple",void 0),(0,E.gn)([(0,p.yF)()],m.prototype,"nzSpinning",void 0),m})(),ne=(()=>{class m{static#e=this.\u0275fac=function(c){return new(c||m)};static#t=this.\u0275mod=e.oAB({type:m});static#n=this.\u0275inj=e.cJS({imports:[q.vT,P.ez,f.Q8]})}return m})()}}]);