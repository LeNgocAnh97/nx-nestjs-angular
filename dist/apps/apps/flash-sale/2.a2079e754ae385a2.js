"use strict";(self.webpackChunkapps_flash_sale=self.webpackChunkapps_flash_sale||[]).push([[2],{2:(Ge,M,l)=>{l.r(M),l.d(M,{IcomLibsFlashSaleDetailComponent:()=>Ne});var g=l(5861),f=l(6814),e=l(5879),D=l(2595),y=l(6254),x=l(2574),T=l(9382),N=l(8083),w=l(2669),d=l(9663),C=l(95),q=l(5545),k=l(3304),S=l(4905),J=l(1993),G=l(6990),Y=l(5619),c=l(708),h=l(7398),Q=l(8180),j=l(5592),O=l(7921),U=l(3997),R=l(4664),A=l(1567),E=l(9717),K=l(9466),b=l(1659),W=l(1221),z=l(2840),$=l(2962),X=l(8125),V=l(3599),ee=l(9704),I=l(8213),te=l(8504),F=l(855),P=l(1958);function ne(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(n){e.CHM(t);const i=e.oxw(4);return e.KtG(i.handlerCancel(n))}),e.TgZ(1,"span"),e._uU(2,"H\u1ee7y"),e.qZA()()}}function ae(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(n){e.CHM(t);const i=e.oxw(4);return e.KtG(i.handlerSave(n))}),e.TgZ(1,"span"),e._uU(2,"L\u01b0u"),e.qZA()()}if(2&o){const t=e.oxw(4);e.Q6J("nzLoading",t.isLoading)}}function oe(o,u){1&o&&(e.TgZ(0,"nz-space"),e.ynx(1),e.YNc(2,ne,3,0,"button",11),e.BQk(),e.ynx(3),e.YNc(4,ae,3,1,"button",12),e.BQk(),e.qZA())}function ie(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"nz-page-header",4),e.NdJ("nzBack",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.handlerCancel())}),e.TgZ(1,"nz-page-header-title"),e._uU(2),e.qZA(),e.TgZ(3,"nz-page-header-content",5)(4,"form",6)(5,"div",7)(6,"div",8),e._UZ(7,"formly-form",9),e.qZA()()()(),e.TgZ(8,"nz-page-header-footer",10),e.YNc(9,oe,5,0,"nz-space",0),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Oqu((null==t.data?null:t.data.name)||"T\u1ea1o m\u1edbi"),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("model",t.model)("fields",t.fields)("form",t.form)("options",t.options),e.xp6(2),e.Q6J("ngIf","view"!==t.mode)}}function se(o,u){if(1&o&&(e.ynx(0),e.YNc(1,ie,10,7,"nz-page-header",3),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.data)}}function le(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(n){e.CHM(t);const i=e.oxw(4);return e.KtG(i.handlerActivate(n))}),e.TgZ(1,"span"),e._uU(2,"K\xedch ho\u1ea1t"),e.qZA()()}}function re(o,u){1&o&&(e.ynx(0),e.YNc(1,le,3,0,"button",11),e.BQk())}function ue(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(n){e.CHM(t);const i=e.oxw(4);return e.KtG(i.handlerDeactivate(n))}),e.TgZ(1,"span"),e._uU(2,"Ng\u1eebng K\xedch ho\u1ea1t"),e.qZA()()}}function de(o,u){1&o&&(e.ynx(0),e.YNc(1,ue,3,0,"button",11),e.BQk())}function pe(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(n){e.CHM(t);const i=e.oxw(4);return e.KtG(i.handlerEdit(n))}),e.TgZ(1,"span"),e._uU(2,"S\u1eeda"),e.qZA()()}}function ce(o,u){1&o&&(e.ynx(0),e.YNc(1,pe,3,0,"button",11),e.BQk())}function me(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(n){e.CHM(t);const i=e.oxw(3);return e.KtG(i.handlerRemove(n))}),e.TgZ(1,"span"),e._uU(2,"X\xf3a"),e.qZA()()}if(2&o){const t=e.oxw(3);e.Q6J("nzLoading",t.isLoading)("nzDanger",!0)}}function he(o,u){if(1&o&&(e.TgZ(0,"nz-space",18),e.YNc(1,re,2,0,"ng-container",0),e.YNc(2,de,2,0,"ng-container",0),e.YNc(3,ce,2,0,"ng-container",0),e.ynx(4),e.YNc(5,me,3,2,"button",19),e.BQk(),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","ACTIVE"!==(null==t.model?null:t.model.status)),e.xp6(1),e.Q6J("ngIf","ACTIVE"===(null==t.model?null:t.model.status)),e.xp6(1),e.Q6J("ngIf",!(null!=t.model&&t.model.is_transaction_exists))}}function ge(o,u){if(1&o&&(e.TgZ(0,"div",15)(1,"form",16)(2,"div",5)(3,"div",8),e._UZ(4,"formly-form",9),e.qZA()()(),e.YNc(5,he,6,3,"nz-space",17),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form)("nzLayout","vertical"),e.xp6(3),e.Q6J("model",t.model)("fields",t.fields)("form",t.form)("options",t.options),e.xp6(1),e.Q6J("ngIf",t.mode&&"view"===t.mode)}}function fe(o,u){1&o&&e._UZ(0,"nz-spin",21),2&o&&e.Q6J("nzSize","large")}let _e=(()=>{class o{constructor(){var t=this;this.form=new C.cw({}),this.options={formState:{disabled:!1}},this.iComLibsServicesProjectDynamicHomeService=(0,e.f3M)(b.KL),this.iComLibsServicesProjectFlashSaleService=(0,e.f3M)(b.Rm),this.campaignService=(0,e.f3M)(b.wb),this.productService=(0,e.f3M)(b.k),this.isLoadingDetails=!0,this.allGroups=[],this.fields=[],this.groupsSelectionChanged=new Y.X([]),this.listInventory=[],this.route=(0,e.f3M)(A.gz),this.cdr=(0,e.f3M)(e.sBO),this.modalService=(0,e.f3M)(W.Sf),this.router=(0,e.f3M)(A.F0),this.viewContainerRef=(0,e.f3M)(e.s_b),this.IComMessageService=(0,e.f3M)(E.Q),this.icomLibsDynamicComponentService=(0,e.f3M)(K.G),this.destroyRef=(0,e.f3M)(e.ktI),this.iComLibsServicesInventoryService=(0,e.f3M)(b.NH),this.icomDetailFlashSale=new e.vpe,this.mode="view",this.route.queryParams.pipe((0,J.sL)(this.destroyRef)).subscribe(function(){var a=(0,g.Z)(function*(n){try{if(n){const i=yield(0,c.n)(t.iComLibsServicesProjectFlashSaleService.listGroup({page:1,size:99999}));if(t.allGroups=i?.data?.items||[],!n.id)return t.mode="add",t.data={type_end_time:"SPECTIME",type_start_time:"SPECTIME",campaign_type:"FLASHSALE",customer_group:{config:[{operator:"in",type:"time_now",value:[],attribute:"month",group:"time",id:"uuid1"},{operator:"in",type:"time_now",value:[],attribute:"day",group:"time",id:"uuid2"},{operator:"in",type:"time_now",value:[],attribute:"day_of_week",group:"time",id:"uuid3"},{operator:"in",type:"time_now",value:[],attribute:"hour",group:"time",id:"uuid4"},{operator:"in",type:"customer_profile",value:[],attribute:"membership_level",group:"customer",id:"uuid5"},{operator:"in",type:"customer_profile",value:[],attribute:"address_city",group:"customer",id:"uuid6"}],relationship:"uuid1 && uuid2  && uuid3 && uuid4 && uuid5 && uuid6"},flash_sale_config:{products:[],inventory_id:"",reward:{name:"+10",reward_level:"1",type:"all",items:[{type:"point_percent",value:null}]}}},t.model=(0,G.cloneDeep)(t.data),t.setFields(),t.updateSelectedGroups(),t.updateFieldReadonlyStatus(),t.options={formState:{disabled:!1,required:!1,mainModel:t.model}},t.isLoadingDetails=!1,void t.cdr?.detectChanges();try{const s=n?.id||"",r=yield(0,c.n)(t.iComLibsServicesProjectFlashSaleService.detail(+s));t.data=r?.data||{},t.icomDetailFlashSale.emit(t.data);const p=yield t.getListVoucherSelected();p&&(t.data.flash_sale_config.products=p),t.model=(0,G.cloneDeep)(t.data),t.setFields(),t.updateFieldReadonlyStatus(),t.updateSelectedGroups(),t.options={formState:{disabled:!1,required:!1,mainModel:t.model}}}catch(s){console.log(s)}finally{t.isLoadingDetails=!1,t.cdr?.detectChanges()}}}catch{t.isLoadingDetails=!1,t.cdr.detectChanges()}});return function(n){return a.apply(this,arguments)}}())}updateSelectedGroups(){const t=this.model?.groups;if(!t||!t.length)return;const a=t?.map(n=>this.allGroups.find(i=>i._id===n)||{id:n,name:"Kh\xf4ng x\xe1c \u0111\u1ecbnh"});this.groupsSelectionChanged.next(a)}setFields(){var t=this;this.fields=[{fieldGroupClassName:"flex flex-col",className:"basis-1/2",key:"",wrappers:["group"],props:{label:"Th\xf4ng tin chung"},expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"code",className:"basis-4/12",type:"input-custom",props:{label:"M\xe3",maxLength:8,placeholder:"Nh\u1eadp m\xe3",readonly:!0},validation:[{name:"noWhitespace",options:{errorPath:"value"}}]},{key:"name",className:"basis-4/12",type:"input-custom",props:{label:"T\xean",required:!0,maxLength:50,placeholder:"Nh\u1eadp t\xean",readonly:!0},validators:{validation:[{name:"noWhitespace",options:{errorPath:"value"}}]}},{key:"groups",type:"select-custom",defaultValue:[],props:{label:"Nh\xf3m Flash Sale",multiple:!0,viewValue:"name",maxMultiSelectItems:12,readonly:!0,labelProp:"name",valueProp:"_id",options:this.iComLibsServicesProjectFlashSaleService.listGroup({page:1,size:99999}).pipe((0,h.U)(n=>n?.data?.items?.map((i,s)=>({...i}))||[])),functionAddNew:(n,i)=>{const s=this.modalService.create({nzTitle:"Th\xeam nh\xf3m flash sale",nzContent:te.E,nzViewContainerRef:this.viewContainerRef,nzCancelText:"H\u1ee7y",nzOkText:"L\u01b0u",nzOkType:"primary",nzOnOk:()=>new Promise(r=>{const p=s.getContentComponent();p.onSave.pipe((0,Q.q)(1)).subscribe(function(){var _=(0,g.Z)(function*(m){if(m){t.IComMessageService.showAlertMessageDone("T\u1ea1o nh\xf3m flash sale th\xe0nh c\xf4ng."),r(!0);const v=n.formControl.getRawValue();n.formControl.setValue([...v,m?.data?._id]);const L=yield(0,c.n)(t.iComLibsServicesProjectFlashSaleService.listGroup({page:1,size:99999}));t.allGroups=L?.data?.items||[];const qe=(n?.formControl?.value).map(H=>({id:H,name:t.findGroupById(H).name}));t.groupsSelectionChanged.next(qe),i&&i(),s.updateConfig({nzOkLoading:!1})}});return function(m){return _.apply(this,arguments)}}()),p.handlerSave()}),nzOkLoading:!1})},placeholder:"Ch\u1ecdn nh\xf3m Flash Sale",change:n=>{const s=(n?.formControl?.value).map(r=>({id:r,name:this.findGroupById(r).name}));this.groupsSelectionChanged.next(s)}}},{key:"start_time",type:"date",props:{label:"T\u1eeb",ShowTime:!0,required:!0,datepickerOptions:{nzFormat:"dd/MM/yyyy HH:mm"},readonly:!0,emitTimeLocal:!0,format:"dd-MM-yyyy HH:mm",placeholder:"DD-MM-YYYY hh:mm",change:(n,i)=>{n?.parent?.fieldGroup?.find(r=>"end_time"===r.key)&&this.form.get("end_time")?.updateValueAndValidity()}},validators:{validation:[this.startTimeValidator]}},{key:"end_time",type:"date",props:{label:"\u0110\u1ebfn",required:!0,ShowTime:!0,format:"dd-MM-yyyy HH:mm",placeholder:"DD-MM-YYYY hh:mm",datepickerOptions:{nzFormat:"dd/MM/yyyy HH:mm"},readonly:!0,emitTimeLocal:!0,change:(n,i)=>{n?.parent?.fieldGroup?.find(r=>"start_time"===r.key)&&this.form.get("start_time")?.updateValueAndValidity()}},validators:{validation:[this.startTimeValidator]}},{key:"customer_group.config[0].value",type:"select-custom",defaultValue:[],props:{label:"Theo th\xe1ng",multiple:!0,viewValue:"value",readonly:!0,labelProp:"value",valueProp:"id",options:(0,S.JC)(),placeholder:"Ch\u1ecdn th\xe1ng"}},{key:"customer_group.config[1].value",type:"select-custom",defaultValue:[],props:{label:"Theo ng\xe0y",multiple:!0,viewValue:"value",readonly:!0,labelProp:"value",valueProp:"id",options:(0,S.Jj)(),placeholder:"Ch\u1ecdn ng\xe0y"}},{key:"customer_group.config[2].value",type:"select-custom",defaultValue:[],props:{label:"Theo th\u1ee9",multiple:!0,readonly:!0,viewValue:"value",labelProp:"value",valueProp:"id",options:(0,S.l0)(),placeholder:"Ch\u1ecdn th\u1ee9"}},{key:"customer_group.config[3].value",type:"select-custom",defaultValue:[],props:{label:"Theo gi\u1edd",multiple:!0,readonly:!0,viewValue:"value",labelProp:"value",valueProp:"id",options:(0,S.uv)(),placeholder:"Ch\u1ecdn gi\u1edd"}}]},{fieldGroupClassName:"flex flex-col mt-2",className:"basis-1/2 pl-4 mt-2",key:"",wrappers:["group"],expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"customer_group.config[4].value",type:"select-custom",defaultValue:[],props:{label:"H\u1ea1ng h\u1ed9i vi\xean",viewValue:"value",labelProp:"value",readonly:!0,valueProp:"id",multiple:!0,options:this.iComLibsServicesProjectDynamicHomeService.listMembersShip().pipe((0,h.U)(n=>n?.data))}},{key:"customer_group.config[5].value",type:"select-custom",defaultValue:[],props:{label:"T\u1ec9nh/ th\xe0nh ph\u1ed1",viewValue:"value",labelProp:"value",valueProp:"id",multiple:!0,readonly:!0,options:this.iComLibsServicesProjectDynamicHomeService.listCity().pipe((0,h.U)(n=>n?.data))}},{key:"status",type:"radio-custom",defaultValue:"ACTIVE",props:{label:"Tr\u1ea1ng th\xe1i",readonly:!0,viewValue:"name",labelProp:"name",valueProp:"id",options:[{name:"K\xedch ho\u1ea1t",id:"ACTIVE"},{name:"Ng\u1eebng k\xedch ho\u1ea1t",id:"INACTIVE"}]}},{key:"config_layout.no_product",className:"basis-4/12",type:"nz-input-number",defaultValue:5,props:{label:"Hi\u1ec3n th\u1ecb tr\xean trang ch\u1ee7",required:!0,max:9999999999,min:3,readonly:!0,type:"number"},validators:{validation:[{name:"noWhitespace",options:{errorPath:"value"}}]}},{key:"config_layout.header_img",type:"upload",className:"basis-6/12 ",props:{label:"\u1ea2nh banner",size:1048576,className:"w-[150px] ",readonly:!0,disabled:!0,labelType:"Image",width:375,height:100},expressions:{"props.disabled":"formState.disabled"}},{key:"note",type:"textarea-custom",props:{label:"Ghi ch\xfa",rows:5,readonly:!0,maxLength:500}},{key:"creator_info.full_name",type:"input-custom",props:{label:"Ng\u01b0\u1eddi t\u1ea1o",readonly:!0,disabled:!0},expressions:{"props.disabled":"formState.disabled"},hideExpression:(n,i,s)=>"view"!==this.mode},{key:"created_at",type:"date",props:{label:"Th\u1eddi gian t\u1ea1o",ShowTime:!0,required:!1,datepickerOptions:{nzFormat:"dd/MM/yyyy HH:mm"},readonly:!0,format:"dd-MM-yyyy HH:mm",placeholder:"DD-MM-YYYY hh:mm"},hideExpression:(n,i,s)=>"view"!==this.mode},{key:"updater_info.full_name",type:"input-custom",props:{label:"Ng\u01b0\u1eddi s\u1eeda",readonly:!0,disabled:!0},expressions:{"props.disabled":"formState.disabled"},hideExpression:(n,i,s)=>"view"!==this.mode},{key:"updated_at",type:"date",props:{label:"Th\u1eddi gian s\u1eeda",ShowTime:!0,required:!1,datepickerOptions:{nzFormat:"dd/MM/yyyy HH:mm"},readonly:!0,format:"dd-MM-yyyy HH:mm",placeholder:"DD-MM-YYYY hh:mm"},hideExpression:(n,i,s)=>"view"!==this.mode}]},{fieldGroupClassName:"flex flex-col mt-4",className:"basis-4/6  mt-4 test2",key:"flash_sale_config",wrappers:["group"],props:{label:"",readonly:!0,disabled:!0},expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"",wrappers:["collapse"],props:{readonly:!0,disabled:!0,label:"T\xedch \u0111i\u1ec3m khi mua s\u1ea3n ph\u1ea9m",changeChecked:(n,i)=>{i.fieldGroup.find(r=>"reward.is_active"===r.key).model.reward.is_active=n},setChecked:n=>n?.fieldGroup?.find(s=>"reward.is_active"===s.key)?.model.reward?.is_active},fieldGroupClassName:"flex flex-col",fieldGroup:[{key:"reward.items[0].value",type:"nz-input-number",props:{label:"T\u1ef7 l\u1ec7 quy \u0111\u1ed5i \u0111i\u1ec3m th\u01b0\u1edfng",addonText:"VND = 1 \u0111i\u1ec3m th\u01b0\u1edfng",type:"number",placeholder:"Nh\u1eadp s\u1ed1",min:1,max:9999999999,readonly:!0,disabled:!0,required:!0},expressions:{"props.disabled":"formState.disabled","props.required":"model?.reward?.is_active"}},{key:"reward.is_active",defaultValue:!1,type:"checkbox",className:"hidden"},{key:"reward.is_accept_add_point_payment_by_point",type:"multi-checkbox",defaultValue:!1,props:{disabled2:"view"===this.mode,value2:this.model?.flash_sale_config?.reward?.is_accept_add_point_payment_by_point,options:[{label:"Kh\xf4ng t\xedch \u0111i\u1ec3m cho c\xe1c giao d\u1ecbch thanh to\xe1n b\u1eb1ng \u0111i\u1ec3m th\u01b0\u1edfng",value:"Kh\xf4ng t\xedch \u0111i\u1ec3m cho c\xe1c giao d\u1ecbch thanh to\xe1n b\u1eb1ng \u0111i\u1ec3m th\u01b0\u1edfng"}],change:(n,i)=>{setTimeout(()=>{this.model?.flash_sale_config?.reward?.is_accept_add_point_payment_by_point&&(this.model.flash_sale_config.reward.is_accept_add_point_payment_by_point=i||!1)},200)}},expressions:{"props.required":"model?.reward?.is_active"}},{key:"sponsor",props:{readonly:!0,disabled:!0,label:"Nh\xe0 t\xe0i tr\u1ee3",addText:"Th\xeam nh\xe0 t\xe0i tr\u1ee3",required:!1},expressions:{"props.disabled":"formState.disabled","props.required":()=>this.model?.flash_sale_config?.reward?.is_active},type:"array",fieldArray:{wrappers:["group"],fieldGroupClassName:"flex row items-center",fieldGroup:[{key:"id",type:"select-custom",className:"basis-6/12",props:{label:"Nh\xe0 t\xe0i tr\u1ee3",placeholder:"Ch\u1ecdn nh\xe0 t\xe0i tr\u1ee3",viewValue:"title",labelProp:"title",valueProp:"id",readonly:!0,required:!0,options:this.campaignService.getContributor().pipe((0,h.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled","props.required":()=>this.model?.flash_sale_config?.reward?.is_active}},{key:"value",type:"nz-input-number",className:"basis-6/12 pl-2",props:{placeholder:"Nh\u1eadp t\u1ef7 l\u1ec7 t\xe0i tr\u1ee3",label:"T\u1ef7 l\u1ec7 t\xe0i tr\u1ee3",type:"number",readonly:!0,disabled:!0,min:0,required:!0,max:100},expressions:{"props.disabled":"formState.disabled","props.required":()=>this.model?.flash_sale_config?.reward?.is_active}},{key:"balance",type:"nz-input-number",className:"basis-3/12 flex-none",props:{label:"T\xe0i kho\u1ea3n k\xfd qu\u1ef9",disabled:!0,required:!0,readonly:!0,ignoreChange:!0},expressions:{"props.disabled":"formState.disabled","props.required":()=>this.model?.flash_sale_config?.reward?.is_active},hooks:{onInit:n=>{(n?.formControl?.parent?.get("id")).valueChanges.subscribe(r=>{const _=n?.parent?.fieldGroup?.find(v=>"id"===v.key)?.props?.options;let m;_ instanceof j.y?_.subscribe(v=>{m=v.find(L=>L.id===r),n?.formControl?.setValue(m?.balance||0)}):Array.isArray(_)&&(m=_.find(v=>v.value===r),n?.formControl?.setValue(m?.balance||0))})}}}]}},{key:"pool",type:"select-custom",props:{label:"Lo\u1ea1i \u0111i\u1ec3m th\u01b0\u1edfng C\u1ea5p 1",type:"text",placeholder:"C\u1ea5p 1 (Pool)",readonly:!0,viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:this.campaignService.getPool().pipe((0,h.U)(n=>n.data))},expressions:{"props.disabled":"formState.disabled","props.required":"model?.reward?.is_active"}},{key:"sub_pool",type:"select-custom",props:{label:"Lo\u1ea1i \u0111i\u1ec3m th\u01b0\u1edfng C\u1ea5p 2",type:"text",placeholder:"C\u1ea5p 2 (Pool)",viewValue:"title",labelProp:"title",readonly:!0,valueProp:"id",required:!0,options:[]},expressions:{"props.disabled":"formState.disabled","props.required":"model?.reward?.is_active"},hooks:{onInit:n=>{const i=n?.parent?.fieldGroup?.[4].formControl;i&&n.props&&(n.props.options=i.valueChanges.pipe((0,O.O)(i.value),(0,U.x)(),(0,R.w)(s=>s?this.campaignService.getSubPool({pool_id:s}).pipe((0,h.U)(r=>(r?.data?.find(p=>n?.model?.sub_pool===p.id)||n.formControl?.setValue(null),r.data))):[]))).subscribe()}}}]}]},{fieldGroupClassName:"flex flex-col mt-4",className:"basis-2/6 pl-4  mt-4  test2",key:"flash_sale_config",wrappers:["group"],props:{label:"",readonly:!0,disabled:!0},expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"limit_product",wrappers:["collapse"],props:{label:"Gi\u1edbi h\u1ea1n s\u1ed1 l\u01b0\u1ee3ng mua c\u1ee7a m\u1ed9t kh\xe1ch h\xe0ng cho m\u1ed7i s\u1ea3n ph\u1ea9m",changeChecked:(n,i)=>{i.fieldGroup.find(r=>"is_active"===r.key).model.is_active=n},setChecked:n=>n?.fieldGroup?.find(s=>"is_active"===s.key)?.model?.is_active},fieldGroupClassName:"flex flex-col",fieldGroup:[{key:"is_active",defaultValue:!1,type:"checkbox",className:"hidden"},{key:"value",type:"input-custom",props:{label:"S\u1ed1 l\u01b0\u1ee3ng gi\u1edbi h\u1ea1n",type:"number",placeholder:"Nh\u1eadp s\u1ed1",readonly:!0,disabled:!0,required:!0,max:9999999999},expressions:{"props.disabled":"formState.disabled","props.required":"model?.is_active"}}]}]},{key:"flash_sale_config",fieldGroupClassName:"flex flex-col",className:"w-full mt-4 test2",hideExpression:()=>"view"===this.mode,wrappers:["group"],fieldGroup:[{key:"inventory_id",type:"select-custom",defaultValue:[],props:{label:"Kho s\u1ea3n ph\u1ea9m",required:!0,readonly:!0,viewValue:"name",labelProp:"name",valueProp:"id",emitList:(n,i)=>{this.listInventory=n,this.listInventory?.some(r=>r.id===this.model?.flash_sale_config?.inventory_id)||i.formControl?.setValue(i.defaultValue)},options:[],placeholder:"Ch\u1ecdn kho s\u1ea3n ph\u1ea9m"},hooks:{onInit:n=>{"add"===this.mode||"edit"===this.mode?n.props&&(n.props.options=this.iComLibsServicesInventoryService.listInventoryFlashSale({page:1,limit:999999}).pipe((0,h.U)(i=>i?.data?.items?.filter(s=>"INVENTORY_TYPE_FLASHSALE"===s.type)||[]))):"view"===this.mode&&n.props&&(n.props.options=this.iComLibsServicesInventoryService.listInventory({page:1,limit:999999}).pipe((0,h.U)(i=>i?.data?.items?.filter(s=>"INVENTORY_TYPE_FLASHSALE"===s.type)||[])))}}},{key:"products",type:"dropdown-table",className:"w-full",hideExpression:()=>"view"===this.mode,wrappers:["group"],hooks:{onInit:n=>{const i=this.form.get("flash_sale_config.inventory_id");i&&i.valueChanges.pipe((0,O.O)(i.value),(0,U.x)()).subscribe(s=>{const r={start_time:this.model?.start_time,end_time:this.model?.end_time};n.props&&(n.props.objectUpload={id:this.data._id||"",inventory_id:this.model?.flash_sale_config?.inventory_id,...r,groups:this.model?.groups||[]}),n.props&&(n.props.listOptionDropdown=(p,_)=>{const m={...r,..._};return this.iComLibsServicesInventoryService.getListProductFlashSaleOfInventory(s,{page:p||1,limit:15,...m}).pipe((0,h.U)(v=>v?.data))}),n={...n}})}},props:{label:"S\u1ea3n ph\u1ea9m",import:!0,nzOptionHeightPx:72,customOption:!0,id:this.data._id||"",objectUpload:{id:this.data._id||"",inventory_id:this.model?.flash_sale_config?.inventory_id,start_time:this.model?.start_time,end_time:this.model?.end_time,groups:this.model?.groups||[]},placeholder:"Th\xeam voucher theo m\xe3, t\xean voucher, m\xe3 s\u1ea3n ph\u1ea9m c\u1ee7a NCC",readonly:!0,keyGetValue:"inventory_id",listOptionDropdown:null,nzServerSearch:!0,callBackThis:n=>{this.DropDownTableRef=n},changeItems:n=>{this.model.flash_sale_config.products=n||[]},columns:[{name:"STT",width:"60px",field:"index",type:"index"},{name:"M\xe3 MyPoint",width:"10%",field:"product_id",ignoreParseNumber:!0,type:"text"},{name:"T\xean voucher",width:"20%",field:"name",type:"text"},{name:"Nh\xf3m Flash Sale",width:"20%",field:"groups",type:"multi-select",required:!0,options:this.groupsSelectionChanged?.asObservable().pipe((0,h.U)(n=>n.map(i=>({name:i.name,id:i._id||i.id}))))},{name:"T\xean NCC",width:"10%",field:"brand_name",type:"text"},{name:"Gi\xe1 flash sale",width:"10%",required:!0,field:"price",max:999999999,min:1,inputType:"number",type:"input"},{name:"S\u1ed1 l\u01b0\u1ee3ng",width:"10%",field:"quantity",required:!0,max:999999999,min:1,inputType:"number",type:"input"},{name:"\u0110\xe3 b\xe1n \u1ea3o",width:"10%",required:!0,field:"sold_fake",max:999999999,min:1,inputType:"number",type:"input"},{name:"H\xe0nh \u0111\u1ed9ng",width:"%",field:"actions",type:"action"}]}}]}]}startTimeValidator(t){const a=t.parent?.value?.start_time,n=t.parent?.value?.end_time;return a&&n&&k(n).isBefore(k(a).add(5,"minutes"))?{startTimeInvalid5Minutes:!0}:null}ngOnInit(){setInterval(()=>{console.log(this.model)},5e3)}handlerCancel(t){t?.stopPropagation(),t?.preventDefault(),"view"!==this.mode?this.modalService.confirm({nzTitle:this.model?.id?"B\u1ea1n c\xf3 h\u1ee7y b\u1ecf thao t\xe1c ?":"B\u1ea1n c\xf3 mu\u1ed1n h\u1ee7y th\xeam m\u1edbi flash sale kh\xf4ng?",nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzMaskClosable:!1,nzClosable:!0,nzOnOk:()=>this.router.navigateByUrl("flash-sale/list"),nzCancelText:"\u0110\xf3ng"},"info"):this.router.navigateByUrl("flash-sale/list")}updateFieldReadonlyStatus(){let t=!0;("edit"===this.mode||"add"===this.mode)&&(t=!1),this.options.formState.disabled=t,this.fields.forEach(a=>{this.setReadonlyForField(a,t)})}setReadonlyForField(t,a){t?.fieldGroup?.length&&t?.fieldGroup?.forEach(n=>this.setReadonlyForField(n,a)),t.fieldArray?.fieldGroup?.length&&t.props?(!t.props.ignoreChange&&(t.props.readonly=a),!t.props.ignoreChange&&(t.props.disabled=a),t.fieldArray?.fieldGroup?.forEach(n=>this.setReadonlyForField(n,a))):t.props&&(!t.props.ignoreChange&&(t.props.readonly=a),!t.props.ignoreChange&&(t.props.disabled=a))}validate(){return!(this.model?.config_layout?.no_product>this.model?.flash_sale_config?.products?.length&&(this.IComMessageService.showAlertMessageError("S\u1ed1 s\u1ea3n ph\u1ea9m trong b\u1ea3ng c\u1ea7n l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng S\u1ed1 l\u01b0\u1ee3ng hi\u1ec3n th\u1ecb tr\xean Trang ch\u1ee7"),1))}handlerSave(t){var a=this;return(0,g.Z)(function*(){t.stopPropagation(),t.preventDefault();let n=!0;if(n=a.DropDownTableRef.handlerSave(),a.form.invalid)(0,I.c2)(a.form);else if(a.validate()&&n)try{a.isLoading=!0;const i=a.getFilteredProductData(),s={...a.model,flash_sale_config:{...a.model.flash_sale_config,products:i}};a.data?._id?yield(0,c.n)(a.iComLibsServicesProjectFlashSaleService.edit(s)):yield(0,c.n)(a.iComLibsServicesProjectFlashSaleService.create(s)),a.IComMessageService.showAlertMessageDone(a.data?._id?"S\u1eeda flash sale th\xe0nh c\xf4ng.":"T\u1ea1o m\u1edbi flash sale th\xe0nh c\xf4ng."),a.router.navigateByUrl("flash-sale/list")}catch(i){const r=i?.error?.error_message;if(r&&r.includes("{inventory_name}")){const p=a.form?.get("flash_sale_config.inventory_id")?.value||a.data?.flash_sale_config?.inventory_id,_=a.findInventoryNameById(p),m=r.replace("{inventory_name}",_);a.IComMessageService.showAlertMessageError(m)}else a.IComMessageService.showAlertMessageError(r||(a.data?._id?"S\u1eeda flash sale th\u1ea5t b\u1ea1i.":"T\u1ea1o m\u1edbi flash sale th\u1ea5t b\u1ea1i."))}finally{a.isLoading=!1,a.cdr.detectChanges()}})()}getListVoucherSelected(){var t=this;return(0,g.Z)(function*(){if(!t.data?.flash_sale_config?.products?.length)return Promise.resolve(void 0);try{const a=yield(0,c.n)(t.iComLibsServicesProjectFlashSaleService.voucherList({_id:t.data?._id,page:1,size:999999}));return Promise.resolve(a?.data?.items.map(n=>({...n,...n.product_detail})))}catch{return Promise.resolve([])}})()}customDropdownValidator(t){return Array.isArray(t.value)&&0!==t.value.length?null:{required:!0}}handlerEdit(t){t.stopPropagation(),t.preventDefault(),this.mode="edit",this.setFields(),this.updateSelectedGroups(),this.updateFieldReadonlyStatus(),this.options={formState:{disabled:!1,required:!1,mainModel:this.model}}}handlerRemove(t){t.stopPropagation(),this?.model?.is_transaction_exists?this.IComMessageService.showAlertMessageError("Flash sale \u0111\xe3 c\xf3 giao d\u1ecbch th\xe0nh c\xf4ng. B\u1ea1n kh\xf4ng \u0111\u01b0\u1ee3c ph\xe9p s\u1eeda."):this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ${this.data?.name} ?`,nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDeleteSection.bind(this,this.data),nzCancelText:"H\u1ee7y b\u1ecf"},"error")}processDeleteSection(t){return(0,c.n)(this.iComLibsServicesProjectFlashSaleService.delete(t?._id||"")).then(()=>{this.IComMessageService.showAlertMessageDone("Thao t\xe1c th\xe0nh c\xf4ng."),this.router.navigateByUrl("flash-sale/list")}).catch(a=>{this.IComMessageService.showAlertMessageError(a?.error?.error_message||"Thao t\xe1c th\u1ea5t b\u1ea1i")})}handlerActivate(t){t.stopPropagation(),this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n k\xedch ho\u1ea1t ${this.data?.name} ?`,nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processChangeStatus.bind(this,this.data),nzCancelText:"H\u1ee7y b\u1ecf"},"info")}processChangeStatus(t){var a=this;return(0,g.Z)(function*(){try{yield(0,c.n)(a.iComLibsServicesProjectFlashSaleService.changeStatusActive({_id:t?._id||""})),a.IComMessageService.showAlertMessageDone("Thao t\xe1c th\xe0nh c\xf4ng."),a.router.navigateByUrl("flash-sale/list")}catch(n){a.IComMessageService.showAlertMessageError(n?.error?.error_message||"Thao t\xe1c th\u1ea5t b\u1ea1i")}})()}processDeactivate(t){var a=this;return(0,g.Z)(function*(){try{yield(0,c.n)(a.iComLibsServicesProjectFlashSaleService.changeStatusInactive({_id:t?._id||""})),a.IComMessageService.showAlertMessageDone("Thao t\xe1c th\xe0nh c\xf4ng."),a.router.navigateByUrl("flash-sale/list")}catch(n){a.IComMessageService.showAlertMessageError(n?.error?.error_message||"Thao t\xe1c th\u1ea5t b\u1ea1i")}})()}handlerDeactivate(t){t.stopPropagation(),this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n ng\u1eebng k\xedch ho\u1ea1t ${this.data?.name} ?`,nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDeactivate.bind(this,this.data),nzCancelText:"H\u1ee7y b\u1ecf"},"info")}findGroupById(t){return this.allGroups.find(a=>a._id===t)}getFilteredProductData(){return(this.model?.flash_sale_config?.products).map(a=>{const n={product_id:a.product_id||a.id,price:a.price,quantity:a.quantity,sold_fake:a.sold_fake,groups:a.groups};return Object.keys(a).forEach(i=>{i.startsWith("field_system")&&(n[i]=a[i])}),n})}findInventoryNameById(t){const a=this.listInventory?.find(n=>n.id===t);return a?a.name:"Kh\xf4ng x\xe1c \u0111\u1ecbnh"}ngOnDestroy(){this.groupsSelectionChanged.complete()}static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-flash_sale-detail-general"]],inputs:{data:"data",mode:"mode"},outputs:{icomDetailFlashSale:"icomDetailFlashSale"},standalone:!0,features:[e.jDz],decls:3,vars:3,consts:[[4,"ngIf"],["class","flex flex-col w-full h-full bg-white !pl-0 pr-0",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],["class","h-full w-full flex flex-col !absolute top-0 left-0 !pb-4 !pt-0 !pl-4 !pr-0 !bg-[#f0f2f5]","nzBackIcon","",3,"nzBack",4,"ngIf"],["nzBackIcon","",1,"h-full","w-full","flex","flex-col","!absolute","top-0","left-0","!pb-4","!pt-0","!pl-4","!pr-0","!bg-[#f0f2f5]",3,"nzBack"],[1,"w-full","h-full","flex","overflow-auto","!py-0","!pl-0","!pr-4","flex-col"],["nz-form","",3,"formGroup"],[1,"flex","flex-col"],[1,"w-full","items-center","test"],[3,"model","fields","form","options"],[1,"flex","justify-end"],["nz-button","","nzType","default",3,"click",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"nzLoading","click",4,"nzSpaceItem"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"nzLoading","click"],[1,"flex","flex-col","w-full","h-full","bg-white","!pl-0","pr-0"],["nz-form","",1,"h-full","overflow-hidden","!pl-2",3,"formGroup","nzLayout"],["class","flex justify-end  p-3 border",4,"ngIf"],[1,"flex","justify-end","p-3","border"],["nz-button","","nzType","primary",3,"nzLoading","nzDanger","click",4,"nzSpaceItem"],["nz-button","","nzType","primary",3,"nzLoading","nzDanger","click"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(a,n){1&a&&(e.YNc(0,se,2,1,"ng-container",0),e.YNc(1,ge,6,7,"div",1),e.YNc(2,fe,1,1,"nz-spin",2)),2&a&&(e.Q6J("ngIf",("add"===n.mode||"edit"===n.mode)&&!n.isLoadingDetails),e.xp6(1),e.Q6J("ngIf","view"===n.mode&&!n.isLoadingDetails),e.xp6(1),e.Q6J("ngIf",n.isLoadingDetails))},dependencies:[q.X0,q.T7,C.UX,C._Y,C.JL,C.sg,f.ez,f.O5,N.ZJ,y.KJ,y.$O,y.u9,y.u5,y.$,x.zf,x.NU,x.$1,T.we,D.PV,$.vh,ee.N6,V.U5,V.Lr,z.sL,z.ix,F.w,P.dQ,X.q6,w.j,w.W],styles:[".test[_ngcontent-%COMP%]     formly-group{display:flex;flex-wrap:wrap}.test[_ngcontent-%COMP%]     formly-group .test2 nz-form-label{width:auto!important}"],changeDetection:0})}return o})();var B=l(2274),Z=l(8581);function ye(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.downloadSampleFile())}),e._UZ(1,"span",14),e._uU(2," Xu\u1ea5t file\n"),e.qZA()}2&o&&e.Q6J("nzType","primary")}function ve(o,u){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=u.$implicit,a=u.last;e.xp6(1),e.AsE(" ",null==t?null:t.name,"",a?"":", "," ")}}function be(o,u){if(1&o&&(e.TgZ(0,"tr")(1,"td",15),e._uU(2),e.qZA(),e.TgZ(3,"td",15),e._uU(4),e.qZA(),e.TgZ(5,"td",16),e._uU(6),e.qZA(),e.TgZ(7,"td",15),e.YNc(8,ve,2,2,"span",11),e.qZA(),e.TgZ(9,"td",15),e._uU(10),e.qZA(),e.TgZ(11,"td",15),e._uU(12),e.ALo(13,"number"),e.qZA(),e.TgZ(14,"td",15),e._uU(15),e.ALo(16,"number"),e.qZA(),e.TgZ(17,"td",15),e._uU(18),e.ALo(19,"number"),e.qZA(),e.TgZ(20,"td",15),e._uU(21),e.ALo(22,"number"),e.qZA()()),2&o){const t=u.$implicit,a=u.index,n=e.oxw();e.xp6(2),e.Oqu((n.pagination.page-1)*n.pagination.total_rows+a+1),e.xp6(2),e.Oqu(null==t.product_detail?null:t.product_detail.product_id),e.xp6(2),e.Oqu(null==t||null==t.product_detail?null:t.product_detail.name),e.xp6(2),e.Q6J("ngForOf",t.groups_detail),e.xp6(2),e.Oqu(null==t||null==t.product_detail?null:t.product_detail.brand_name),e.xp6(2),e.Oqu(e.lcZ(13,9,t.price)),e.xp6(3),e.Oqu(e.lcZ(16,11,t.quantity)),e.xp6(3),e.Oqu(e.lcZ(19,13,null==t?null:t.sold_real)),e.xp6(3),e.Oqu(e.lcZ(22,15,t.sold_fake))}}function ze(o,u){if(1&o&&(e.TgZ(0,"div",17),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" T\u1ed5ng s\u1ed1 b\u1ea3n ghi: ",(null==t.pagination?null:t.pagination.total_rows)||0," ")}}const Te=function(){return{x:"1500px",y:"calc(100vh - 380px)"}},Ce=function(){return[10,20,30,40,50]};let xe=(()=>{class o{constructor(){this.displayData=[],this.pagination={page:1,limit:10,total_pages:1,total_rows:10,sort:"asc"},this.loading=!0,this.allGroups=[],this.rows=[],this.IComMessageService=(0,e.f3M)(E.Q),this.cdr=(0,e.f3M)(e.sBO),this.iComLibsServicesProjectFlashSaleService=(0,e.f3M)(b.Rm),this.iComLibsServicesInventoryService=(0,e.f3M)(b.NH)}ngOnInit(){var t=this;return(0,g.Z)(function*(){const a=yield(0,c.n)(t.iComLibsServicesProjectFlashSaleService.listGroup({page:1,limit:99999}));t.allGroups=a?.data?.items||[],t.iComLibsServicesInventoryService.listInventory({page:1,limit:999999}).pipe((0,h.U)(n=>{const i=n?.data?.items?.find(s=>s.id===t.data?.flash_sale_config?.inventory_id)||[];i?.name&&(t.nameInventory=i?.name)})).subscribe(),t.loadPage(1)})()}loadPage(t=1,a=10){var n=this;return(0,g.Z)(function*(){try{n.loading=!0;const i={_id:n.data._id,size:a,page:t},s=yield(0,c.n)(n.iComLibsServicesProjectFlashSaleService.voucherList(i));if(s&&s.data&&s.data.items)return n.rows=s.data.items||[],void(n.pagination=s.data.pagination);n.rows=[],n.pagination=s.data.pagination}catch(i){console.log(i)}finally{n.loading=!1,n.cdr.detectChanges()}})()}onPageChange(t){this.loadPage(t,this.pagination.limit)}onPageSizeChange(t){this.loadPage(1,t)}downloadSampleFile(){(0,I.cT)(`${Z.N.apiGatewayUrl}${Z.N.suffixCampaignV3}/flashsale/voucher/export`,"DanhSachSanPham",this.IComMessageService,{_id:this.data._id})}static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-product-table"]],inputs:{data:"data"},standalone:!0,features:[e.jDz],decls:32,vars:14,consts:[[1,"w-full","justify-end","flex","my-2"],["nz-button","",3,"nzType","click",4,"ngIf"],[1,"w-full"],[1,"font-semibold"],["nzShowSizeChanger","",1,"h-100",3,"nzScroll","nzTotal","nzPageSize","nzNoResult","nzPageIndex","nzFrontPagination","nzPageSizeOptions","nzFooter","nzData","nzPageIndexChange","nzPageSizeChange"],["table",""],["nzWidth","5%",1,"text-xs"],["nzWidth","15%",1,"text-xs"],["nzWidth","20%",1,"text-xs"],["nzWidth","10%",1,"text-xs"],["nzWidth","100px",1,"text-xs"],[4,"ngFor","ngForOf"],["footerTemplate",""],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","plus","nzTheme","outline"],[1,"text-xs","!p-3"],[1,"text-xs","!p-3","text-truncate"],[1,"footer-content"]],template:function(a,n){if(1&a&&(e.TgZ(0,"div",0),e.YNc(1,ye,3,1,"button",1),e.qZA(),e.TgZ(2,"div",2)(3,"span",3),e._uU(4,"Kho s\u1ea3n ph\u1ea9m:"),e.qZA(),e._uU(5),e.qZA(),e.TgZ(6,"nz-table",4,5),e.NdJ("nzPageIndexChange",function(s){return n.onPageChange(s)})("nzPageSizeChange",function(s){return n.onPageSizeChange(s)}),e.TgZ(8,"thead")(9,"tr")(10,"th",6),e._uU(11,"STT"),e.qZA(),e.TgZ(12,"th",7),e._uU(13,"M\xe3 MyPoint"),e.qZA(),e.TgZ(14,"th",8),e._uU(15,"T\xean voucher"),e.qZA(),e.TgZ(16,"th",9),e._uU(17,"Nh\xf3m flash sale"),e.qZA(),e.TgZ(18,"th",9),e._uU(19,"T\xean NCC"),e.qZA(),e.TgZ(20,"th",9),e._uU(21,"Gi\xe1 flash sale"),e.qZA(),e.TgZ(22,"th",9),e._uU(23,"S\u1ed1 l\u01b0\u1ee3ng"),e.qZA(),e.TgZ(24,"th",10),e._uU(25,"\u0110\xe3 b\xe1n th\u1eadt"),e.qZA(),e.TgZ(26,"th",10),e._uU(27,"\u0110\xe3 b\xe1n \u1ea3o"),e.qZA()()(),e.TgZ(28,"tbody"),e.YNc(29,be,23,17,"tr",11),e.qZA()(),e.YNc(30,ze,2,1,"ng-template",null,12,e.W1O)),2&a){const i=e.MAs(31);e.xp6(1),e.Q6J("ngIf",null==n.rows?null:n.rows.length),e.xp6(4),e.hij(" ",n.nameInventory,"\n"),e.xp6(1),e.Q6J("nzScroll",e.DdM(12,Te))("nzTotal",(null==n.pagination?null:n.pagination.total_rows)||1)("nzPageSize",10)("nzNoResult","Kh\xf4ng c\xf3 d\u1eef li\u1ec7u.")("nzPageIndex",(null==n.pagination?null:n.pagination.page)||1)("nzFrontPagination",!1)("nzPageSizeOptions",e.DdM(13,Ce))("nzFooter",i)("nzData",n.rows),e.xp6(23),e.Q6J("ngForOf",n.rows)}},dependencies:[d.HQ,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,B.uK,f.JJ,f.ax,f.O5,z.sL,z.ix,F.w,P.dQ],encapsulation:2,changeDetection:0})}return o})();function Se(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.downloadSampleFile())}),e._UZ(1,"span",11),e._uU(2," Xu\u1ea5t file\n"),e.qZA()}2&o&&e.Q6J("nzType","primary")}function Ze(o,u){if(1&o&&(e.TgZ(0,"tr")(1,"td",12),e._uU(2),e.qZA(),e.TgZ(3,"td",12),e._uU(4),e.qZA(),e.TgZ(5,"td",12),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td",12),e._uU(9),e.qZA(),e.TgZ(10,"td",12),e._uU(11),e.qZA(),e.TgZ(12,"td",12),e._uU(13),e.qZA(),e.TgZ(14,"td",12),e._uU(15),e.ALo(16,"number"),e.qZA(),e.TgZ(17,"td",12),e._uU(18),e.ALo(19,"number"),e.qZA(),e.TgZ(20,"td",12),e._uU(21),e.ALo(22,"number"),e.qZA(),e.TgZ(23,"td",12),e._uU(24),e.qZA(),e.TgZ(25,"td",12),e._uU(26),e.ALo(27,"number"),e.qZA(),e.TgZ(28,"td",12),e._uU(29),e.ALo(30,"number"),e.qZA(),e.TgZ(31,"td",12),e._uU(32),e.ALo(33,"number"),e.qZA(),e.TgZ(34,"td",12),e._uU(35),e.qZA(),e.TgZ(36,"td",12),e._uU(37),e.qZA()()),2&o){const t=u.$implicit,a=u.index,n=e.oxw();e.xp6(2),e.Oqu((n.pagination.page-1)*n.pagination.limit+a+1),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(e.xi3(7,15,t.transaction_time,"dd/MM/yyyy HH:mm")),e.xp6(3),e.Oqu(null==t?null:t.product_id),e.xp6(2),e.Oqu(t.brand_name),e.xp6(2),e.Oqu(t.product_name),e.xp6(2),e.Oqu(e.lcZ(16,18,t.quantity)),e.xp6(3),e.Oqu(e.lcZ(19,20,t.sale_price)),e.xp6(3),e.Oqu(e.lcZ(22,22,t.total)),e.xp6(3),e.Oqu(t.discount_flash_sale||0),e.xp6(2),e.Oqu(e.lcZ(27,24,null==t?null:t.total_need_to_pay)),e.xp6(3),e.Oqu(e.lcZ(30,26,t.pay_point)),e.xp6(3),e.Oqu(e.lcZ(33,28,t.pay_cash)),e.xp6(3),e.Oqu(t.full_name),e.xp6(2),e.Oqu(t.phone_number)}}function we(o,u){if(1&o&&(e.TgZ(0,"div",13),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" T\u1ed5ng s\u1ed1 b\u1ea3n ghi: ",(null==t.pagination?null:t.pagination.total_rows)||0," ")}}const Ae=function(){return{x:"1500px",y:"calc(100vh - 350px)"}},Ee=function(){return[10,20,30,40,50]};let Ie=(()=>{class o{constructor(){this.isLoading=!1,this.pagination={page:1,limit:10,total_pages:1,total_rows:10,sort:"asc"},this.loading=!0,this.rows=[],this.cdr=(0,e.f3M)(e.sBO),this.iComLibsServicesProjectFlashSaleService=(0,e.f3M)(b.Rm),this.IComMessageService=(0,e.f3M)(E.Q)}ngOnInit(){this.loadPage(1)}downloadSampleFile(){(0,I.cT)(`${Z.N.apiGatewayUrl}${Z.N.suffixCampaignV3}/flashsale/voucher/transaction/export`,"LichSuGiaoDich",this.IComMessageService,{_id:this.data._id})}loadPage(t=1,a=10){var n=this;return(0,g.Z)(function*(){try{n.loading=!0;const i={_id:n.data._id,size:a,page:t},s=yield(0,c.n)(n.iComLibsServicesProjectFlashSaleService.transactionList(i));if(s&&s.data&&s.data.items)return n.rows=s.data.items||[],void(n.pagination=s.data.pagination);n.rows=[],n.pagination=s.data.pagination}catch(i){console.log(i)}finally{n.loading=!1,n.cdr.detectChanges()}})()}onPageChange(t){this.loadPage(t,this.pagination.limit)}onPageSizeChange(t){this.loadPage(1,t)}static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-history"]],inputs:{data:"data"},standalone:!0,features:[e.jDz],decls:40,vars:15,consts:[[1,"w-full","justify-end","flex","my-2"],["nz-button","",3,"nzType","click",4,"ngIf"],["nzShowSizeChanger","",1,"h-100",3,"nzScroll","nzData","nzTotal","nzPageSize","nzLoading","nzNoResult","nzPageIndex","nzFrontPagination","nzPageSizeOptions","nzFooter","nzPageIndexChange","nzPageSizeChange"],["table",""],["nzWidth","100px",1,"text-xs"],["nzWidth","300px",1,"text-xs"],["nzWidth","150px",1,"text-xs"],["nzWidth","200px",1,"text-xs"],[4,"ngFor","ngForOf"],["footerTemplate",""],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","plus","nzTheme","outline"],[1,"text-xs","!p-3"],[1,"footer-content"]],template:function(a,n){if(1&a&&(e.TgZ(0,"div",0),e.YNc(1,Se,3,1,"button",1),e.qZA(),e.TgZ(2,"nz-table",2,3),e.NdJ("nzPageIndexChange",function(s){return n.onPageChange(s)})("nzPageSizeChange",function(s){return n.onPageSizeChange(s)}),e.TgZ(4,"thead")(5,"tr")(6,"th",4),e._uU(7,"STT"),e.qZA(),e.TgZ(8,"th",5),e._uU(9,"M\xe3 giao d\u1ecbch"),e.qZA(),e.TgZ(10,"th",6),e._uU(11,"Th\u1eddi gian giao d\u1ecbch th\xe0nh c\xf4ng"),e.qZA(),e.TgZ(12,"th",6),e._uU(13,"M\xe3 s\u1ea3n ph\u1ea9m tr\xean MyPoint"),e.qZA(),e.TgZ(14,"th",7),e._uU(15,"T\xean NCC"),e.qZA(),e.TgZ(16,"th",7),e._uU(17,"T\xean voucher"),e.qZA(),e.TgZ(18,"th",4),e._uU(19,"S\u1ed1 l\u01b0\u1ee3ng"),e.qZA(),e.TgZ(20,"th",4),e._uU(21,"Gi\xe1 b\xe1n"),e.qZA(),e.TgZ(22,"th",4),e._uU(23,"T\u1ed5ng ti\u1ec1n"),e.qZA(),e.TgZ(24,"th",7),e._uU(25,"S\u1ed1 ti\u1ec1n gi\u1ea3m gi\xe1"),e.qZA(),e.TgZ(26,"th",6),e._uU(27,"T\u1ed5ng ti\u1ec1n c\u1ea7n thanh to\xe1n"),e.qZA(),e.TgZ(28,"th",6),e._uU(29,"S\u1ed1 \u0111i\u1ec3m \u0111\xe3 d\xf9ng \u0111\u1ec3 thanh to\xe1n"),e.qZA(),e.TgZ(30,"th",6),e._uU(31,"S\u1ed1 ti\u1ec1n \u0111\xe3 d\xf9ng \u0111\u1ec3 thanh to\xe1n"),e.qZA(),e.TgZ(32,"th",6),e._uU(33,"Ng\u01b0\u1eddi mua"),e.qZA(),e.TgZ(34,"th",6),e._uU(35,"S\u0110T"),e.qZA()()(),e.TgZ(36,"tbody"),e.YNc(37,Ze,38,30,"tr",8),e.qZA()(),e.YNc(38,we,2,1,"ng-template",null,9,e.W1O)),2&a){const i=e.MAs(39);e.xp6(1),e.Q6J("ngIf",null==n.rows?null:n.rows.length),e.xp6(1),e.Q6J("nzScroll",e.DdM(13,Ae))("nzData",n.rows)("nzTotal",(null==n.pagination?null:n.pagination.total_rows)||1)("nzPageSize",10)("nzLoading",n.isLoading)("nzNoResult","Kh\xf4ng c\xf3 d\u1eef li\u1ec7u.")("nzPageIndex",(null==n.pagination?null:n.pagination.page)||1)("nzFrontPagination",!1)("nzPageSizeOptions",e.DdM(14,Ee))("nzFooter",i)("nzData",n.rows),e.xp6(35),e.Q6J("ngForOf",n.rows)}},dependencies:[d.HQ,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,B.uK,f.JJ,f.uU,f.ax,f.O5,z.sL,z.ix,F.w,P.dQ],encapsulation:2,changeDetection:0})}return o})();function Fe(o,u){if(1&o){const t=e.EpF();e.TgZ(0,"icom-libs-flash_sale-detail-general",7),e.NdJ("icomDetailFlashSale",function(n){e.CHM(t);const i=e.oxw();return e.KtG(i.handlerDetailFlashSale(n))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("mode",t.mode)}}function Pe(o,u){if(1&o&&e._UZ(0,"app-product-table",9),2&o){const t=e.oxw(2);e.Q6J("data",t.inventory)}}function Le(o,u){1&o&&(e.TgZ(0,"nz-tab",8),e.YNc(1,Pe,1,1,"ng-template",4),e.qZA())}function Me(o,u){if(1&o&&e._UZ(0,"app-history",9),2&o){const t=e.oxw(2);e.Q6J("data",t.inventory)}}function De(o,u){1&o&&(e.TgZ(0,"nz-tab",10),e.YNc(1,Me,1,1,"ng-template",4),e.qZA())}let Ne=(()=>{class o{constructor(){this.listOfData=[],this.tabs=[{title:"Th\xf4ng tin chung",content:"Content of Tab Pane 1",isLoading:!1},{title:"Danh s\xe1ch \u0111\u01a1n h\xe0ng",content:"Content of Tab Pane 2",isLoading:!1},{title:"L\u1ecbch s\u1eed giao d\u1ecbch",content:"Content of Tab Pane 3",isLoading:!1}],this.cdr=(0,e.f3M)(e.sBO),this.route=(0,e.f3M)(A.gz)}ngOnInit(){var t=this;this.route.queryParams.pipe().subscribe(function(){var a=(0,g.Z)(function*(n){n&&(t.mode=n.mode,t.inventoryId=n.mode,t.cdr.detectChanges())});return function(n){return a.apply(this,arguments)}}())}handlerDetailFlashSale(t){this.inventory=t,this.cdr.detectChanges()}static#e=this.\u0275fac=function(a){return new(a||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["icom-libs-flash-sale-detail"]],standalone:!0,features:[e.jDz],decls:10,vars:3,consts:[["nzBackIcon","",1,"site-page-header","h-full","w-full","flex","flex-col","!p-0"],[1,"w-full","h-full","!pt-0","flex","overflow-hidden"],[1,"h-full","w-full"],["nzTitle","Th\xf4ng tin chung"],["nz-tab",""],["nzTitle","Danh s\xe1ch s\u1ea3n ph\u1ea9m ",4,"ngIf"],["nzTitle","L\u1ecbch s\u1eed giao d\u1ecbch",4,"ngIf"],[1,"h-full","w-full",3,"mode","icomDetailFlashSale"],["nzTitle","Danh s\xe1ch s\u1ea3n ph\u1ea9m "],[3,"data"],["nzTitle","L\u1ecbch s\u1eed giao d\u1ecbch"]],template:function(a,n){1&a&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-title"),e._uU(2),e.qZA(),e.TgZ(3,"nz-page-header-content",1)(4,"div",2)(5,"nz-tabset")(6,"nz-tab",3),e.YNc(7,Fe,1,1,"ng-template",4),e.qZA(),e.YNc(8,Le,2,0,"nz-tab",5),e.YNc(9,De,2,0,"nz-tab",6),e.qZA()()()()),2&a&&(e.xp6(2),e.Oqu((null==n.inventory?null:n.inventory.name)||"T\u1ea1o m\u1edbi"),e.xp6(6),e.Q6J("ngIf","view"===n.mode),e.xp6(1),e.Q6J("ngIf","view"===n.mode))},dependencies:[N.ZJ,y.KJ,y.$O,y.u9,y.u5,x.zf,T.we,T.xH,T.xw,T.cj,D.PV,f.O5,d.HQ,w.j,_e,xe,Ie],styles:[".test[_ngcontent-%COMP%]     formly-group{display:flex;flex-wrap:wrap}"],changeDetection:0})}return o})()}}]);