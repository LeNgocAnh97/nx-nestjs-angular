"use strict";(self.webpackChunkicom=self.webpackChunkicom||[]).push([["libs_product_detail_src_index_ts"],{3571:($,O,s)=>{s.r(O),s.d(O,{IcomLibsProductDetailComponent:()=>st});var _=s(1670),e=s(1699),r=s(8849),h=s(8399),x=s(7313),P=s(2282),v=s(8619),J=s(1498),I=s(6575),Q=s(8641),m=s(1539),k=s(1932),z=s(7716),b=s(7090),u=s(5942),R=s(1367),A=s(292),Y=s(9831),F=s(7091);let Z=(()=>{class n{ngOnInit(){console.log(this.product),this.product.created_at&&(this.product.created_at_format=A(this.product.created_at).format("DD/MM/YYYY HH:mm"),this.product.updated_at_format=A(this.product.updated_at).format("DD/MM/YYYY HH:mm"))}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-history"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:20,vars:6,consts:[["nzTitle","History",2,"width","300px"],[2,"color","#8b8b8b"],["nzType","vertical"]],template:function(o,i){1&o&&(e.TgZ(0,"nz-card",0)(1,"p")(2,"span",1),e._uU(3,"Creator:\xa0"),e.qZA(),e._uU(4),e.qZA(),e._UZ(5,"nz-divider",2),e.TgZ(6,"p")(7,"span",1),e._uU(8,"Create Time:\xa0"),e.qZA(),e._uU(9),e.qZA(),e._UZ(10,"nz-divider",2),e.TgZ(11,"p")(12,"span",1),e._uU(13,"Updater:\xa0"),e.qZA(),e._uU(14),e.qZA(),e._UZ(15,"nz-divider",2),e.TgZ(16,"p")(17,"span",1),e._uU(18,"Update Time:\xa0"),e.qZA(),e._uU(19),e.qZA()()),2&o&&(e.xp6(4),e.AsE(" [",null==i.product||null==i.product.creator_info?null:i.product.creator_info.customer_id,"] ",null==i.product||null==i.product.creator_info?null:i.product.creator_info.full_name," "),e.xp6(5),e.hij(" ",(null==i.product?null:i.product.created_at_format)||(null==i.product?null:i.product.created_at),""),e.xp6(5),e.AsE(" [",null==i.product||null==i.product.updater_info?null:i.product.updater_info.customer_id,"] ",null==i.product||null==i.product.updater_info?null:i.product.updater_info.full_name,""),e.xp6(5),e.hij(" ",(null==i.product?null:i.product.updated_at_format)||(null==i.product?null:i.product.updated_at),""))},dependencies:[Y.vh,Y.bd,F.S,F.g],encapsulation:2})}return n})();function G(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-history",3),2&n){const t=e.oxw();e.Q6J("product",t.product)}}let B=(()=>{class n{constructor(){this.productService=(0,e.f3M)(u.k)}ngOnInit(){this.product&&(this.product.date_range=[A(this.product.start_time).toDate(),A(this.product.end_time).toDate()])}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-general"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:3,vars:2,consts:[[1,"flex","w-full","h-full","justify-between"],[1,"w-full","mr-4",3,"model"],[3,"product",4,"ngIf"],[3,"product"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"icom-libs-product-add_edit",1),e.YNc(2,G,1,1,"icom-libs-product-detail-history",2),e.qZA()),2&o&&(e.xp6(1),e.Q6J("model",i.product),e.xp6(1),e.Q6J("ngIf",i.product))},dependencies:[R.IcomLibsProductAddEditComponent,Z,I.O5],encapsulation:2})}return n})();var w=s(9717),M=s(7178),D=s(9736),f=s(1236),T=s(7594),L=s(5594),S=s(479),N=s(5920);function j(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.handlerSave(i))}),e._uU(2," Submit "),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.handlerCancel(i))}),e._uU(4," Cancel "),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("action","edit")("nzLoading",t.isLoading)("nzType","primary"),e.xp6(2),e.Q6J("action","edit")}}function q(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleDisabled())}),e._uU(2," Edit "),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("action","edit")("nzType","primary"))}function ee(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-history",13),2&n){const t=e.oxw(2);e.Q6J("product",t.model)}}function K(n,c){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4),e._UZ(3,"formly-form",5),e.TgZ(4,"div",6),e.YNc(5,j,5,4,"div",7),e.YNc(6,q,3,2,"div",7),e.qZA()()(),e.YNc(7,ee,1,1,"icom-libs-product-detail-history",8),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled)),e.xp6(1),e.Q6J("ngIf",null==t.options||null==t.options.formState?null:t.options.formState.disabled),e.xp6(1),e.Q6J("ngIf",null==t.model?null:t.model.id)}}function a(n,c){1&n&&e._UZ(0,"nz-spin",14),2&n&&e.Q6J("nzSize","large")}let C=(()=>{class n{constructor(){this.form=new r.cw({}),this.options={formState:{disabled:!0}},this.fields=[],this.productService=(0,e.f3M)(u.k),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.model={subpool_id:0,pool_id:8},this.fields=[{key:"payment_method",type:"select-custom",props:{label:"Payment Method",classInclude:"w-[300px]",placeholder:"Select Payment Method",viewValue:"name",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("PAYMENT_METHOD").pipe((0,D.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"sale_price",type:"input",className:"",props:{label:"Sale price",required:!0,type:"number"},validators:["iniMin0"],expressions:{"props.disabled":"formState.disabled"}},{key:"purchase_cost",type:"input",className:"basis-6/12 ml-4",props:{label:"Purchase cost",required:!0,type:"number"},validators:["iniMin0"],expressions:{"props.disabled":"formState.disabled"}},{key:"pool_id",className:"basis-4/12",type:"select-custom",props:{placeholder:"Select Pool",label:"Pool",viewValue:"id",labelProp:"id",valueProp:"id",classInclude:"w-[300px]",required:!0,options:[{id:8,name:"Pool"}]},expressions:{"props.disabled":"formState.disabled"}},{key:"subpool_id",type:"select-custom",className:"basis-4/12 ml-4",props:{label:"Sub Pool",placeholder:"Select Sub Pool",viewValue:"id",required:!0,classInclude:"w-[300px]",labelProp:"id",valueProp:"id",options:[{id:0,name:"Sub Pool"}]},expressions:{"props.disabled":"formState.disabled"}}]}ngOnInit(){var t=this;return(0,_.Z)(function*(){try{t.loadingIndicator=!0,t.model=yield(0,f.n)(t.productService.getProductPrice(t.product?.id)),t.modelOrigin=(0,M.cloneDeep)(t.model)}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerSave(t){var o=this;return(0,_.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(l=>{o.form.controls[l].touched=!0});o.isLoading=!0,o.cdr.detectChanges(),o.form.markAsTouched(),o.form.submitted=!0;const i={...o.model};if(i.id)return yield(0,f.n)(o.productService.updateProductPrice(i)),o.IComMessageService.showAlertMessageDone("Edit product price success"),o.modelOrigin=(0,M.cloneDeep)(o.model),void o.toggleDisabled();yield(0,f.n)(o.productService.createProductPrice(i)),o.modelOrigin=(0,M.cloneDeep)(o.model),o.IComMessageService.showAlertMessageError("Edit product price success")}catch(i){o.IComMessageService.showAlertMessageError(i?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}})()}handlerCancel(t){t.stopPropagation(),t.preventDefault(),this.toggleDisabled(),this.form.reset(this.modelOrigin)}toggleDisabled(){this.options.formState.disabled=!this.options.formState.disabled}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-price"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","pt-4","bg-white","border","rounded-md"],["nz-form","",3,"formGroup"],[3,"model","fields","options","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],["nz-col","",1,"search-area","flex"],["icomLibsHasPermissionDirective","","nz-button","",3,"action","nzLoading","nzType","click"],["icomLibsHasPermissionDirective","","nz-button","",1,"ml-4",3,"action","click"],["icomLibsHasPermissionDirective","","nz-button","",3,"action","nzType","click"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(o,i){1&o&&(e.YNc(0,K,8,8,"div",0),e.YNc(1,a,1,1,"nz-spin",1)),2&o&&(e.Q6J("ngIf",!i.loadingIndicator),e.xp6(1),e.Q6J("ngIf",i.loadingIndicator))},dependencies:[x.u,r.UX,r._Y,r.JL,r.sg,h.X0,h.T7,v.sL,v.ix,S.w,N.dQ,I.O5,Z,T.j,T.W,L.E],encapsulation:2})}return n})();function d(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.handlerSave(i))}),e._uU(2," Submit "),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.handlerCancel(i))}),e._uU(4," Cancel "),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("action","edit")("nzLoading",t.isLoading)("nzType","primary"),e.xp6(2),e.Q6J("action","edit")}}function p(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleDisabled())}),e._uU(2," Edit "),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("action","edit")("nzType","primary"))}function g(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-history",13),2&n){const t=e.oxw(2);e.Q6J("product",t.model)}}function U(n,c){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4),e._UZ(3,"formly-form",5),e.TgZ(4,"div",6),e.YNc(5,d,5,4,"div",7),e.YNc(6,p,3,2,"div",7),e.qZA()()(),e.YNc(7,g,1,1,"icom-libs-product-detail-history",8),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled)),e.xp6(1),e.Q6J("ngIf",null==t.options||null==t.options.formState?null:t.options.formState.disabled),e.xp6(1),e.Q6J("ngIf",null==t.model?null:t.model.id)}}function E(n,c){1&n&&e._UZ(0,"nz-spin",14),2&n&&e.Q6J("nzSize","large")}let X=(()=>{class n{constructor(){this.form=new r.cw({}),this.fields=[],this.options={formState:{disabled:!0}},this.productService=(0,e.f3M)(u.k),this.IComMessageService=(0,e.f3M)(w.Q),this.changeDetectorRef=(0,e.f3M)(e.sBO),this.model={},this.fields=[{key:"voucher_type",type:"select-custom",templateOptions:{label:"Voucher Type",placeholder:"Select Voucher Type",classInclude:"w-[300px]",viewValue:"name",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("VOUCHER_TYPE").pipe((0,D.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"voucher_value",type:"input",className:"",expressions:{"props.disabled":"formState.disabled"},props:{label:"Voucher Value",type:"number",min:0}},{key:"expiry_policy",className:"basis-4/12",type:"select-custom",props:{placeholder:"Select Expiry policy",label:"Expiry policy",viewValue:"name",classInclude:"w-[300px]",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("VOUCHER_PROPERTY_EXPIRY_POLICY").pipe((0,D.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"expiry_date",type:"date",props:{label:"Expiry date",ShowTime:!0,required:!0,format:"dd-MM-yyyy HH:mm"},expressions:{"props.disabled":"formState.disabled"},hideExpression:t=>!t?.expiry_policy||"EXPIRY_DATE_FP"!==t?.expiry_policy},{key:"expiry_param",type:"input",className:"basis-6/12 ml-4",props:{label:"Expiry param",required:!0,type:"number"},hideExpression:t=>!t?.expiry_policy||"EXPIRY_DATE_NE"===t?.expiry_policy||"EXPIRY_DATE_SDED"===t?.expiry_policy||"EXPIRY_DATE_FP"===t?.expiry_policy,expressions:{"props.disabled":"formState.disabled"}}]}ngOnInit(){var t=this;return(0,_.Z)(function*(){try{t.loadingIndicator=!0,t.model=yield(0,f.n)(t.productService.getProductProperties(t.product?.id)),t.modelOrigin=(0,M.cloneDeep)(t.model)}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message)}finally{t.loadingIndicator=!1,t.changeDetectorRef.detectChanges()}})()}handlerSave(t){var o=this;return(0,_.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(l=>{o.form.controls[l].touched=!0});o.form.markAsTouched(),o.form.submitted=!0;const i={...o.model};if(o.isLoading=!0,o.changeDetectorRef.detectChanges(),i.id)return yield(0,f.n)(o.productService.updateProductProperties(i)),o.toggleDisabled(),o.IComMessageService.showAlertMessageDone("Edit product properties success"),o.isLoading=!1,void o.changeDetectorRef.detectChanges();delete i.id,yield(0,f.n)(o.productService.createProductProperties(i)),o.isLoading=!1,o.changeDetectorRef.detectChanges(),o.IComMessageService.showAlertMessageDone("Add product properties success")}catch(i){o.IComMessageService.showAlertMessageError(i?.error?.error_message)}finally{o.isLoading=!1,o.changeDetectorRef.detectChanges()}})()}handlerCancel(t){t.stopPropagation(),t.preventDefault(),this.toggleDisabled(),this.form.reset(this.modelOrigin)}toggleDisabled(){this.options.formState.disabled=!this.options.formState.disabled}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-properties"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","pt-4","bg-white","border","rounded-md"],["nz-form","",3,"formGroup"],[3,"model","fields","options","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],["nz-col","",1,"search-area","flex"],["icomLibsHasPermissionDirective","","nz-button","",3,"action","nzLoading","nzType","click"],["icomLibsHasPermissionDirective","","nz-button","",1,"ml-4",3,"action","click"],["icomLibsHasPermissionDirective","","nz-button","",3,"action","nzType","click"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(o,i){1&o&&(e.YNc(0,U,8,8,"div",0),e.YNc(1,E,1,1,"nz-spin",1)),2&o&&(e.Q6J("ngIf",!i.loadingIndicator),e.xp6(1),e.Q6J("ngIf",i.loadingIndicator))},dependencies:[x.u,r.UX,r._Y,r.JL,r.sg,h.X0,h.T7,v.sL,v.ix,S.w,N.dQ,I.O5,Z,T.j,T.W,L.E],encapsulation:2})}return n})();const oe=(n,c)=>[{prop:"",cellTemplate:n,sortable:!1,width:40},{prop:"",cellTemplate:c,sortable:!1,width:40},{prop:"language",width:200,sortable:!1},{prop:"name",width:300,sortable:!1},{prop:"description",width:300,sortable:!1}];var V=s(9404),W=s(4447);const ie=["statusRef"],re=["removeRef"];function ae(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.handlerAdd())}),e._uU(2," Add New "),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("nzType","primary")("action","edit"))}function se(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"button",18),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(3);return e.KtG(l.handlerSave(i))}),e._uU(2," Save "),e.qZA(),e.TgZ(3,"button",19),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.handlerCancel())}),e._uU(4," Cancel "),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("nzType","primary")("nzLoading",t.isLoading)("action","edit"),e.xp6(2),e.Q6J("action","edit")}}function le(n,c){if(1&n&&(e.ynx(0),e.TgZ(1,"form",12,13),e._UZ(3,"formly-form",14),e.qZA(),e.TgZ(4,"div",15),e.YNc(5,se,5,4,"div",16),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("model",t.modelForm)("fields",t.fields)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled))}}const ce=function(){return[]};function de(n,c){if(1&n&&(e.TgZ(0,"div",20),e._UZ(1,"ngx-datatable",21),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("rows",t.rows)("columns",t.configTable.columns||e.DdM(7,ce))("headerHeight",t.configTable.headerHeight||50)("columnMode","standard")("rowHeight",t.configTable.rowHeight||50)("scrollbarH",!0)("loadingIndicator",t.loadingIndicator)}}function pe(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-history",22),2&n){const t=e.oxw(2);e.Q6J("product",t.modelForm)}}function ue(n,c){if(1&n&&(e.TgZ(0,"div",4)(1,"div",5),e.YNc(2,ae,3,2,"div",6),e.YNc(3,le,6,5,"ng-container",7),e.YNc(4,de,2,8,"div",8),e.qZA(),e.YNc(5,pe,1,1,"icom-libs-product-detail-history",9),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",t.isAddNew),e.xp6(1),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",null==t.modelForm?null:t.modelForm.id)}}function me(n,c){1&n&&e._UZ(0,"nz-spin",23),2&n&&e.Q6J("nzSize","large")}function fe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(i){const y=e.CHM(t).row,H=e.oxw();return e.KtG(H.handlerEdit(i,y))}),e._UZ(1,"i",25),e.qZA()}2&n&&(e.xp6(1),e.Q6J("action","edit"))}function _e(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",26),e.NdJ("click",function(i){const y=e.CHM(t).row,H=e.oxw();return e.KtG(H.handlerRemove(i,y))}),e._UZ(1,"span",27),e.qZA()}2&n&&e.Q6J("action","edit")}let ge=(()=>{class n{constructor(t){this.router=t,this.form=new r.cw({}),this.options={},this.fields=[],this.productService=(0,e.f3M)(u.k),this.modalService=(0,e.f3M)(V.Sf),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.modelForm={}}ngOnInit(){this.fields=[{key:"name",type:"input",props:{label:"Name",placeholder:"Enter Name",type:"string",required:!0}},{key:"description",type:"input",props:{label:"Description",placeholder:"Enter Description",type:"string",required:!0}},{key:"language",type:"select-custom",templateOptions:{label:"Language",placeholder:"Select Language",viewValue:"name",labelProp:"name",required:!0,valueProp:"code",options:[{code:"vi",name:"Vietnamese"},{code:"en",name:"English"}]}},{key:"detail",type:"quill-editor",props:{label:"Detail",placeholder:"Enter Content",type:"string",required:!0}},{key:"term_and_condition",type:"quill-editor",props:{label:"Term and condition",placeholder:"Enter Content",type:"string",required:!0}}],this.configTable={loadingIndicator:!0,columns:oe(this.statusRef,this.removeRef),headerHeight:50,rowHeight:"auto",pageLimit:10},this.loadPage()}loadPage(){var t=this;return(0,_.Z)(function*(){try{t.loadingIndicator=!0;const o=yield(0,f.n)(t.productService.getProductLanguage(t.product?.id||""));if(o&&o.data&&o.data){const i=[...o.data.items||[]];t.rows=i}}catch(o){console.log(o)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerAdd(){this.isAddNew=!this.isAddNew}handlerCancel(){this.isAddNew=!1,this.modelForm={}}handlerSave(t){var o=this;return(0,_.Z)(function*(){t.stopPropagation(),t.preventDefault();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(l=>{o.form.controls[l].touched=!0});o.form.markAsTouched(),o.form.submitted=!0;const i={product_id:o.product?.id,...o.modelForm};if(o.isLoading=!0,o.cdr.detectChanges(),!i.id)return delete i.id,o.rows?.some(y=>y.language==i.language)?void o.IComMessageService.showAlertMessageError("Record exist in table"):void o.productService.addLanguageProduct(i).subscribe(()=>{o.IComMessageService.showAlertMessageDone("Add language success"),o.handlerCancel(),o.loadPage()});yield(0,f.n)(o.productService.updateLanguageProduct(o.modelForm)),o.IComMessageService.showAlertMessageDone("Edit language success"),o.handlerCancel(),o.loadPage()}catch(i){o.IComMessageService.showAlertMessageError(i?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}})()}handlerEdit(t,o){t.stopPropagation(),this.modelForm=o,this.isAddNew=!0}handlerRemove(t,o){t.stopPropagation(),this.modalService.confirm({nzTitle:"Are you sure delete this product?",nzContent:`<b style="color: red;">${o.name}</b>`,nzOkText:"Delete",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDelete.bind(this,o),nzCancelText:"Cancel"},"error")}processDelete(t){return(0,f.n)(this.productService.deleteProductLanguage(t.id||"")).then(()=>{this.IComMessageService.showAlertMessageDone("Delete language success"),this.loadPage()}).catch(o=>{this.IComMessageService.showAlertMessageError(o?.error?.error_message)})}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(W.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-language"]],viewQuery:function(o,i){if(1&o&&(e.Gf(ie,7),e.Gf(re,7)),2&o){let l;e.iGM(l=e.CRH())&&(i.statusRef=l.first),e.iGM(l=e.CRH())&&(i.removeRef=l.first)}},inputs:{fields:"fields",rows:"rows",product:"product"},standalone:!0,features:[e.jDz],decls:6,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],["statusRef",""],["removeRef",""],[1,"w-full","h-full","flex"],[1,"mb-4","w-full","h-full","flex","flex-col","bg-white","border","rounded-md"],["class","flex justify-end p-4",4,"ngIf"],[4,"ngIf"],["class","w-full h-full",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],[1,"flex","justify-end","p-4"],["nz-button","","icomLibsHasPermissionDirective","",1,"flex","items-center",3,"nzType","action","click"],[1,"overflow-auto","px-4","pt-4",3,"formGroup"],["myForm",""],[3,"model","fields","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["nz-col","",1,"search-area","flex"],["nz-button","","icomLibsHasPermissionDirective","",3,"nzType","nzLoading","action","click"],["nz-button","","icomLibsHasPermissionDirective","",1,"ml-4",3,"action","click"],[1,"w-full","h-full"],[1,"material","expandable","striped","w-full","h-full",3,"rows","columns","headerHeight","columnMode","rowHeight","scrollbarH","loadingIndicator"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"],[1,"name-container","cursor-pointer",3,"click"],["nz-icon","","nzType","edit","nzTheme","twotone","icomLibsHasPermissionDirective","",1,"cursor-pointer",3,"action"],["icomLibsHasPermissionDirective","",1,"name-container","cursor-pointer",3,"action","click"],["nz-icon","","nzType","delete","nzTheme","twotone"]],template:function(o,i){1&o&&(e.YNc(0,ue,6,4,"div",0),e.YNc(1,me,1,1,"nz-spin",1),e.YNc(2,fe,2,1,"ng-template",null,2,e.W1O),e.YNc(4,_e,2,1,"ng-template",null,3,e.W1O)),2&o&&(e.Q6J("ngIf",!i.loadingIndicator),e.xp6(1),e.Q6J("ngIf",i.loadingIndicator))},dependencies:[x.u,r.UX,r._Y,r.JL,r.sg,h.X0,h.T7,v.sL,v.ix,S.w,N.dQ,P.xD,P.nE,I.O5,b.PV,b.Ls,Z,T.j,T.W,L.E],encapsulation:2})}return n})();var he=s(2235);const ve=(n,c,t)=>[{prop:"",cellTemplate:n,sortable:!1,width:40},{prop:"",cellTemplate:c,sortable:!1,width:40},{prop:"banner",sortable:!1,cellTemplate:t,width:200},{prop:"name",sortable:!1,width:300},{prop:"type",sortable:!1,width:300}];var te=s(5843),ze=s(7554);const ye=["statusRef"],xe=["removeRef"],Te=["avatarRef"];function Ie(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.handlerAdd())}),e._uU(2,"Add New "),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("action","edit")("nzType","primary"))}function Pe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"nz-upload",21),e.NdJ("nzFileListChange",function(i){e.CHM(t);const l=e.oxw(3);return e.KtG(l.fileList=i)}),e.ynx(1),e.TgZ(2,"p",22),e._UZ(3,"span",23),e.qZA(),e.TgZ(4,"p",24),e._uU(5,"Upload Image"),e.qZA(),e.TgZ(6,"p",25),e._uU(7,"Size can't exceed 2 MB"),e.qZA(),e.BQk(),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("nzMultiple",!1)("nzFileList",t.fileList)("nzBeforeUpload",t.beforeUpload)}}function De(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",26)(1,"button",27),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.handlerSave())}),e._uU(2," Save "),e.qZA(),e.TgZ(3,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.handlerCancel())}),e._UZ(4,"i",29),e._uU(5," Cancel "),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("nzLoading",t.isLoading)("nzType","primary")("action","edit"),e.xp6(2),e.Q6J("action","edit")}}function Ce(n,c){if(1&n&&(e.TgZ(0,"div",13)(1,"div",14)(2,"form",15,16),e._UZ(4,"formly-form",17),e.qZA()(),e.YNc(5,Pe,8,3,"nz-upload",18),e.TgZ(6,"div",19),e.YNc(7,De,6,4,"div",20),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("model",t.modelForm)("fields",t.fields)("form",t.form),e.xp6(1),e.Q6J("ngIf",t.isAddNew),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled))}}const we=function(){return[]};function Me(n,c){if(1&n&&(e.TgZ(0,"div",30),e._UZ(1,"ngx-datatable",31),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("rows",t.rows)("columns",t.configTable.columns||e.DdM(7,we))("headerHeight",t.configTable.headerHeight||50)("columnMode","standard")("rowHeight","auto")("scrollbarH",!0)("loadingIndicator",t.loadingIndicator)}}function Le(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-history",32),2&n){const t=e.oxw(2);e.Q6J("product",t.modelForm)}}function Se(n,c){if(1&n&&(e.TgZ(0,"div",5)(1,"div",6),e.YNc(2,Ie,3,2,"div",7),e.YNc(3,Ce,8,6,"div",8),e.YNc(4,Me,2,8,"div",9),e.qZA(),e.YNc(5,Le,1,1,"icom-libs-product-detail-history",10),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",t.isAddNew),e.xp6(1),e.Q6J("ngIf",!t.isAddNew),e.xp6(1),e.Q6J("ngIf",null==t.modelForm?null:t.modelForm.id)}}function Ae(n,c){1&n&&e._UZ(0,"nz-spin",33),2&n&&e.Q6J("nzSize","large")}function Ze(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",34),e.NdJ("click",function(i){const y=e.CHM(t).row,H=e.oxw();return e.KtG(H.handlerEdit(i,y))}),e._UZ(1,"i",35),e.qZA()}2&n&&e.Q6J("action","edit")}function Ne(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",34),e.NdJ("click",function(i){const y=e.CHM(t).row,H=e.oxw();return e.KtG(H.handlerRemove(i,y))}),e._UZ(1,"span",36),e.qZA()}2&n&&e.Q6J("action","edit")}function Ee(n,c){if(1&n&&(e.TgZ(0,"div",37),e._UZ(1,"img",38),e.qZA()),2&n){const t=c.row;e.xp6(1),e.Q6J("src",t.url,e.LSH)}}let He=(()=>{class n{constructor(t){this.msg=t,this.form=new r.cw({}),this.options={},this.fileList=[],this.fields=[],this.productService=(0,e.f3M)(u.k),this.modalService=(0,e.f3M)(V.Sf),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.beforeUpload=o=>new he.y(i=>{const l="image/jpeg"===o.type||"image/png"===o.type;if(!l)return this.msg.error("You can only upload JPG file!"),void i.complete();const y=(o?.size||1)/1024/1024<2;return y?this.fileList&&this.fileList.length?(this.msg.error("Only Post One File"),void i.complete()):(i.next(l&&y),void i.complete()):(this.msg.error("Image must smaller than 2MB!"),void i.complete())}),this.modelForm={}}ngOnInit(){this.fields=(n=>[{key:"name",type:"input",props:{label:"Name",placeholder:"Enter Name",type:"string",required:!0}},{key:"type",type:"select-custom",templateOptions:{label:"Type",placeholder:"Select Type",viewValue:"name",labelProp:"name",required:!0,valueProp:"code",classInclude:"w-[300px]",options:this.productService.getOptionType("MEDIA_TYPE").pipe((0,D.U)(c=>c?.data))}}])(),this.configTable={loadingIndicator:!0,columns:ve(this.statusRef,this.removeRef,this.avatarRef),headerHeight:50,rowHeight:"auto",pageLimit:10},this.loadPage()}loadPage(){var t=this;return(0,_.Z)(function*(){try{t.loadingIndicator=!0;const o=yield(0,f.n)(t.productService.getProductMedia(t.product?.id||""));if(o&&o.data&&o.data){const i=[...o.data.items||[]];t.rows=i}}catch(o){console.log(o)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerAdd(){this.isAddNew=!this.isAddNew,this.modelForm={},this.cdr.detectChanges()}handlerCancel(){this.isAddNew=!1,this.modelForm={},this.fileList=[],this.cdr.detectChanges()}handlerSave(){var t=this;return(0,_.Z)(function*(){try{if(!t.form.valid)return void Object.keys(t.form.controls).forEach(o=>{t.form.controls[o].touched=!0});t.form.markAsTouched(),t.form.submitted=!0,t.processUpload()}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message||"Upload Media Failed")}finally{t.isLoading=!1,t.cdr.detectChanges()}})()}processUpload(){var t=this;return(0,_.Z)(function*(){const o=new FormData;t.fileList[0]?.originFileObj&&o.append("image",t.fileList[0].originFileObj);const i={product_id:t.product?.id,...t.modelForm};t.isLoading=!0,t.cdr.detectChanges();let l=null;try{if(t.fileList[0]?.originFileObj&&(l=yield(0,f.n)(t.productService.uploadMediaProduct(o))),!i.id)return delete i.id,i.url=l.data?.path||"",yield(0,f.n)(t.productService.addMediaProduct(i)),t.IComMessageService.showAlertMessageDone("Add media success"),t.handlerCancel(),void t.loadPage();i.url=l?.data?.path||i?.url,yield(0,f.n)(t.productService.updateMediaProduct(i)),t.IComMessageService.showAlertMessageDone("Edit media success"),t.handlerCancel(),t.loadPage()}catch(y){t.IComMessageService.showAlertMessageError(y?.error?.error_message||"Upload media fail")}})()}handlerEdit(t,o){t.stopPropagation(),this.modelForm=o,this.fileList=[{uid:"-1",name:"Img",status:"done",url:this.modelForm.url,thumbUrl:this.modelForm.url}],this.isAddNew=!0,this.cdr.detectChanges()}handlerRemove(t,o){t.stopPropagation(),this.modalService.confirm({nzTitle:"Are you sure delete this media?",nzContent:`<b style="color: red;">${o.name}</b>`,nzOkText:"Delete",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDelete.bind(this,o),nzCancelText:"Cancel"},"error")}processDelete(t){return(0,f.n)(this.productService.deleteProductMedia(t.id||"")).then(()=>{this.IComMessageService.showAlertMessageDone("Delete media success"),this.loadPage()}).catch(o=>{this.IComMessageService.showAlertMessageError(o?.error?.error_message||"Delete Fail")})}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(ze.dD))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-media"]],viewQuery:function(o,i){if(1&o&&(e.Gf(ye,7),e.Gf(xe,7),e.Gf(Te,7)),2&o){let l;e.iGM(l=e.CRH())&&(i.statusRef=l.first),e.iGM(l=e.CRH())&&(i.removeRef=l.first),e.iGM(l=e.CRH())&&(i.avatarRef=l.first)}},inputs:{fields:"fields",rows:"rows",product:"product"},standalone:!0,features:[e.jDz],decls:8,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],["statusRef",""],["removeRef",""],["avatarRef",""],[1,"w-full","h-full","flex"],[1,"mb-4","w-full","h-full","flex","flex-col","pr-4","pt-4","bg-white","border","rounded-md","overflow-hidden"],["class","flex flex-end pl-4",4,"ngIf"],["class","flex w-full h-full flex-col",4,"ngIf"],["class","w-full h-full mt-4",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],[1,"flex","flex-end","pl-4"],["icomLibsHasPermissionDirective","","nz-button","",1,"!flex","!items-center",3,"action","nzType","click"],[1,"flex","w-full","h-full","flex-col"],[1,""],[1,"mt-4",3,"formGroup"],["myForm",""],[3,"model","fields","form"],["class","ml-4 h-full basis-1/2 upload-list-inline flex flex-col","nzType","drag","nzListType","picture",3,"nzMultiple","nzFileList","nzBeforeUpload","nzFileListChange",4,"ngIf"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["nzType","drag","nzListType","picture",1,"ml-4","h-full","basis-1/2","upload-list-inline","flex","flex-col",3,"nzMultiple","nzFileList","nzBeforeUpload","nzFileListChange"],[1,"ant-upload-drag-icon"],["nz-icon","","nzType","inbox"],[1,"ant-upload-text"],[1,"ant-upload-hint"],["nz-col","",1,"search-area","flex"],["nz-button","","icomLibsHasPermissionDirective","",1,"!flex","!items-center",3,"nzLoading","nzType","action","click"],["nz-button","","icomLibsHasPermissionDirective","",1,"ml-4","!flex","!items-center",3,"action","click"],["nz-icon","","nzTheme","outline","nzType","close-circle"],[1,"w-full","h-full","mt-4"],[1,"material","expandable","striped","w-full","h-full",3,"rows","columns","headerHeight","columnMode","rowHeight","scrollbarH","loadingIndicator"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"],["icomLibsHasPermissionDirective","",1,"name-container","cursor-pointer",3,"action","click"],["nz-icon","","nzType","edit","nzTheme","twotone",1,"cursor-pointer"],["nz-icon","","nzType","delete","nzTheme","twotone"],[1,"name-container","cursor-pointer"],["width","200","height","100",3,"src"]],template:function(o,i){1&o&&(e.YNc(0,Se,6,4,"div",0),e.YNc(1,Ae,1,1,"nz-spin",1),e.YNc(2,Ze,2,1,"ng-template",null,2,e.W1O),e.YNc(4,Ne,2,1,"ng-template",null,3,e.W1O),e.YNc(6,Ee,2,1,"ng-template",null,4,e.W1O)),2&o&&(e.Q6J("ngIf",!i.loadingIndicator),e.xp6(1),e.Q6J("ngIf",i.loadingIndicator))},dependencies:[x.u,r.UX,r._Y,r.JL,r.sg,h.X0,h.T7,v.sL,v.ix,S.w,N.dQ,P.xD,P.nE,I.O5,b.PV,b.Ls,te.cS,te.FY,Z,T.j,T.W,L.E],encapsulation:2})}return n})();const Qe=["statusRef"],Ue=["removeRef"];function ke(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",6),e._UZ(1,"formly-form",7),e.TgZ(2,"div",8)(3,"div",9)(4,"button",10),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.handlerSave(i))}),e._uU(5," Submit "),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(3),e.Q6J("nzType","primary")("nzLoading",t.isLoading)}}const Ye=function(){return[]};let Fe=(()=>{class n{constructor(t){this.router=t,this.form=new r.cw({}),this.options={},this.fields=[],this.productService=(0,e.f3M)(u.k),this.iComLibsServicesInventoryService=(0,e.f3M)(u.NH),this.modalService=(0,e.f3M)(V.Sf),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.model={}}ngOnInit(){this.fields=(n=>[{key:"inventory_id",type:"select-custom",templateOptions:{label:"Inventory",placeholder:"Select Inventory",viewValue:"name",labelProp:"name",required:!0,valueProp:"id",options:this.iComLibsServicesInventoryService.searchInventory().pipe((0,D.U)(c=>c?.data?.items))}}])(),this.configTable={loadingIndicator:!0,columns:[{prop:"name",sortable:!1},{prop:"type",sortable:!1},{prop:"sold_stock",sortable:!1,name:"Quantity Sold"},{prop:"in_stock",sortable:!1,name:"Quantity Available"},{prop:"total_stock",sortable:!1,name:"Quantity Total"}],headerHeight:50,rowHeight:"auto",pageLimit:10},this.loadPage()}loadPage(){var t=this;return(0,_.Z)(function*(){try{t.loadingIndicator=!0;const o=yield(0,f.n)(t.productService.getProductInventories(t.product?.id||""));if(o&&o.data&&o.data){const i=[...o.data.items||[]];t.rows=i}}catch(o){console.log(o)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerClickAddProductToInventory(){this.isAddNew=!this.isAddNew}handlerCancel(){this.isAddNew=!1,this.model={}}handlerSave(t){var o=this;return(0,_.Z)(function*(){t.stopPropagation();try{if(!o.form.valid)return void Object.keys(o.form.controls).forEach(l=>{o.form.controls[l].touched=!0});o.form.markAsTouched(),o.form.submitted=!0,o.isLoading=!0;const i={...o.model,product_id:o.product?.id};yield(0,f.n)(o.productService.getInventoryProducts(i)),o.IComMessageService.showAlertMessageDone("Add product to inventory success"),o.handlerCancel(),o.loadPage()}catch(i){o.IComMessageService.showAlertMessageError(i?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(W.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-inventory"]],viewQuery:function(o,i){if(1&o&&(e.Gf(Qe,7),e.Gf(Ue,7)),2&o){let l;e.iGM(l=e.CRH())&&(i.statusRef=l.first),e.iGM(l=e.CRH())&&(i.removeRef=l.first)}},inputs:{fields:"fields",rows:"rows",product:"product"},standalone:!0,features:[e.jDz],decls:7,vars:10,consts:[[1,"mb-4","w-full","h-full","flex","flex-col","!p-4","bg-white","border","rounded-md"],[1,""],["nz-button","",1,"!flex","!items-center",3,"nzType","click"],["class","w-full mt-4 bg-white ",4,"ngIf"],[1,"w-full","h-full","mt-4"],[1,"material","expandable","striped","w-full","h-full",3,"rows","columns","headerHeight","columnMode","rowHeight","scrollbarH","loadingIndicator"],[1,"w-full","mt-4","bg-white"],[3,"model","fields","options","form"],["nz-row",""],["nz-col","",1,"search-area","flex"],["nz-button","",3,"nzType","nzLoading","click"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return i.handlerClickAddProductToInventory()}),e._uU(3," Add Product To Inventory "),e.qZA()(),e.YNc(4,ke,6,6,"div",3),e.TgZ(5,"div",4),e._UZ(6,"ngx-datatable",5),e.qZA()()),2&o&&(e.xp6(2),e.Q6J("nzType","primary"),e.xp6(2),e.Q6J("ngIf",i.isAddNew),e.xp6(2),e.Q6J("rows",i.rows)("columns",i.configTable.columns||e.DdM(9,Ye))("headerHeight",i.configTable.headerHeight||50)("columnMode","force")("rowHeight",i.configTable.rowHeight||50)("scrollbarH",!0)("loadingIndicator",i.loadingIndicator))},dependencies:[x.u,r.UX,h.X0,h.T7,v.sL,v.ix,S.w,N.dQ,P.xD,P.nE,I.O5,b.PV],encapsulation:2,changeDetection:0})}return n})();var Re=s(8111);function Ge(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",10),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.handlerSave(i))}),e._uU(2," Submit "),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(i){e.CHM(t);const l=e.oxw(2);return e.KtG(l.handlerCancel(i))}),e._uU(4," Cancel "),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("nzType","primary")("nzLoading",t.isLoading)("action","edit"),e.xp6(2),e.Q6J("action","edit")}}function Be(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",9)(1,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleDisabled())}),e._uU(2," Edit "),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("nzType","primary")("action","edit"))}function je(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-history",13),2&n){const t=e.oxw(2);e.Q6J("product",t.model)}}function qe(n,c){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4),e._UZ(3,"formly-form",5),e.TgZ(4,"div",6),e.YNc(5,Ge,5,4,"div",7),e.YNc(6,Be,3,2,"div",7),e.qZA()()(),e.YNc(7,je,1,1,"icom-libs-product-detail-history",8),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("model",t.model)("fields",t.fields)("options",t.options)("form",t.form),e.xp6(2),e.Q6J("ngIf",!(null!=t.options&&null!=t.options.formState&&t.options.formState.disabled)),e.xp6(1),e.Q6J("ngIf",null==t.options||null==t.options.formState?null:t.options.formState.disabled),e.xp6(1),e.Q6J("ngIf",null==t.model?null:t.model.id)}}function Ke(n,c){1&n&&e._UZ(0,"nz-spin",14),2&n&&e.Q6J("nzSize","large")}let Xe=(()=>{class n{constructor(){this.form=new r.cw({}),this.options={formState:{disabled:!0}},this.fields=[],this.productService=(0,e.f3M)(u.k),this.IComMessageService=(0,e.f3M)(w.Q),this.cdr=(0,e.f3M)(e.sBO),this.model={},this.fields=[{validators:{validation:[{name:"fieldMatch",options:{errorPath:"value"}}]},fieldGroup:[{key:"type",type:"select-custom",props:{label:"Payment Type",placeholder:"Select Type",viewValue:"name",classInclude:"w-[300px]",labelProp:"name",valueProp:"code",required:!0,options:this.productService.getOptionType("PRODUCT_DISCOUNT_TYPE").pipe((0,D.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}}]},{key:"value",type:"input",className:"",props:{label:"Value",required:!0,type:"number"},expressions:{"props.disabled":"formState.disabled"}},{key:"status",className:"basis-4/12",type:"Status",props:{placeholder:"Select Status",label:"Pool",viewValue:"name",labelProp:"name",valueProp:"id",required:!0,options:this.productService.getOptionType("PRODUCT_DISCOUNT_STATUS").pipe((0,D.U)(t=>t?.data))},expressions:{"props.disabled":"formState.disabled"}},{key:"date_range",type:"icom-range-picker",props:{required:!0,className:"mt-4",label:"Valid",nzShowTime:!0,format:"dd-MM-yyyy HH:mm"},expressions:{"props.disabled":"formState.disabled"}},{key:"minimum_order_value",type:"input",className:"",props:{label:"Minimum order value",required:!0,type:"number"},expressions:{"props.disabled":"formState.disabled"}},{key:"maximum_discount_amount",type:"input",className:"",props:{label:"Maximum discount amount",required:!0,type:"number"},expressions:{"props.disabled":"formState.disabled"}}]}ngOnInit(){var t=this;return(0,_.Z)(function*(){try{if(t.loadingIndicator=!0,t.cdr.detectChanges(),t.model=yield(0,f.n)(t.productService.getProductDiscount(t.product?.id)),t.modelOrigin=(0,M.cloneDeep)(t.model),!t.model.valid_from||!t.model.valid_until)return;t.model.date_range=[A(t.model.valid_from).toDate(),A(t.model.valid_until).toDate()]}catch(o){t.IComMessageService.showAlertMessageError(o?.error?.error_message)}finally{t.loadingIndicator=!1,t.cdr.detectChanges()}})()}handlerSave(t){var o=this;return(0,_.Z)(function*(){if(t.stopPropagation(),t.preventDefault(),o.form.valid)try{o.form.markAsTouched(),o.form.submitted=!0;const i={...o.model};if(o.isLoading=!0,o.cdr.detectChanges(),(0,Re.NT)(i,"valid_from,valid_until"),i.id)return yield(0,f.n)(o.productService.updateProductDiscount(i)),o.IComMessageService.showAlertMessageDone("Edit product discount success"),void o.toggleDisabled();delete i.id,yield(0,f.n)(o.productService.createProductDiscount(i)),o.IComMessageService.showAlertMessageError("Edit product discount success")}catch(i){o.IComMessageService.showAlertMessageError(i?.error?.error_message)}finally{o.isLoading=!1,o.cdr.detectChanges()}else Object.keys(o.form.controls).forEach(i=>{o.form.controls[i].touched=!0})})()}handlerCancel(t){t.stopPropagation(),t.preventDefault(),this.toggleDisabled(),this.form.reset(this.modelOrigin)}toggleDisabled(){this.options.formState.disabled=!this.options.formState.disabled}static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail-discount"]],inputs:{product:"product"},standalone:!0,features:[e.jDz],decls:2,vars:2,consts:[["class","w-full h-full flex",4,"ngIf"],["class","w-full h-full flex justify-center items-center","nzSimple","",3,"nzSize",4,"ngIf"],[1,"w-full","h-full","flex"],[1,"flex","w-full","h-full","flex-col","pt-4","bg-white","border","rounded-md"],["nz-form","",3,"formGroup"],[3,"model","fields","options","form"],["nz-row","",1,"p-4","border"],["nz-col","","class","search-area flex",4,"ngIf"],["class","ml-4",3,"product",4,"ngIf"],["nz-col","",1,"search-area","flex"],["nz-button","","icomLibsHasPermissionDirective","",3,"nzType","nzLoading","action","click"],["nz-button","","icomLibsHasPermissionDirective","",1,"ml-4",3,"action","click"],["nz-button","","icomLibsHasPermissionDirective","",3,"nzType","action","click"],[1,"ml-4",3,"product"],["nzSimple","",1,"w-full","h-full","flex","justify-center","items-center",3,"nzSize"]],template:function(o,i){1&o&&(e.YNc(0,qe,8,8,"div",0),e.YNc(1,Ke,1,1,"nz-spin",1)),2&o&&(e.Q6J("ngIf",!i.loadingIndicator),e.xp6(1),e.Q6J("ngIf",i.loadingIndicator))},dependencies:[x.u,r.UX,r._Y,r.JL,r.sg,h.X0,h.T7,v.sL,v.ix,S.w,N.dQ,I.O5,Z,T.j,T.W,L.E],encapsulation:2})}return n})();var Ve=s(4629);function We(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-general",14),2&n){const t=e.oxw(2);e.Q6J("product",t.productTemp)}}function $e(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-language",14),2&n){const t=e.oxw(2);e.Q6J("product",t.product)}}function et(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-price",14),2&n){const t=e.oxw(2);e.Q6J("product",t.product)}}function tt(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-properties",14),2&n){const t=e.oxw(2);e.Q6J("product",t.product)}}function ot(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-media",14),2&n){const t=e.oxw(2);e.Q6J("product",t.product)}}function nt(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-inventory",14),2&n){const t=e.oxw(2);e.Q6J("product",t.product)}}function it(n,c){if(1&n&&e._UZ(0,"icom-libs-inventory-items-list",15),2&n){const t=e.oxw(2);e.Q6J("inventoryId",-1)("productId",t.product.id||0)}}function rt(n,c){if(1&n&&e._UZ(0,"icom-libs-product-detail-discount",14),2&n){const t=e.oxw(2);e.Q6J("product",t.product)}}function at(n,c){1&n&&(e.TgZ(0,"nz-page-header-footer",2)(1,"div",3)(2,"nz-tabset",4)(3,"nz-tab",5),e.YNc(4,We,1,1,"ng-template",6),e.qZA(),e.TgZ(5,"nz-tab",7),e.YNc(6,$e,1,1,"ng-template",6),e.qZA(),e.TgZ(7,"nz-tab",8),e.YNc(8,et,1,1,"ng-template",6),e.qZA(),e.TgZ(9,"nz-tab",9),e.YNc(10,tt,1,1,"ng-template",6),e.qZA(),e.TgZ(11,"nz-tab",10),e.YNc(12,ot,1,1,"ng-template",6),e.qZA(),e.TgZ(13,"nz-tab",11),e.YNc(14,nt,1,1,"ng-template",6),e.qZA(),e.TgZ(15,"nz-tab",12),e.YNc(16,it,1,2,"ng-template",6),e.qZA(),e.TgZ(17,"nz-tab",13),e.YNc(18,rt,1,1,"ng-template",6),e.qZA()()()()),2&n&&(e.xp6(2),e.Q6J("nzSelectedIndex",0))}let st=(()=>{class n{constructor(t){this.routeActive=t,this.productService=(0,e.f3M)(u.k),this.cdr=(0,e.f3M)(e.sBO),this.productId=this.routeActive.snapshot.params.id}ngOnInit(){var t=this;return(0,_.Z)(function*(){try{t.product=yield(0,f.n)(t.productService.getProduct(t.productId)),t.productTemp=(0,M.cloneDeep)(t.product),t.cdr.detectChanges()}catch(o){console.log(o)}})()}static#e=this.\u0275fac=function(o){return new(o||n)(e.Y36(W.gz))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["icom-libs-product-detail"]],standalone:!0,features:[e.jDz],decls:4,vars:2,consts:[["nzBackIcon","",1,"site-page-header","h-full","w-full","flex","flex-col"],["class","w-full h-full overflow-auto",4,"ngIf"],[1,"w-full","h-full","overflow-auto"],[1,"w-full","h-full"],[3,"nzSelectedIndex"],["nzTitle","General"],["nz-tab",""],["nzTitle","Languages"],["nzTitle","Price"],["nzTitle","Properties"],["nzTitle","Media"],["nzTitle","Inventory"],["nzTitle","Inventory Items"],["nzTitle","Discounts"],[3,"product"],[3,"inventoryId","productId"]],template:function(o,i){1&o&&(e.TgZ(0,"nz-page-header",0)(1,"nz-page-header-title"),e._uU(2),e.qZA(),e.YNc(3,at,19,1,"nz-page-header-footer",1),e.qZA()),2&o&&(e.xp6(2),e.Oqu((null==i.product?null:i.product.name)||""),e.xp6(1),e.Q6J("ngIf",i.product&&i.product.id))},dependencies:[P.xD,x.u,r.UX,h.X0,v.sL,J.U5,Q.ZJ,m.KJ,m.$O,m.u9,m.$,k.zf,z.we,z.xH,z.xw,z.cj,b.PV,B,C,I.O5,X,ge,He,Fe,Xe,Ve.IcomLibInventoryListItemsComponent],encapsulation:2,changeDetection:0})}return n})()},7091:($,O,s)=>{s.d(O,{S:()=>Q,g:()=>I});var _=s(2321),e=s(1699),r=s(1636),h=s(6575),x=s(6672),P=s(4565);function v(m,k){if(1&m&&(e.ynx(0),e._uU(1),e.BQk()),2&m){const z=e.oxw(2);e.xp6(1),e.Oqu(z.nzText)}}function J(m,k){if(1&m&&(e.TgZ(0,"span",1),e.YNc(1,v,2,1,"ng-container",2),e.qZA()),2&m){const z=e.oxw();e.xp6(1),e.Q6J("nzStringTemplateOutlet",z.nzText)}}let I=(()=>{class m{constructor(){this.nzType="horizontal",this.nzOrientation="center",this.nzDashed=!1,this.nzPlain=!1}static#e=this.\u0275fac=function(b){return new(b||m)};static#t=this.\u0275cmp=e.Xpm({type:m,selectors:[["nz-divider"]],hostAttrs:[1,"ant-divider"],hostVars:16,hostBindings:function(b,u){2&b&&e.ekj("ant-divider-horizontal","horizontal"===u.nzType)("ant-divider-vertical","vertical"===u.nzType)("ant-divider-with-text",u.nzText)("ant-divider-plain",u.nzPlain)("ant-divider-with-text-left",u.nzText&&"left"===u.nzOrientation)("ant-divider-with-text-right",u.nzText&&"right"===u.nzOrientation)("ant-divider-with-text-center",u.nzText&&"center"===u.nzOrientation)("ant-divider-dashed",u.nzDashed)},inputs:{nzText:"nzText",nzType:"nzType",nzOrientation:"nzOrientation",nzDashed:"nzDashed",nzPlain:"nzPlain"},exportAs:["nzDivider"],decls:1,vars:1,consts:[["class","ant-divider-inner-text",4,"ngIf"],[1,"ant-divider-inner-text"],[4,"nzStringTemplateOutlet"]],template:function(b,u){1&b&&e.YNc(0,J,2,1,"span",0),2&b&&e.Q6J("ngIf",u.nzText)},dependencies:[h.O5,x.f],encapsulation:2,changeDetection:0})}return(0,_.gn)([(0,r.yF)()],m.prototype,"nzDashed",void 0),(0,_.gn)([(0,r.yF)()],m.prototype,"nzPlain",void 0),m})(),Q=(()=>{class m{static#e=this.\u0275fac=function(b){return new(b||m)};static#t=this.\u0275mod=e.oAB({type:m});static#o=this.\u0275inj=e.cJS({imports:[P.vT,h.ez,x.T]})}return m})()},1539:($,O,s)=>{s.d(O,{$:()=>L,$O:()=>q,Jp:()=>T,KJ:()=>K,u5:()=>D,u9:()=>w,yG:()=>M});var _=s(4565),e=s(6575),r=s(1699),h=s(6672),x=s(7090),P=s(2321),v=s(9877),J=s(274),I=s(9736),Q=s(9372),m=s(2384),k=s(5386);function z(a,C){if(1&a&&(r.ynx(0),r._UZ(1,"span",9),r.BQk()),2&a){const d=C.$implicit,p=r.oxw(2);r.xp6(1),r.Q6J("nzType",d||p.getBackIcon())}}function b(a,C){if(1&a){const d=r.EpF();r.TgZ(0,"div",6),r.NdJ("click",function(){r.CHM(d);const g=r.oxw();return r.KtG(g.onBack())}),r.TgZ(1,"div",7),r.YNc(2,z,2,1,"ng-container",8),r.qZA()()}if(2&a){const d=r.oxw();r.xp6(2),r.Q6J("nzStringTemplateOutlet",d.nzBackIcon)}}function u(a,C){if(1&a&&(r.ynx(0),r._uU(1),r.BQk()),2&a){const d=r.oxw(2);r.xp6(1),r.Oqu(d.nzTitle)}}function R(a,C){if(1&a&&(r.TgZ(0,"span",10),r.YNc(1,u,2,1,"ng-container",8),r.qZA()),2&a){const d=r.oxw();r.xp6(1),r.Q6J("nzStringTemplateOutlet",d.nzTitle)}}function A(a,C){1&a&&r.Hsn(0,6,["*ngIf","!nzTitle"])}function Y(a,C){if(1&a&&(r.ynx(0),r._uU(1),r.BQk()),2&a){const d=r.oxw(2);r.xp6(1),r.Oqu(d.nzSubtitle)}}function F(a,C){if(1&a&&(r.TgZ(0,"span",11),r.YNc(1,Y,2,1,"ng-container",8),r.qZA()),2&a){const d=r.oxw();r.xp6(1),r.Q6J("nzStringTemplateOutlet",d.nzSubtitle)}}function Z(a,C){1&a&&r.Hsn(0,7,["*ngIf","!nzSubtitle"])}const G=[[["nz-breadcrumb","nz-page-header-breadcrumb",""]],[["nz-avatar","nz-page-header-avatar",""]],[["nz-page-header-tags"],["","nz-page-header-tags",""]],[["nz-page-header-extra"],["","nz-page-header-extra",""]],[["nz-page-header-content"],["","nz-page-header-content",""]],[["nz-page-header-footer"],["","nz-page-header-footer",""]],[["nz-page-header-title"],["","nz-page-header-title",""]],[["nz-page-header-subtitle"],["","nz-page-header-subtitle",""]]],B=["nz-breadcrumb[nz-page-header-breadcrumb]","nz-avatar[nz-page-header-avatar]","nz-page-header-tags, [nz-page-header-tags]","nz-page-header-extra, [nz-page-header-extra]","nz-page-header-content, [nz-page-header-content]","nz-page-header-footer, [nz-page-header-footer]","nz-page-header-title, [nz-page-header-title]","nz-page-header-subtitle, [nz-page-header-subtitle]"];let w=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275dir=r.lG2({type:a,selectors:[["nz-page-header-title"],["","nz-page-header-title",""]],hostAttrs:[1,"ant-page-header-heading-title"],exportAs:["nzPageHeaderTitle"]})}return a})(),M=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275dir=r.lG2({type:a,selectors:[["nz-page-header-subtitle"],["","nz-page-header-subtitle",""]],hostAttrs:[1,"ant-page-header-heading-sub-title"],exportAs:["nzPageHeaderSubtitle"]})}return a})(),D=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275dir=r.lG2({type:a,selectors:[["nz-page-header-content"],["","nz-page-header-content",""]],hostAttrs:[1,"ant-page-header-content"],exportAs:["nzPageHeaderContent"]})}return a})(),T=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275dir=r.lG2({type:a,selectors:[["nz-page-header-extra"],["","nz-page-header-extra",""]],hostAttrs:[1,"ant-page-header-heading-extra"],exportAs:["nzPageHeaderExtra"]})}return a})(),L=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275dir=r.lG2({type:a,selectors:[["nz-page-header-footer"],["","nz-page-header-footer",""]],hostAttrs:[1,"ant-page-header-footer"],exportAs:["nzPageHeaderFooter"]})}return a})(),S=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275dir=r.lG2({type:a,selectors:[["nz-breadcrumb","nz-page-header-breadcrumb",""]],exportAs:["nzPageHeaderBreadcrumb"]})}return a})(),q=(()=>{class a{constructor(d,p,g,U,E,X){this.location=d,this.nzConfigService=p,this.elementRef=g,this.nzResizeObserver=U,this.cdr=E,this.directionality=X,this._nzModuleName="pageHeader",this.nzBackIcon=null,this.nzGhost=!0,this.nzBack=new r.vpe,this.compact=!1,this.destroy$=new v.x,this.dir="ltr"}ngOnInit(){this.directionality.change?.pipe((0,J.R)(this.destroy$)).subscribe(d=>{this.dir=d,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngAfterViewInit(){this.nzResizeObserver.observe(this.elementRef).pipe((0,I.U)(([d])=>d.contentRect.width),(0,J.R)(this.destroy$)).subscribe(d=>{this.compact=d<768,this.cdr.markForCheck()})}onBack(){if(this.nzBack.observers.length)this.nzBack.emit();else{if(!this.location)throw new Error(`${m.Bq} you should import 'RouterModule' or register 'Location' if you want to use 'nzBack' default event!`);this.location.back()}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getBackIcon(){return"rtl"===this.dir?"arrow-right":"arrow-left"}static#e=this.\u0275fac=function(p){return new(p||a)(r.Y36(e.Ye,8),r.Y36(Q.jY),r.Y36(r.SBq),r.Y36(k.D3),r.Y36(r.sBO),r.Y36(_.Is,8))};static#t=this.\u0275cmp=r.Xpm({type:a,selectors:[["nz-page-header"]],contentQueries:function(p,g,U){if(1&p&&(r.Suo(U,L,5),r.Suo(U,S,5)),2&p){let E;r.iGM(E=r.CRH())&&(g.nzPageHeaderFooter=E.first),r.iGM(E=r.CRH())&&(g.nzPageHeaderBreadcrumb=E.first)}},hostAttrs:[1,"ant-page-header"],hostVars:10,hostBindings:function(p,g){2&p&&r.ekj("has-footer",g.nzPageHeaderFooter)("ant-page-header-ghost",g.nzGhost)("has-breadcrumb",g.nzPageHeaderBreadcrumb)("ant-page-header-compact",g.compact)("ant-page-header-rtl","rtl"===g.dir)},inputs:{nzBackIcon:"nzBackIcon",nzTitle:"nzTitle",nzSubtitle:"nzSubtitle",nzGhost:"nzGhost"},outputs:{nzBack:"nzBack"},exportAs:["nzPageHeader"],ngContentSelectors:B,decls:13,vars:5,consts:[[1,"ant-page-header-heading"],[1,"ant-page-header-heading-left"],["class","ant-page-header-back",3,"click",4,"ngIf"],["class","ant-page-header-heading-title",4,"ngIf"],[4,"ngIf"],["class","ant-page-header-heading-sub-title",4,"ngIf"],[1,"ant-page-header-back",3,"click"],["role","button","tabindex","0",1,"ant-page-header-back-button"],[4,"nzStringTemplateOutlet"],["nz-icon","","nzTheme","outline",3,"nzType"],[1,"ant-page-header-heading-title"],[1,"ant-page-header-heading-sub-title"]],template:function(p,g){1&p&&(r.F$t(G),r.Hsn(0),r.TgZ(1,"div",0)(2,"div",1),r.YNc(3,b,3,1,"div",2),r.Hsn(4,1),r.YNc(5,R,2,1,"span",3),r.YNc(6,A,1,0,"ng-content",4),r.YNc(7,F,2,1,"span",5),r.YNc(8,Z,1,0,"ng-content",4),r.Hsn(9,2),r.qZA(),r.Hsn(10,3),r.qZA(),r.Hsn(11,4),r.Hsn(12,5)),2&p&&(r.xp6(3),r.Q6J("ngIf",null!==g.nzBackIcon),r.xp6(2),r.Q6J("ngIf",g.nzTitle),r.xp6(1),r.Q6J("ngIf",!g.nzTitle),r.xp6(1),r.Q6J("ngIf",g.nzSubtitle),r.xp6(1),r.Q6J("ngIf",!g.nzSubtitle))},dependencies:[e.O5,h.f,x.Ls],encapsulation:2,changeDetection:0})}return(0,P.gn)([(0,Q.oS)()],a.prototype,"nzGhost",void 0),a})(),K=(()=>{class a{static#e=this.\u0275fac=function(p){return new(p||a)};static#t=this.\u0275mod=r.oAB({type:a});static#o=this.\u0275inj=r.cJS({imports:[_.vT,e.ez,h.T,x.PV]})}return a})()}}]);
//# sourceMappingURL=libs_product_detail_src_index_ts.js.map