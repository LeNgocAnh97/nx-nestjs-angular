"use strict";(self.webpackChunkicom=self.webpackChunkicom||[]).push([[458],{7458:(U,u,i)=>{i.r(u),i.d(u,{IcomLibsProductAddEditComponent:()=>p.B,IcomLibsProductListComponent:()=>G});var y=i(5861),e=i(5879),d=i(6223),g=i(5545),b=i(19),S=i(2840),T=i(3599),h=i(4729),c=i(7398),P=i(2572),z=i(6814),L=i(8083),O=i(551),r=i(1221),x=i(7422),I=i(9691),f=i(2787),R=i(9717),k=i(9466),N=i(4843),v=i(424),F=i(3571),p=i(9927),M=i(6990),A=i(95);const D=["container"];function V(a,E){1&a&&(e.ynx(0),e._UZ(1,"icom-libs-product-add_edit",6),e.BQk()),2&a&&(e.xp6(1),e.Q6J("isAdd",!0))}let G=(()=>{class a{constructor(n){this.modalService=n,this.form=new d.cw({}),this.model={},this.inventoryService=(0,e.f3M)(h.k),this.productService=(0,e.f3M)(h.k),this.IComMessageService=(0,e.f3M)(R.Q),this.viewContainerRef=(0,e.f3M)(e.s_b),this.componentFactoryResolver=(0,e.f3M)(e._Vd),this.icomLibsDynamicComponentService=(0,e.f3M)(k.G),this.location=(0,e.f3M)(z.Ye),this.localStorageService=(0,e.f3M)(v.n2),this.fields=[{fieldGroupClassName:"flex flex-col",className:"basis-1/2",fieldGroup:[{key:"name",type:"input",className:"basis-4/12",props:{label:"Name",placeholder:"Enter Name",type:"string"},expressions:{"props.":"formState.disabled"}},{key:"gen_code_type",type:"select-custom",className:"basis-4/12 ",props:{label:"Gen Code Type",placeholder:"Select Gen Code Type",viewValue:"name",labelProp:"name",valueProp:"code",options:this.productService.getOptionType("PRODUCT_GENCODE_TYPE").pipe((0,c.U)(t=>t?.data))},expressions:{hide:"!formState.hidden"}},{key:"sku",type:"input",className:"basis-4/12",props:{label:"Sku",placeholder:"Enter Sku",type:"string"},expressions:{hide:"!formState.hidden"}}]},{fieldGroupClassName:"flex flex-col",className:"basis-1/2",fieldGroup:[{key:"brand",type:"input",className:"basis-4/12",props:{label:"Brand Name",placeholder:"Enter Brand Name",type:"string"},expressions:{hide:"!formState.hidden"}},{key:"status",type:"select-custom",className:"basis-4/12 ",props:{label:"Status",viewValue:"name",labelProp:"name",placeholder:"Select Status",valueProp:"int_value",options:this.productService.getOptionType("PRODUCT_STATUS").pipe((0,c.U)(t=>t?.data))},expressions:{hide:"!formState.hidden"}},{key:"type",type:"select-custom",className:"basis-4/12 ",templateOptions:{label:"Type",placeholder:"Select Type",viewValue:"name",labelProp:"name",valueProp:"code",options:this.productService.getOptionType("PRODUCT_TYPE").pipe((0,c.U)(t=>t?.data))},expressions:{hide:"!formState.hidden"}}]}],this.router=(0,e.f3M)(f.F0),this.permissionService=(0,e.f3M)(v.$A),this.cdr=(0,e.f3M)(e.sBO),this.loadData=t=>{const o=(0,M.cloneDeep)(t);return delete o.page,delete o.per_page,this.localStorageService.setItem("productParams",o),this.inventoryService.searchProduct(t)},this.functionParse=t=>t?.map(o=>({...o,...o.creator_info})),this.columns=[],this.model=this.localStorageService.getItem("productParams")||{}}ngOnInit(){var n=this;return(0,y.Z)(function*(){n.columns=[{title:"Id",type:"text",key:"id",width:"100px"},{title:"\u1ea2nh \u0111\u1ea1i di\u1ec7n",key:"medias[0].url",type:"image"},{title:"SKU",key:"sku",type:"text",width:"200px"},{title:"T\xean s\u1ea3n ph\u1ea9m",key:"name",type:"text",width:"200px"},{title:"S\u1ed1 l\u01b0\u1ee3ng",key:"quantity_available",pipe:"pipe_custom",type:"text",pipeArgs:t=>null===t?"Kh\xf4ng gi\u1edbi h\u1ea1n":t},{title:"Th\u01b0\u01a1ng hi\u1ec7u",key:"brand.name",type:"text"},{title:"Lo\u1ea1i s\u1ea3n ph\u1ea9m",key:"type",pipe:"array",type:"text",pipeArgs:[]},{title:"Th\u1eddi gian b\u1eaft \u0111\u1ea7u",key:"start_time",type:"text",pipe:"time"},{title:"Th\u1eddi gian k\u1ebft th\xfac",key:"end_time",type:"text",pipe:"time"},{title:"Tr\u1ea1ng th\xe1i",key:"status",pipe:"array",type:"text",pipeArgs:[{value:"Draft",id:0,class:"text-gray-500"},{value:"Submitted",id:1,class:"text-green-500"},{value:"Approved",id:2,class:"text-green-500"},{value:"Rejected",id:3,class:"text-red-500"}]},{key:"action",type:"button",buttonText:"Xem chi ti\u1ebft",buttonType:"primary",callback:n.viewItem.bind(n)}],(0,P.a)([n.productService.getOptionType("PRODUCT_TYPE"),n.productService.getOptionType("PRODUCT_GENCODE_TYPE")]).subscribe(t=>{const[o,s]=t,l=n.columns.find(m=>"type"===m.key);l&&(l.pipeArgs=n.pipeParseStatus(o)),n.columns=[...n.columns];const C=n.columns.find(m=>"gen_code_type"===m.key);C&&(C.pipeArgs=n.pipeParseStatus(s)),n.columns=[...n.columns],n.cdr.detectChanges()}),n.router.events.subscribe(t=>{t instanceof f.eO&&(n.childComponentRef&&n.removeComponentFromComponent(n,n.childComponentRef),n.childComponentRef=null)})})()}pipeParseStatus(n){return n.data.map(t=>({...t,id:t.code,value:t.name||t.string_value}))}viewItem(n,t){this.childComponentRef&&this.removeComponentFromComponent(this,this.childComponentRef),this.childComponentRef=this.icomLibsDynamicComponentService.appendComponentToComponent(this,F.IcomLibsProductDetailComponent),this.childComponentRef.instance.isAdd=t||!1,this.childComponentRef.instance.backClicked.subscribe(o=>{o&&this.eventFunctionControl.mergeItem&&this.eventFunctionControl.mergeItem("id",o),this.location.replaceState("product/voucher"),this.childComponentRef&&this.removeComponentFromComponent(this,this.childComponentRef),this.childComponentRef=null}),this.childComponentRef.instance.saveClicked.subscribe(o=>{this.eventFunctionControl.mergeItem&&this.eventFunctionControl.mergeItem("id",o)}),this.location.replaceState(`product/voucher/detail/${n.id}`),this.cdr.detectChanges()}removeComponentFromComponent(n,t){const o=n.viewContainerRef,s=o.indexOf(t.hostView);-1!==s&&o.detach(s),t.destroy()}handlerFunctionControl(n){this.eventFunctionControl=n}showModal(){this.isVisible=!0}handleOk(){this.addEditComp.handlerSave(void 0,{success:t=>{this.isVisible=!1,this.viewItem({id:t},!0)},isLoading:()=>{this.isOkLoading=!0},loadDone:()=>{this.isOkLoading=!1}})}handleCancel(){this.isVisible=!1}handlerViewDetail(n,t){n.stopPropagation();const o=this.router.serializeUrl(this.router.createUrlTree([`/product/voucher/detail/${t.id}`]));window.open(o,"_blank")}static#e=this.\u0275fac=function(t){return new(t||a)(e.Y36(r.Sf))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["icom-libs-product-list"]],viewQuery:function(t,o){if(1&t&&(e.Gf(D,7,e.s_b),e.Gf(p.B,5)),2&t){let s;e.iGM(s=e.CRH())&&(o.containerRef=s.first),e.iGM(s=e.CRH())&&(o.addEditComp=s.first)}},standalone:!0,features:[e.jDz],decls:7,vars:11,consts:[[1,"flex","w-full","h-full","flex-col"],["nz-row","",1,"w-full","pr-4","h-full",2,"justify-content","end","padding-right","8px"],[1,"w-full","h-full",3,"columns","loadFn","fields","model","form","functionParse","icomAdd","icomFunctionControl"],["container",""],["nzTitle","Add New Product",3,"nzWidth","nzOkLoading","nzClosable","nzMaskClosable","nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"isAdd"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"icom-libs-core-components-table",2),e.NdJ("icomAdd",function(){return o.showModal()})("icomFunctionControl",function(l){return o.handlerFunctionControl(l)}),e.qZA()()(),e._UZ(3,"div",null,3),e.TgZ(5,"nz-modal",4),e.NdJ("nzVisibleChange",function(l){return o.isVisible=l})("nzOnCancel",function(){return o.handleCancel()})("nzOnOk",function(){return o.handleOk()}),e.YNc(6,V,2,1,"ng-container",5),e.qZA()),2&t&&(e.xp6(2),e.Q6J("columns",o.columns)("loadFn",o.loadData)("fields",o.fields)("model",o.model)("form",o.form)("functionParse",o.functionParse),e.xp6(3),e.Q6J("nzWidth",960)("nzOkLoading",o.isOkLoading)("nzClosable",!1)("nzMaskClosable",!1)("nzVisible",o.isVisible))},dependencies:[b.u,d.UX,g.X0,S.sL,T.U5,A.SK,L.ZJ,O.PV,r.Qp,r.du,r.Hf,I.LV,d.u5,x.b1,p.B,N.d],encapsulation:2,changeDetection:0})}return a})()}}]);