"use strict";(self.webpackChunkicom=self.webpackChunkicom||[]).push([[703],{9488:(L,d,o)=>{o.r(d),o.d(d,{IcomLibCardManagementComponent:()=>N});var c=o(5861),e=o(5879),i=o(6223),s=o(9691),p=o(6494),u=o(3599),z=o(824),f=o(2840),C=o(551),h=o(7398),g=o(708),b=o(4729),E=o(6814),k=o(9717),_=o(6990),y=o(8373),v=o(5545),T=o(19),Z=o(8111),x=o(3304),w=o(95),G=o(855),A=o(1958);function M(l,S){if(1&l&&(e.TgZ(0,"form",26),e._UZ(1,"formly-form",27),e.qZA()),2&l){const n=e.oxw(2);e.Q6J("formGroup",n.form)("nzLayout","vertical"),e.xp6(1),e.Q6J("model",n.model)("fields",n.fields)("form",n.form)}}function F(l,S){if(1&l){const n=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"form",3)(3,"div",4)(4,"div",5)(5,"h2",6),e._uU(6,"Th\xf4ng tin g\u1ee3i \xfd"),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"nz-switch",10),e.TgZ(11,"label"),e._uU(12,"Hi\u1ec3n th\u1ecb th\xf4ng tin g\u1ee3i \xfd mua th\u1ebb khi l\u01b0\u1ee3t s\u1eed d\u1ee5ng c\xf2n l\u1ea1i"),e.qZA(),e.TgZ(13,"nz-select",11),e._UZ(14,"nz-option",12)(15,"nz-option",13)(16,"nz-option",14),e.qZA(),e.TgZ(17,"nz-form-control",15),e._UZ(18,"nz-input-number",16),e._uU(19," l\u01b0\u1ee3t "),e.qZA()()(),e.TgZ(20,"div",17),e._UZ(21,"nz-switch",18),e.TgZ(22,"label"),e._uU(23,"Hi\u1ec3n th\u1ecb th\xf4ng tin g\u1ee3i \xfd mua th\u1ebb h\u1ebft hi\u1ec7u l\u1ef1c"),e.qZA()(),e.TgZ(24,"div",19),e._UZ(25,"nz-switch",18),e.TgZ(26,"label"),e._uU(27,"Hi\u1ec3n th\u1ecb th\xf4ng tin g\u1ee3i \xfd mua th\u1ebb khi h\u1ea1n s\u1eed d\u1ee5ng th\u1ebb"),e.qZA(),e.TgZ(28,"nz-select",11),e._UZ(29,"nz-option",12)(30,"nz-option",13)(31,"nz-option",14),e.qZA(),e.TgZ(32,"nz-form-control",15),e._UZ(33,"nz-input-number",20),e._uU(34," ng\xe0y "),e.qZA()()()()()(),e.TgZ(35,"h2",21),e._uU(36,"G\u1eedi noti remind"),e.qZA(),e.YNc(37,M,2,5,"form",22),e.qZA(),e.TgZ(38,"div",23)(39,"button",24),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.saveSettings())}),e._uU(40,"L\u01b0u"),e.qZA(),e.TgZ(41,"button",25),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.resetSettings())}),e._uU(42,"H\u1ee7y"),e.qZA()()()}if(2&l){const n=e.oxw();e.xp6(2),e.Q6J("formGroup",n.formGroup),e.xp6(16),e.Q6J("nzParser",n.parseFunction)("nzFormatter",n.parseFunction),e.xp6(15),e.Q6J("nzParser",n.parseFunction)("nzFormatter",n.parseFunction),e.xp6(4),e.Q6J("ngIf",n.model),e.xp6(2),e.Q6J("nzLoading",n.isLoading),e.xp6(2),e.Q6J("nzLoading",n.isLoading)}}let N=(()=>{class l{constructor(n){this.fb=n,this.fields=[],this.form=new i.cw({}),this.cdr=(0,e.f3M)(e.sBO),this.campaignService=(0,e.f3M)(b.wb),this.IComMessageService=(0,e.f3M)(k.Q),this.iComLibsServicesProductCardService=(0,e.f3M)(b.Oz),this.parseFunction=t=>t&&t.toString(),this.fields=[{key:"noti_by_checkup",expressions:{"props.disabled":"formState.disabled"},props:{headerType:"switch",label:"G\u1eedi noti khi th\u1ebb s\u1eafp h\u1ebft l\u01b0\u1ee3t",changeChecked:(t,r)=>{r.fieldGroup.find(m=>"checked"===m.key).model.checked=t},setChecked:t=>t?.fieldGroup?.find(a=>"checked"===a.key)?.model?.checked},wrappers:["collapse"],fieldGroup:[{key:"checked",defaultValue:!1,type:"checkbox",className:"hidden"},{key:"noti_require",type:"array",fieldGroupClassName:"flex flex-col mt-4",className:"w-full mt-4 test2",props:{label:"",addText:"Th\xeam c\u1ea5u h\xecnh",initialModel:{number_value:"",template_noti_id:0,expect_time_send:null}},expressions:{"props.disabled":"formState.disabled"},fieldArray:{wrappers:["group"],props:{label:"",initialModel:{number_value:"",template_noti_id:0,expect_time_send:null}},expressions:{"props.disabled":"formState.disabled"},fieldGroupClassName:"flex w-full",fieldGroup:[{key:"number_value",type:"nz-input-number",className:"w-full",props:{label:"S\u1ed1 l\u01b0\u1ee3t kh\xe1m c\xf2n l\u1ea1i",addonText:"l\u01b0\u1ee3t",type:"number",outputNullable:!0,placeholder:"Nh\u1eadp s\u1ed1",min:1,max:9999999999,disabled:!0,required:!0},parsers:[t=>`${t}`],expressions:{"props.disabled":"formState.disabled"}},{key:"template_noti_id",type:"select-custom",expressions:{"props.disabled":"formState.disabled"},className:"w-full",props:{label:"M\u1eabu th\xf4ng b\xe1o",placeholder:"Ch\u1ecdn m\u1eabu th\xf4ng b\xe1o",viewValue:"title",labelProp:"title",required:!0,valueProp:"id",options:this.campaignService.getMessageTemplate().pipe((0,h.U)(t=>t.data))}},{key:"specific_expect_time_send",type:"time-picker",className:"w-full ml-8",props:{label:"Th\u1eddi gian g\u1eedi",nzFormat:"HH:mm",nzAllowEmpty:!0,changes:(t,r)=>{r.model.expect_time_send=t?x(t).format("HH:mm"):null}}}]}}]},{key:"noti_by_expire",expressions:{"props.disabled":"formState.disabled"},props:{headerType:"switch",label:"G\u1eedi noti khi th\u1ebb s\u1eafp h\u1ebft h\u1ea1n",changeChecked:(t,r)=>{r.fieldGroup.find(m=>"checked"===m.key).model.checked=t},setChecked:t=>t?.fieldGroup?.find(a=>"checked"===a.key)?.model?.checked},wrappers:["collapse"],fieldGroup:[{key:"checked",defaultValue:!1,type:"checkbox",className:"hidden"},{key:"noti_require",type:"array",fieldGroupClassName:"flex flex-col mt-4",className:"w-full mt-4 test2",props:{label:"",addText:"Th\xeam c\u1ea5u h\xecnh",initialModel:{number_value:"",template_noti_id:0,expect_time_send:null}},expressions:{"props.disabled":"formState.disabled"},fieldArray:{wrappers:["group"],props:{label:""},expressions:{"props.disabled":"formState.disabled"},fieldGroupClassName:"flex w-full",fieldGroup:[{key:"number_value",type:"nz-input-number",className:"w-full",props:{label:"Th\u1eddi h\u1ea1n th\u1ebb c\xf2n l\u1ea1i",addonText:"ng\xe0y",type:"number",outputNullable:!0,placeholder:"Nh\u1eadp s\u1ed1",min:1,max:9999999999,disabled:!0,required:!0},parsers:[t=>`${t}`],expressions:{"props.disabled":"formState.disabled"}},{key:"template_noti_id",type:"select-custom",expressions:{"props.disabled":"formState.disabled"},className:"w-full",props:{label:"M\u1eabu th\xf4ng b\xe1o",placeholder:"Ch\u1ecdn m\u1eabu th\xf4ng b\xe1o",viewValue:"title",labelProp:"title",valueProp:"id",required:!0,options:this.campaignService.getMessageTemplate().pipe((0,h.U)(t=>t.data))}},{key:"specific_expect_time_send",type:"time-picker",className:"w-full ml-8",props:{label:"Th\u1eddi gian g\u1eedi",nzFormat:"HH:mm",nzAllowEmpty:!0,changes:(t,r)=>{r.model.expect_time_send=t?x(t).format("HH:mm"):null}}}]}}]}]}ngOnInit(){var n=this;return(0,c.Z)(function*(){try{const t=yield(0,g.n)(n.iComLibsServicesProductCardService.getCardManagement("FIRST_CARD"));n.setting=t?.data,n.initFromGroup(),n.model=n.setting.noti_remind,n.modelOrigin=(0,_.cloneDeep)(n.model),n.cdr.detectChanges()}catch(t){console.log(t)}})()}initFromGroup(n){const t=n?{...n}:{...this.setting?.show_note_buy_more};this.formGroup=this.fb.group({buy_more_number_checkup:this.fb.group({checked:[t?.buy_more_number_checkup?.checked||!1,[i.kI.required]],number_value:[t?.buy_more_number_checkup?.number_value?.toString()||null,[i.kI.required]],comparse:[t?.buy_more_number_checkup?.comparse||null,[i.kI.required]]}),buy_more_expire:this.fb.group({checked:[t?.buy_more_expire?.checked||!1,[i.kI.required]]}),buy_more_countdown_date:this.fb.group({checked:[t?.buy_more_countdown_date?.checked||!1,[i.kI.required]],number_value:[t?.buy_more_countdown_date?.number_value?.toString()||null,[i.kI.required]],comparse:[t?.buy_more_countdown_date?.comparse||null,[i.kI.required]]})})}saveSettings(){var n=this;return(0,c.Z)(function*(){if(!n.formGroup.valid)return;if(console.log(n.form),n.form.invalid)return void(0,Z.c2)(n.form);n.isLoading=!0,n.setting.show_note_buy_more=n.formGroup.value;const t=n.setting?.show_note_buy_more;t.buy_more_countdown_date.number_value&&(t.buy_more_countdown_date.number_value=`${t.buy_more_countdown_date.number_value}`),t.buy_more_number_checkup.number_value&&(t.buy_more_number_checkup.number_value=`${t.buy_more_number_checkup.number_value}`);try{yield(0,g.n)(n.iComLibsServicesProductCardService.updateCardManagement("FIRST_CARD",n.setting)),n.IComMessageService.showAlertMessageDone("Th\xeam c\u1ea5u h\xecnh th\xe0nh c\xf4ng."),n.initFromGroup(n.formGroup.value)}catch(r){n.IComMessageService.showAlertMessageError(r?.error?.error_message||"Th\xeam M\u1ee5c Kho th\u1ea5t b\u1ea1i")}finally{n.isLoading=!1,n.cdr.detectChanges()}})()}resetSettings(){this.formGroup.reset(),this.model=null,this.cdr.detectChanges(),setTimeout(()=>{this.model=(0,_.cloneDeep)(this.modelOrigin),this.cdr.detectChanges()},50)}static#e=this.\u0275fac=function(t){return new(t||l)(e.Y36(i.j3))};static#t=this.\u0275cmp=e.Xpm({type:l,selectors:[["icom-libs-admin-card_management"]],standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[["class","w-full h-full flex flex-col",4,"ngIf"],[1,"w-full","h-full","flex","flex-col"],[1,"w-full","h-full","pr-4","overflow-auto"],["nz-form","",3,"formGroup"],[1,"mt-8"],[1,"positive","mt-4"],[1,"text-base","font-semibold"],[1,"mt-2"],["formGroupName","buy_more_number_checkup"],[1,"flex","items-center"],["formControlName","checked",1,"mr-2","rounded-bl-full"],["formControlName","comparse",1,"w-32"],["nzValue","lt","nzLabel","Nh\u1ecf h\u01a1n"],["nzValue","eq","nzLabel","B\u1eb1ng"],["nzValue","gt","nzLabel","L\u1edbn h\u01a1n"],["nzErrorTip","Ch\u01b0a nh\u1eadp s\u1ed1"],["placeholder","Nh\u1eadp s\u1ed1","formControlName","number_value",1,"text-center",3,"nzParser","nzFormatter"],["formGroupName","buy_more_expire"],["formControlName","checked",1,"mr-2"],["formGroupName","buy_more_countdown_date",1,"flex","items-center"],["placeholder","Ch\u01b0a nh\u1eadp s\u1ed1","nz-input","","formControlName","number_value",1,"text-center",3,"nzParser","nzFormatter"],[1,"text-base","font-semibold","mt-4"],["nz-form","",3,"formGroup","nzLayout",4,"ngIf"],[1,"flex"],["nz-button","","nzType","primary",1,"mt-2.5","mr-7","py-1.5","px-2.5",3,"nzLoading","click"],["nz-button","","nzType","default",1,"mt-2.5","mr-5","py-1.5","px-2.5",3,"nzLoading","click"],["nz-form","",3,"formGroup","nzLayout"],[3,"model","fields","form"]],template:function(t,r){1&t&&e.YNc(0,F,43,8,"div",0),2&t&&e.Q6J("ngIf",r.setting&&r.formGroup)},dependencies:[i.u5,i._Y,i.JJ,i.JL,E.O5,T.u,i.UX,i.sg,i.u,i.x0,v.X0,v.T7,u.U5,w.t3,u.Lr,u.Fd,p.m,p.i,s.LV,s.Ip,s.Vq,z.o7,f.sL,f.ix,G.w,A.dQ,C.PV,y.Zf,y._V],styles:["nz-select[_ngcontent-%COMP%]{margin:10px 9px 8px 10px}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{appearance:none}input[_ngcontent-%COMP%]{margin:22px 5px 8px 0;width:76px}",".test[_ngcontent-%COMP%]     formly-group{display:flex;flex-wrap:wrap}.test[_ngcontent-%COMP%]     formly-group .test2 nz-form-label{width:auto!important}"],changeDetection:0})}return l})()}}]);