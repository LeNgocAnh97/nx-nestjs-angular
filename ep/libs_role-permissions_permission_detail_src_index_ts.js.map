{"version":3,"file":"libs_role-permissions_permission_detail_src_index_ts.js","mappings":"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","names":["i0","$event","_r13","role_r7","$implicit","selected","stopPropagation","ctx_r15","updateSubModuleSelection","_c0","name_vi","action_r18","_r20","ctx_r21","updateActionSelection","_r25","group_r5","ctx_r23","onPanelChange","RolePermissionsComponent_form_3_div_13_div_3_nz_collapse_panel_4_ng_template_1_Template","RolePermissionsComponent_form_3_div_13_div_3_nz_collapse_panel_4_li_4_Template","_r8","actions","RolePermissionsComponent_form_3_div_13_div_3_nz_collapse_panel_4_Template","sub_modules","RolePermissionsComponent_form_3_div_13_div_3_Template","ctx_r3","data_group","RolePermissionsComponent_form_3_div_6_Template","RolePermissionsComponent_form_3_div_7_Template","RolePermissionsComponent_form_3_div_13_Template","ctx_r0","roleForm","controls","name","dirty","hasError","length","RolePermissionsComponent","constructor","fb","_this","this","allChecked","indeterminate","localStorageService","inject","LocalStorageService","changeDetectorRef","ChangeDetectorRef","iComLibsServicesProjectIamRoleService","IComLibsServicesProjectIamRoleService","destroyRef","DestroyRef","route","ActivatedRoute","cdr","modalService","NzModalService","router","Router","mode","queryParams","pipe","takeUntilDestroyed","subscribe","_ref","_asyncToGenerator","params","id","result","lastValueFrom","listDefaultRole","data","permissions","convertKeysToLowerCase","createForm","detectChanges","detail","group","Validators","required","maxLength","note","description","_x","apply","arguments","Array","isArray","map","item","lowercaseData","key","Object","prototype","hasOwnProperty","call","replace","toLowerCase","updateModuleSelection","module","every","subModule","updateAllCheckedState","forEach","action","a","selectedModules","filter","indeterminateModules","some","ngOnInit","getItem","DefineKey","PERMISSIONS","isActive","sub_module","active","submitForm","_this2","valid","dataUpdate","value","add","values","control","invalid","markAsDirty","updateValueAndValidity","onlySelf","static","t","i1","core","Xpm","selectors","inputs","standalone","features","decls","vars","consts","template","rf","ctx","RolePermissionsComponent_form_3_Template","FormsModule","NzCollapseModule","i2","NzCheckboxModule","i3","NzIconModule","NgFor","NgIf","ReactiveFormsModule","NzInputModule","i4","NzFormModule","i5","i6","NzButtonModule","i7","i8","i9","styles","changeDetection"],"sourceRoot":"webpack:///","sources":["./libs/role-permissions/permission/detail/src/detail/detail.component.html","./libs/role-permissions/permission/detail/src/detail/detail.component.ts"],"sourcesContent":["<div class=\"flex flex-col h-full py-4 pl-4 bg-white\">\n  <h4 class=\"text-lg font-bold mb-2\">Thông tin chung</h4>\n  <form\n    *ngIf=\"roleForm\"\n    class=\"flex flex-col h-full overflow-hidden\"\n    nz-form\n    [formGroup]=\"roleForm\"\n  >\n    <nz-form-item>\n      <nz-form-label [nzSpan]=\"4\" nzRequired nzFor=\"roleName\"\n        >Tên Vai Trò</nz-form-label\n      >\n      <nz-form-control [nzSpan]=\"8\">\n        <input\n          nz-input\n          formControlName=\"name\"\n          placeholder=\"Nhập tên vai trò\"\n        />\n\n        <div *ngIf=\"roleForm.controls['name'].dirty && roleForm.controls['name'].hasError('required')\" class=\"text-red-500\">\n          Vui lòng nhập tên vai trò\n        </div>\n        \n        <div *ngIf=\"roleForm.controls['name'].dirty && roleForm.controls['name'].hasError('maxLength')\" class=\"text-red-500\">\n          Tên vai trò phải có độ dài từ 1 đến 50 ký tự\n        </div>\n      </nz-form-control>\n    </nz-form-item>\n\n    <nz-form-item>\n      <nz-form-label [nzSpan]=\"4\" nzFor=\"note\">Ghi Chú</nz-form-label>\n      <nz-form-control [nzSpan]=\"8\">\n        <textarea nz-input formControlName=\"note\" placeholder=\"Nhập ghi chú\"></textarea>\n      </nz-form-control>\n    </nz-form-item>\n\n    <div class=\"overflow-auto pr-4\" *ngIf=\"data_group && data_group?.length\">\n      <h4 class=\"text-lg font-bold mb-2\">Phân quyền chi tiết</h4>\n      <div\n        class=\"mb-4 !p-2\"\n        *ngFor=\"let group of data_group\"\n        class=\"group-container\"\n      >\n        <h3 class=\"text-lg font-bold !px-4 pt-3\">{{ group.name_vi }}</h3>\n        <nz-collapse\n          class=\"custom-panel !bg-white !p-4\"\n          [nzBordered]=\"false\"\n          nzExpandIconPosition=\"right\"\n        >\n          <nz-collapse-panel\n            class=\"bg-white !border w-full h-full border-gray-200 mb-2 !rounded !border-b\"\n            [nzShowArrow]=\"true\"\n            [nzActive]=\"true\"\n            [nzHeader]=\"headerTemplate\"\n            *ngFor=\"let role of group?.sub_modules\"\n            (nzActiveChange)=\"onPanelChange($event, group)\"\n          >\n            <ng-template #headerTemplate>\n              <label\n                nz-checkbox\n                [ngModelOptions]=\"{ standalone: true }\"\n                [(ngModel)]=\"role.selected\"\n                (click)=\"$event.stopPropagation()\"\n                (ngModelChange)=\"updateSubModuleSelection(role)\"\n              >\n                {{ role.name_vi }}\n              </label>\n            </ng-template>\n\n            <ul nz-menu nzMode=\"horizontal\" class=\"flex\">\n              <li nz-menu-item *ngFor=\"let action of role.actions\" class=\"ml-6\">\n                <label\n                  nz-checkbox\n                  [(ngModel)]=\"action.selected\"\n                  [ngModelOptions]=\"{ standalone: true }\"\n                  (ngModelChange)=\"updateActionSelection(role, action)\"\n                >\n                  {{ action.name_vi }}\n                </label>\n              </li>\n            </ul>\n          </nz-collapse-panel>\n        </nz-collapse>\n      </div>\n    </div>\n  </form>\n  <div class=\"!border border-gray-200 p-3\">\n    <button nz-button nzType=\"primary\" type=\"submit\" (click)=\"submitForm()\">Lưu</button>\n  </div>\n</div>","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit, Inject, inject, DestroyRef, Input } from \"@angular/core\";\nimport { FormBuilder, FormGroup, FormsModule, ReactiveFormsModule, Validators } from \"@angular/forms\";\nimport { NzCheckboxModule } from \"ng-zorro-antd/checkbox\";\nimport { NzCollapseModule } from \"ng-zorro-antd/collapse\";\nimport { NzIconModule } from \"ng-zorro-antd/icon\";\nimport { NgFor, NgIf } from \"@angular/common\";\nimport { LocalStorageService } from \"@icom/services/authenticate\";\nimport { IIcomLibsCoreModuleFunction } from \"@icom/login\";\nimport { DefineKey } from \"@icom/defines\";\nimport { NzInputModule } from \"ng-zorro-antd/input\";\nimport { NzFormModule } from \"ng-zorro-antd/form\";\nimport { NzButtonModule } from \"ng-zorro-antd/button\";\nimport { IComLibsServicesProjectIamRoleService } from \"@icom/services/projects\";\nimport { lastValueFrom } from \"rxjs\";\nimport { takeUntilDestroyed } from \"@angular/core/rxjs-interop\";\nimport { cloneDeep } from \"lodash\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { NzModalService } from \"ng-zorro-antd/modal\";\n\n@Component({\n  // eslint-disable-next-line @angular-eslint/component-selector\n  selector: 'app-role-permissions',\n  templateUrl: './detail.component.html',\n  standalone: true,\n  imports: [\n    FormsModule,\n    NzCollapseModule,\n    NzCheckboxModule,\n    NzIconModule,\n    NgFor,\n    NgIf,\n    ReactiveFormsModule,\n    NzInputModule,\n    NzFormModule,\n    NzButtonModule\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  styles: [\n    `.group-container {\n      border: 1px solid #f0f0f0; /* Màu viền */\n      border-radius: 8px; /* Bán kính viền */\n      margin-bottom: 16px; /* Khoảng cách giữa các nhóm */\n    }\n    \n    .custom-panel {\n      border-bottom: 1px solid #f0f0f0; /* Màu viền phân cách */\n      border-radius: 8px; /* Bán kính viền */\n    }`\n  ]\n\n})\nexport class RolePermissionsComponent implements OnInit {\n  data_group: IIcomLibsCoreModuleFunction[] = [];\n  roleForm!: FormGroup;\n  allChecked = false;\n  indeterminate = true;\n\n  protected model: any | undefined;\n  private localStorageService = inject(LocalStorageService);\n  private changeDetectorRef = inject(ChangeDetectorRef);\n  protected iComLibsServicesProjectIamRoleService = inject(IComLibsServicesProjectIamRoleService);\n  protected destroyRef = inject(DestroyRef);\n  protected route = inject(ActivatedRoute);\n  protected cdr = inject(ChangeDetectorRef);\n  protected modalService = inject(NzModalService);\n  protected router = inject(Router);\n\n  @Input() data: any | undefined;\n  @Input() mode: 'view' | 'edit' | 'only_view' | 'add';\n\n  constructor(private fb: FormBuilder) {\n\n    this.mode = 'view';\n    this.route.queryParams\n      .pipe(takeUntilDestroyed(this.destroyRef))\n      .subscribe(async (params) => {\n        if (params) {\n          this.mode = params['mode'];\n          if (!params.id) {\n            const result = await lastValueFrom(this.iComLibsServicesProjectIamRoleService.listDefaultRole());\n            this.data_group = result?.data?.permissions || {};\n            this.data_group = this.convertKeysToLowerCase(this.data_group);\n            this.createForm();\n            this.cdr?.detectChanges();\n            return;\n          }\n          const id = (params as any)?.id || '';\n          const result = await lastValueFrom(this.iComLibsServicesProjectIamRoleService.detail(id as string));\n          this.data = result?.data || {};\n          this.roleForm = this.fb.group({\n            name: [this.data?.name, [Validators.required, Validators.maxLength(50)]],\n            note: [this.data?.description]\n          });\n          this.data_group = this.convertKeysToLowerCase(this.data.permissions);\n          this.cdr?.detectChanges();\n        }\n      });\n  }\n  createForm() {\n    this.roleForm = this.fb.group({\n      name: ['', [Validators.required, Validators.maxLength(50)]],\n      note: ['']\n    });\n  }\n\n  convertKeysToLowerCase(data: any): any {\n    if (Array.isArray(data)) {\n      return data.map((item: any) => this.convertKeysToLowerCase(item));\n    } else if (typeof data === 'object' && data !== null) {\n      const lowercaseData: any = {};\n      for (const key in data) {\n        if (Object.prototype.hasOwnProperty.call(data, key)) {\n          const newKey = key.replace(/([A-Z])/g, '_$1').toLowerCase();\n          lowercaseData[newKey] = this.convertKeysToLowerCase(data[key]);\n        }\n      }\n      return lowercaseData;\n    } else {\n      return data;\n    }\n  }\n\n  updateModuleSelection(module: any): void {\n    module.selected = module.sub_modules?.every((subModule: any) => subModule.selected);\n    this.updateAllCheckedState();\n  }\n\n  updateSubModuleSelection(subModule: any): void {\n    subModule.actions?.forEach((action: any) => {\n      action.selected = subModule.selected;\n    });\n    this.updateAllCheckedState();\n  }\n\n  updateActionSelection(subModule: any, action: any): void {\n    if (action.selected) {\n      subModule.selected = subModule.actions?.every((a: any) => a.selected);\n    } else {\n      subModule.selected = false;\n    }\n    this.updateAllCheckedState();\n  }\n\n  updateAllCheckedState(): void {\n    const selectedModules = this.data_group.filter((module: any) => module.selected);\n    const indeterminateModules = this.data_group?.filter((module: any) => !module.selected && module.sub_modules.some((subModule: any) => subModule.selected || (subModule.actions && subModule.actions.some((action: any) => action.selected))));\n    this.allChecked = selectedModules.length === this.data_group.length;\n    this.indeterminate = !this.allChecked && (selectedModules.length > 0 || indeterminateModules.length > 0);\n  }\n\n  ngOnInit(): void {\n    this.data_group = this.localStorageService.getItem(DefineKey.PERMISSIONS);\n    this.updateAllCheckedState();\n    this.data_group.forEach((module) => {\n      module.sub_modules?.forEach((subModule: any) => {\n        subModule.selected = subModule.actions?.every((action: any) => action.selected);\n      });\n    });\n  }\n\n\n  onPanelChange(isActive: boolean, sub_module: IIcomLibsCoreModuleFunction) {\n    sub_module.active = isActive;\n    this.changeDetectorRef.detectChanges();\n  }\n\n\n  async submitForm() {\n    if (this.roleForm.valid) {\n      const dataUpdate = {\n        ...this.roleForm.value,\n        permissions: this.data_group\n      };\n      await lastValueFrom(this.iComLibsServicesProjectIamRoleService.add(dataUpdate));\n    } else {\n      // Handle form validation errors\n      Object.values(this.roleForm.controls).forEach(control => {\n        if (control.invalid) {\n          control.markAsDirty();\n          control.updateValueAndValidity({ onlySelf: true });\n        }\n      });\n    }\n  }\n}"],"x_google_ignoreList":[]}