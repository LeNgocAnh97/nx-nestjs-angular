"use strict";(self.webpackChunkicom=self.webpackChunkicom||[]).push([[736],{9736:(E,p,o)=>{o.r(p),o.d(p,{IcomLibsProductAddEditComponent:()=>c.B,IcomLibsProductCardListComponent:()=>U});var v=o(5861),e=o(5879),r=o(6223),g=o(5545),y=o(19),T=o(2840),z=o(3599),u=o(4729),b=o(7398),L=o(2572),P=o(6814),S=o(8083),O=o(551),d=o(1221),x=o(7422),I=o(9691),h=o(2787),R=o(9717),F=o(9466),M=o(4843),C=o(424),A=o(5035),c=o(8658),D=o(6990),V=o(95);function k(a,G){1&a&&(e.ynx(0),e._UZ(1,"icom-libs-product-add_edit",6),e.BQk()),2&a&&(e.xp6(1),e.Q6J("isAdd",!0))}let U=(()=>{class a{constructor(){this.form=new r.cw({}),this.model={},this.inventoryService=(0,e.f3M)(u.k),this.productService=(0,e.f3M)(u.k),this.IComMessageService=(0,e.f3M)(R.Q),this.icomLibsDynamicComponentService=(0,e.f3M)(F.G),this.localStorageService=(0,e.f3M)(C.n2),this.location=(0,e.f3M)(P.Ye),this.fields=[{fieldGroupClassName:"flex flex-col",className:"basis-1/2",fieldGroup:[{key:"sku",type:"input",className:"basis-4/12",props:{label:"M\xe3 Code",placeholder:"M\xe3 Code",type:"string"},expressions:{hide:"!formState.hidden"}}]},{fieldGroupClassName:"flex flex-col",className:"basis-1/2",fieldGroup:[{key:"status",type:"select-custom",className:"basis-4/12 ",props:{label:"Tr\u1ea1ng th\xe1i",viewValue:"name",labelProp:"name",placeholder:"Tr\u1ea1ng th\xe1i",valueProp:"int_value",options:this.productService.getOptionType("PRODUCT_STATUS").pipe((0,b.U)(t=>t?.data))},expressions:{hide:"!formState.hidden"}}]}],this.router=(0,e.f3M)(h.F0),this.permissionService=(0,e.f3M)(C.$A),this.cdr=(0,e.f3M)(e.sBO),this.viewContainerRef=(0,e.f3M)(e.s_b),this.componentFactoryResolver=(0,e.f3M)(e._Vd),this.loadData=t=>{t.type||(t.type="PRODUCT_TYPE_CARD");const n=(0,D.cloneDeep)(t);return delete n.page,delete n.per_page,this.localStorageService.setItem("productCardParams",n),this.inventoryService.searchProduct(t)},this.functionParse=t=>t?.map(n=>({...n,...n.creator_info})),this.columns=[],this.model=this.localStorageService.getItem("productCardParams")||{}}ngOnInit(){var t=this;return(0,v.Z)(function*(){t.columns=[{title:"STT",type:"index",width:"80px"},{title:"T\xean th\u1ebb",key:"name",type:"text",width:"250px"},{title:"Code",key:"sku",type:"text",width:"250px"},{title:"S\u1ed1 item t\u1ed1i \u0111a/ giao d\u1ecbch",key:"max_item_per_transaction",type:"text",width:"180px"},{title:"Hi\u1ec3n th\u1ecb tr\xean App",key:"app",type:"text"},{title:"B\u1eaft \u0111\u1ea7u hi\u1ec3n th\u1ecb",key:"start_time",type:"text",pipe:"time"},{title:"K\u1ebft th\xfac hi\u1ec3n th\u1ecb",key:"end_time",type:"text",pipe:"time"},{title:"Tr\u1ea1ng th\xe1i",key:"status",pipe:"array",type:"text",pipeArgs:[{value:"Draft",id:0,class:"text-gray-500"},{value:"Submitted",id:1,class:"text-green-500"},{value:"Approved",id:2,class:"text-green-500"},{value:"Rejected",id:3,class:"text-red-500"}]},{title:"Th\u1eddi gian t\u1ea1o",key:"created_at",type:"text",pipe:"time"},{key:"action",type:"button",buttonText:"Xem chi ti\u1ebft",buttonType:"primary",callback:t.viewItem.bind(t)}],(0,L.a)([t.productService.getOptionType("PRODUCT_TYPE"),t.productService.getOptionType("PRODUCT_GENCODE_TYPE")]).subscribe(n=>{const[i,s]=n,l=t.columns.find(m=>"type"===m.key);l&&(l.pipeArgs=t.pipeParseStatus(i)),t.columns=[...t.columns];const f=t.columns.find(m=>"gen_code_type"===m.key);f&&(f.pipeArgs=t.pipeParseStatus(s)),t.columns=[...t.columns],t.cdr.detectChanges()}),t.router.events.subscribe(n=>{n instanceof h.eO&&(t.childComponentRef&&t.removeComponentFromComponent(t,t.childComponentRef),t.childComponentRef=null)})})()}pipeParseStatus(t){return t.data.map(n=>({...n,id:n.code,value:n.name||n.string_value}))}viewItem(t,n){this.childComponentRef&&this.removeComponentFromComponent(this,this.childComponentRef),this.childComponentRef=this.icomLibsDynamicComponentService.appendComponentToComponent(this,A.IcomLibsProductCardDetailComponent),this.childComponentRef.instance.isAdd=n||!1,this.childComponentRef.instance.backClicked.subscribe(i=>{i&&this.eventFunctionControl.mergeItem&&this.eventFunctionControl.mergeItem("id",i),this.location.replaceState("product/card"),this.childComponentRef&&this.removeComponentFromComponent(this,this.childComponentRef),this.childComponentRef=null}),this.childComponentRef.instance.saveClicked.subscribe(i=>{this.eventFunctionControl.mergeItem&&this.eventFunctionControl.mergeItem("id",i)}),this.location.replaceState(`product/card/detail/${t.id}`),this.cdr.detectChanges()}removeComponentFromComponent(t,n){const i=t.viewContainerRef,s=i.indexOf(n.hostView);-1!==s&&i.detach(s),n.destroy()}handlerFunctionControl(t){this.eventFunctionControl=t}showModal(){this.isVisible=!0}handleOk(){this.addEditComp.handlerSave(void 0,{success:n=>{this.isVisible=!1,this.viewItem({id:n},!0)},isLoading:()=>{this.isOkLoading=!0},loadDone:()=>{this.isOkLoading=!1}})}handleCancel(){this.isVisible=!1}handlerViewDetail(t,n){t.stopPropagation();const i=this.router.serializeUrl(this.router.createUrlTree([`/product/card/detail/${n.id}`]));window.open(i,"_blank")}static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275cmp=e.Xpm({type:a,selectors:[["icom-libs-product-list"]],viewQuery:function(n,i){if(1&n&&e.Gf(c.B,5),2&n){let s;e.iGM(s=e.CRH())&&(i.addEditComp=s.first)}},standalone:!0,features:[e.jDz],decls:7,vars:13,consts:[[1,"flex","w-full","h-full","flex-col"],["nz-row","",1,"w-full","pr-4","h-full",2,"justify-content","end","padding-right","8px"],[1,"w-full","h-full",3,"columns","loadFn","fields","model","form","functionParse","icomAdd","icomFunctionControl"],["container",""],["nzTitle","T\u1ea1o th\u1ebb m\u1edbi",3,"nzWidth","nzOkLoading","nzClosable","nzMaskClosable","nzOkText","nzCancelText","nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"isAdd"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"icom-libs-core-components-table",2),e.NdJ("icomAdd",function(){return i.showModal()})("icomFunctionControl",function(l){return i.handlerFunctionControl(l)}),e.qZA()()(),e._UZ(3,"div",null,3),e.TgZ(5,"nz-modal",4),e.NdJ("nzVisibleChange",function(l){return i.isVisible=l})("nzOnCancel",function(){return i.handleCancel()})("nzOnOk",function(){return i.handleOk()}),e.YNc(6,k,2,1,"ng-container",5),e.qZA()),2&n&&(e.xp6(2),e.Q6J("columns",i.columns)("loadFn",i.loadData)("fields",i.fields)("model",i.model)("form",i.form)("functionParse",i.functionParse),e.xp6(3),e.Q6J("nzWidth",960)("nzOkLoading",i.isOkLoading)("nzClosable",!1)("nzMaskClosable",!1)("nzOkText","L\u01b0u")("nzCancelText","\u0110\xf3ng")("nzVisible",i.isVisible))},dependencies:[y.u,r.UX,g.X0,T.sL,z.U5,V.SK,S.ZJ,O.PV,d.Qp,d.du,d.Hf,I.LV,r.u5,x.b1,c.B,M.d],encapsulation:2,changeDetection:0})}return a})()}}]);