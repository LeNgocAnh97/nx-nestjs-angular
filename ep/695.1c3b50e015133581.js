"use strict";(self.webpackChunkicom=self.webpackChunkicom||[]).push([[695],{8695:(F,c,o)=>{o.r(c),o.d(c,{IcomLibCustomerListComponent:()=>S});var p=o(5861),e=o(5879),f=o(6223),g=o(4729),v=o(4843),a=o(6814),y=o(2787),C=o(708),b=o(9717),m=o(8111),h=o(8581),u=o(3304),x=o(1221);function T(s,M){if(1&s){const t=e.EpF();e.TgZ(0,"icom-libs-core-components-table",3),e.NdJ("icomFunctionControl",function(l){e.CHM(t);const i=e.oxw();return e.KtG(i.handlerFunctionControl(l))}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("columns",t.columns)("loadFn",t.loadData)("fields",t.fields)("model",t.model)("form",t.form)("ignoreButtonAdd",!0)("functionParse",t.functionParse)}}let S=(()=>{class s{constructor(t,n){var l=this;this.datePipe=t,this.modalService=n,this.form=new f.cw({}),this.iComLibsServicesProjectAdminUserService=(0,e.f3M)(g.lF),this.iComMessageService=(0,e.f3M)(b.Q),this.router=(0,e.f3M)(y.F0),this.loadData=i=>((0,m.xh)(i,"last_login_start,last_login_end"),this.iComLibsServicesProjectAdminUserService.getListDevices(i)),this.functionParse=i=>i?.map(r=>({...r,...r.creator_info})),this.functionExportFile=function(){var i=(0,p.Z)(function*(r,d){(0,m.cT)(`${h.N.apiGatewayUrl}${h.N.suffixAdmin}/v2.0/export/activity_logs`,"MauFileExportLichSuThaoTac",l.iComMessageService,r,!1,!0,d)});return function(r,d){return i.apply(this,arguments)}}(),this.columns=[],this.fields=[]}ngOnInit(){const t=u().format("YYYY-MM-DD"),n=u(t).subtract(3,"month").format("YYYY-MM-DD");this.model={last_login_start:n,last_login_end:t},this.fields=[{className:"flex flex-col",fieldGroupClassName:"flex w-full justify-between",fieldGroup:[{key:"fullName",type:"text",className:"basis-6/12",props:{label:"H\u1ecd t\xean",placeholder:"Nh\u1eadp h\u1ecd t\xean"}},{key:"phoneNumber",type:"text",className:"basis-6/12",props:{label:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",placeholder:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i"}}]},{key:"customerGroup",type:"select",props:{label:"Nh\xf3m kh\xe1ch h\xe0ng",placeholder:"Ch\u1ecdn nh\xf3m kh\xe1ch h\xe0ng",nzAllowClear:!0,options:[{label:"Nh\xf3m mobilphone",value:"Nh\xf3m mobilphone"}]}},{key:"dateRange",type:"icom-range-picker",props:{label:"Th\u1eddi gian \u0111\u0103ng k\xfd",nzShowTime:!0,format:"dd/MM/yyyy HH:mm"}},{key:"status",type:"select",props:{label:"Tr\u1ea1ng th\xe1i",placeholder:"Ch\u1ecdn tr\u1ea1ng th\xe1i",nzAllowClear:!0,options:[{label:"\u0110ang ho\u1ea1t \u0111\u1ed9ng",value:"\u0110ang ho\u1ea1t \u0111\u1ed9ng"},{label:"Kh\xf3a",value:"Kh\xf3a"},{label:"Ch\u1edd x\u1eed l\xfd",value:"Ch\u1edd x\u1eed l\xfd"},{label:"\u0110\xe3 x\xf3a",value:"\u0110\xe3 x\xf3a"}]}}],this.columns=[{title:"STT",type:"index"},{title:"H\u1ecd t\xean",key:"fullName",type:"text"},{title:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",key:"phoneNumber",type:"text"},{title:"Nh\xf3m kh\xe1ch h\xe0ng",key:"customerGroup",type:"text"},{title:"Th\u1eddi gian \u0111\u0103ng k\xfd",key:"dateRange",type:"text",pipe:"time"},{title:"Tr\u1ea1ng th\xe1i",key:"status",type:"text"},{title:"Ghi ch\xfa",key:"note",type:"text"},{key:"action",type:"icon",iconType:"lock",callback:this.deleteItem.bind(this)}]}deleteItem(t){this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n xo\xe1 thi\u1ebft b\u1ecb ${t?.app_name} ?`,nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDeleteSection.bind(this,t),nzCancelText:"H\u1ee7y b\u1ecf"},"error")}processDeleteSection(t){return(0,C.n)(this.iComLibsServicesProjectAdminUserService.removeDevice(t.device_key||"")).then(()=>{this.iComMessageService.showAlertMessageDone("X\xf3a thi\u1ebft b\u1ecb th\xe0nh c\xf4ng."),this.eventFunctionControl.reset()}).catch(n=>{this.iComMessageService.showAlertMessageError(n?.error?.error_message)})}handlerFunctionControl(t){this.eventFunctionControl=t}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(a.uU),e.Y36(x.Sf))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["icom-libs-admin-user-history"]],standalone:!0,features:[e._Bn([a.JJ,a.uU]),e.jDz],decls:3,vars:1,consts:[[1,"flex","w-full","h-full","flex-col"],["nz-row","",1,"w-full","pr-4","h-full",2,"justify-content","end","padding-right","8px"],[3,"columns","loadFn","fields","model","form","ignoreButtonAdd","functionParse","icomFunctionControl",4,"ngIf"],[3,"columns","loadFn","fields","model","form","ignoreButtonAdd","functionParse","icomFunctionControl"]],template:function(n,l){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,T,1,7,"icom-libs-core-components-table",2),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("ngIf",l.loadData))},dependencies:[v.d,a.O5],encapsulation:2,changeDetection:0})}return s})()}}]);