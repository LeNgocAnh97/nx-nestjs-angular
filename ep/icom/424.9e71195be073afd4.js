(self.webpackChunkicom=self.webpackChunkicom||[]).push([[424],{8111:(P,E,n)=>{n.d(E,{$M:()=>S,md:()=>s.md,E2:()=>s.E2,ZR:()=>s.ZR,c2:()=>s.c2,PM:()=>s.PM,xh:()=>s.xh,NT:()=>s.NT,oS:()=>s.oS,cT:()=>s.cT});var s=n(61863);let S=(()=>{class h{static#e=this.KEY_MENU="menu";static#t=this.FUNCTIONS="functions";static#o=this.PERMISSIONS="permission"}return h})()},61863:(P,E,n)=>{n.d(E,{E2:()=>m,NT:()=>v,PM:()=>T,ZR:()=>u,c2:()=>j,cT:()=>M,md:()=>d,oS:()=>D,xh:()=>y});var s=n(93484),h=n(91872);const u=()=>({transform:t=>t?h(t).format("DD/MM/YYYY HH:mm"):"-"}),m=()=>({transform:t=>t||"-"}),d=t=>{if(Array.isArray(t))return t.map(a=>d(a));if("object"==typeof t&&null!==t){const a={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i.replace(/([A-Z])/g,"_$1").toLowerCase()]=d(t[i]));return a}return t},v=(t,a,i)=>{let l=["start_time","end_time"];a&&(l=a.split(","));const[o,g]=l;if(!t.date_range||!t.date_range.length)return;const e=t.date_range,[r,c]=e;if(r instanceof String&&c instanceof String)return;const f={[o]:h(r),[g]:h(c)};t[o]=f[o],t[g]=f[g],delete t.date_range},y=(t,a,i)=>{let l=["start_time","end_time"];a&&(l=a.split(","));const[o,g]=l;if(!t.date_range||!t.date_range.length)return;const e=t.date_range,[r,c]=e;if(r instanceof String&&c instanceof String)return;const f={[o]:h(r).format("YYYY-MM-DDT00:00:00")+"Z",[g]:h(c).format("YYYY-MM-DDT00:00:00")+"Z"};t[o]=f[o],t[g]=f[g],delete t.date_range},T=(t,a)=>{for(const i in t)a[i]=t[i]},j=t=>{Object.values(t.controls).forEach(a=>{a.markAsTouched(),a instanceof s.FormGroup?j(a):a instanceof s.FormArray&&a.controls.forEach(i=>{i instanceof s.FormGroup?j(i):i instanceof s.FormControl&&i.markAsTouched()})})},M=(t,a,i,l,o,g,e)=>{const r=new XMLHttpRequest;r.open("POST",t,!0),r.responseType="blob";let c=localStorage?.getItem("token");for(;c?.includes('"');)c=c?.replace('"',"");r.setRequestHeader("Authorization",`Bearer ${c}`),r.onload=()=>{if(200===r.status){const f=new Blob([r.response],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),I=URL.createObjectURL(f),C=document.createElement("a"),F=r.getResponseHeader("Content-Disposition");let _="";if(!o){const O=new Date;_=`${O.getDate()}_${O.getMonth()+1}_${O.getFullYear()}`}let N=`${a}_${_}`;if(F){const A=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(F);null!=A&&A[1]&&(N=A[1].replace(/['"]/g,""))}C.href=I,C.download=N,document.body.appendChild(C),C.click(),URL.revokeObjectURL(I),document.body.removeChild(C),i.showAlertMessageDone("T\u1ea3i file th\xe0nh c\xf4ng."),e&&e()}else i.showAlertMessageError("T\u1ea3i file th\u1ea5t b\u1ea1i."),e&&e()},r.onerror=function(){console.error("Request error")},r.setRequestHeader("Content-Type","application/json"),l&&g&&y(l),r.send(JSON.stringify(l))};function D(t,a){return Object.keys(t).forEach(i=>{i.startsWith(a)&&delete t[i]}),t}},30424:(P,E,n)=>{n.d(E,{sX:()=>t,PP:()=>m,N7:()=>D,ry:()=>T,n2:()=>v.n,l$:()=>l,$A:()=>a.$,d3:()=>d});var s=n(60202),S=n(33635),h=n(99275),p=n.n(h),u=n(36151);let m=(()=>{class o{constructor(e){this.router=e}canActivate(e,r){const c=r.url,f=localStorage.getItem("token");if(!f)return"/login"!==c&&(this.router.navigate(["/login"]),localStorage.removeItem("token")),(0,S.of)(!1);try{const I=p()(f).role;return"cms_admin"===I||"root_user"===I?(0,S.of)(!0):("/login"!==c&&(this.router.navigate(["/login"]),localStorage.removeItem("token")),(0,S.of)(!1))}catch{return"/login"!==c&&(this.router.navigate(["/login"]),localStorage.removeItem("token")),(0,S.of)(!1)}}static#e=this.\u0275fac=function(r){return new(r||o)(u.\u0275\u0275inject(s.Router))};static#t=this.\u0275prov=u.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac})}return o})(),d=179==n.j?(()=>{class o{constructor(e){this.route=e}canActivate(){return null==(localStorage.getItem("token")||null)||(this.route.navigate(["/"]),!1)}static#e=this.\u0275fac=function(r){return new(r||o)(u.\u0275\u0275inject(s.Router))};static#t=this.\u0275prov=u.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})():null;var v=n(27493),y=n(16564),R=n(65893);let T=(()=>{class o{constructor(e){this.localStorageService=e}intercept(e,r){if(e.headers.has("hideloader")){const C=e.headers.delete("hideloader");e=e.clone({headers:C})}let f=this.localStorageService.getItem("token")||null;return e.headers.has("isMerchantService")&&(f=this.localStorageService.getItem("merchantToken")||null),f&&((e=e.clone({url:e.url,headers:e.headers.set("Authorization",`Bearer ${f}`).delete("isMerchantService","yes")})).headers.has("Content-Type")||(e=e.clone({url:e.url,headers:e.headers.set("content-type","application/json")})),"clear"===e.headers.get("Content-Type")&&(e=e.clone({url:e.url,headers:e.headers.delete("Content-Type","clear")}))),r.handle(e).pipe((0,R.tap)(C=>C),(0,R.finalize)(()=>{}))}static#e=this.\u0275fac=function(r){return new(r||o)(u.\u0275\u0275inject(v.n))};static#t=this.\u0275prov=u.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac})}return o})();var j=n(1809),M=n(53750);let D=(()=>{class o{constructor(e,r){this.authService=e,this.iComMessageService=r}intercept(e,r){return r.handle(e).pipe((0,R.catchError)(c=>this.errorHandler(c)))}errorHandler(e){throw e instanceof y.HttpErrorResponse&&401===e.status&&this.authService.logout(),e}static#e=this.\u0275fac=function(r){return new(r||o)(u.\u0275\u0275inject(j.q),u.\u0275\u0275inject(M.Qi))};static#t=this.\u0275prov=u.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac})}return o})(),t=179==n.j?(()=>{class o{constructor(e){this.router=e,this.localStorageService=(0,u.inject)(v.n),this.modules=this.localStorageService.getItem("permission")}canActivateChild(e,r){const c=r.url;return"/user/change-password"===c||"/home"===c||"/flash-sale/list/group"===c||c.includes("/inventory/product")||this.checkAccess(c),!0}checkAccess(e){if(e.includes("detail")){const r=e.replace("detail","");return this.modules?.some(c=>c.sub_modules?.some(f=>r.includes(f.path)&&f.actions.some(I=>"view"===I.code&&I.selected)))||!1}return this.modules?.some(r=>r.sub_modules?.some(c=>c.path===e&&c.actions.some(f=>f.selected)))||!1}findAccessiblePath(){for(const e of this.modules)for(const r of e.sub_modules)if(r.actions.some(c=>c.selected))return r.path;return null}static#e=this.\u0275fac=function(r){return new(r||o)(u.\u0275\u0275inject(s.Router))};static#t=this.\u0275prov=u.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})():null;var a=n(248),i=n(8581);let l=179==n.j?(()=>{class o{constructor(e){this.router=e}canActivate(){return"ep"!==i.N?.module&&(console.log("vo"),!0)}static#e=this.\u0275fac=function(r){return new(r||o)(u.\u0275\u0275inject(s.Router))};static#t=this.\u0275prov=u.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})():null},248:(P,E,n)=>{n.d(E,{$:()=>y});var s=n(36151),h=n(27493),p=n(50038),m=n(8111),d=n(60202);let y=(()=>{class R{constructor(j,M){this.notificationService=j,this.router=M;const D=(0,s.inject)(h.n);this.functions=D.getItem(m.$M.FUNCTIONS)||[];const t=this.functions.filter(a=>location.pathname.includes(a.path||""));t||(this.showNotification("No action found"),this.permission={}),this.permission=t?.reduce((a,i)=>(i.code&&(a[i.code]=i.selected||!1),a),{})||{}}showNotification(j){this.notificationService.error("Permission Denied",j)}getPermission(j){return this.permission?.[j]||!1}static#e=this.\u0275fac=function(M){return new(M||R)(s.\u0275\u0275inject(p.NzNotificationService),s.\u0275\u0275inject(d.Router))};static#t=this.\u0275prov=s.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac,providedIn:"root"})}return R})()},79466:(P,E,n)=>{n.d(E,{G:()=>h});var s=n(36151);let h=(()=>{class p{constructor(m,d,v){this.componentFactoryResolver=m,this.appRef=d,this.injector=v}appendComponentToBody(m){const v=this.componentFactoryResolver.resolveComponentFactory(m).create(this.injector);return this.appRef.attachView(v.hostView),document.body.appendChild(v.hostView.rootNodes[0]),v}appendComponentToComponent(m,d){const v=this.componentFactoryResolver.resolveComponentFactory(d);return m.viewContainerRef.createComponent(v)}removeComponentFromBody(m){this.appRef.detachView(m.hostView),m.destroy()}removeComponentFromComponent(m,d){const v=m.viewContainerRef,y=v.indexOf(d.hostView);-1!==y&&v.detach(y),d.destroy()}static#e=this.\u0275fac=function(d){return new(d||p)(s.\u0275\u0275inject(s.ComponentFactoryResolver),s.\u0275\u0275inject(s.ApplicationRef),s.\u0275\u0275inject(s.Injector))};static#t=this.\u0275prov=s.\u0275\u0275defineInjectable({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},53750:(P,E,n)=>{n.d(E,{pm:()=>D,Qi:()=>d,Gj:()=>y.G});var s=n(36151),S=n(66049),h=n(60202),p=n(65893),u=n(71684);n(37586);let d=(()=>{class t{constructor(i,l){this.router=i,this.toastService=l,this.modalCtrl=[],this.destroyRef=(0,s.inject)(s.DestroyRef),this.router.events.pipe((0,p.filter)(o=>o instanceof h.NavigationEnd),(0,S.takeUntilDestroyed)()).subscribe(o=>{for(let g=0,e=this.modalCtrl.length;g<e;g++)this.modalCtrl[g].destroy("onCancel");this.modalCtrl=[]})}showAlertMessageDone(i){this.toastService.success(i)}showAlertMessageError(i){this.toastService.error(i)}static#e=this.\u0275fac=function(l){return new(l||t)(s.\u0275\u0275inject(h.Router),s.\u0275\u0275inject(u.NzMessageService))};static#t=this.\u0275prov=s.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();n(57182);var y=n(79466);n(16564),n(87757);var M=n(33635);let D=179==n.j?(()=>{class t{constructor(i,l){this.router=i,this.activatedRoute=l,this.breadcrumbs$=this.router.events.pipe((0,M.map)(()=>this.createBreadcrumbs(this.activatedRoute.root)))}createBreadcrumbs(i,l="",o=[]){const g=i.children;if(0===g.length)return o;for(const e of g){if(e.snapshot.routeConfig&&e.snapshot.routeConfig.redirectTo)continue;const r=e.snapshot.url.map(f=>f.path).join("/");""!==r&&(l+=`/${r}`);const c=e.snapshot.data.breadcrumb;return c&&o.push({label:c,url:l}),this.createBreadcrumbs(e,l,o)}return console.log(o),o}static#e=this.\u0275fac=function(l){return new(l||t)(s.\u0275\u0275inject(h.Router),s.\u0275\u0275inject(h.ActivatedRoute))};static#t=this.\u0275prov=s.\u0275\u0275defineInjectable({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})():null}}]);