(self.webpackChunkicom=self.webpackChunkicom||[]).push([[9661],{49661:(A,u,t)=>{t.r(u),t.d(u,{IcomLibsComponentsLoginComponent:()=>F});var C=t(49671),e=t(36151),s=t(93484),y=t(60202),g=t(16283),M=t(91029),v=t(54829),l=t(15311),p=t(75150),h=t(87757),m=t(6743),S=t(50038),w=t(59600),P=t(44729),x=t(18019),z=t(49905),O=t(30424),b=t(53750),I=t(66049),j=t(8111),D=t(48290),T=t(8581),L=t(47809);function E(c,H){if(1&c){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",18),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(n);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.togglePasswordVisibility())}),e.\u0275\u0275elementEnd()}if(2&c){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("nzType",n.passwordVisible?"eye-invisible":"eye")}}let F=(()=>{class c{constructor(n){this.fb=n,this.validateForm=this.fb.group({userName:["",[s.Validators.required]],password:["",[s.Validators.required]],remember:[!0]}),this.passwordVisible=!1,this.IcomLibsProjectLoginService=(0,e.inject)(P.qW),this.localStorageService=(0,e.inject)(O.n2),this.iComMessageService=(0,e.inject)(b.Qi),this.destroyRef=(0,e.inject)(e.DestroyRef),this.router=(0,e.inject)(y.Router)}submitForm(){var n=this;if(!this.validateForm.valid)return void Object.values(this.validateForm.controls).forEach(a=>{a?.invalid&&(a?.markAsDirty(),a?.updateValueAndValidity({onlySelf:!0}))});this.isLoading=!0;const r={username:"",password:"",workspaceCode:T.N.workSpaceCode};r.username=this.validateForm.value.userName?.replace(/\s/g,"").toLowerCase()||"",r.password=this.validateForm.value?.password?.replace(/\s/g,"")||"",this.IcomLibsProjectLoginService.loginMerchant({user:"corepoint",password:"123123"}).subscribe(a=>{a?.data?.access_token&&this.localStorageService.setItem("merchantToken",a?.data?.access_token)});const i=(0,x.cloneDeep)(r);var a;i.password=(0,z.sha256)(i.password),this.IcomLibsProjectLoginService.login(i).pipe((0,I.takeUntilDestroyed)(this.destroyRef)).subscribe({next:(a=(0,C.Z)(function*(d){200===d.code&&(n.processPermission(),n.localStorageService.setItem("menu",n.getMenuData()),n.iComMessageService.showAlertMessageDone("Login success"),n.localStorageService.setItem("token",d?.data?.accessToken),n.router.navigateByUrl("/"),n.isLoading=!1)}),function(_){return a.apply(this,arguments)}),error:a=>{this.iComMessageService.showAlertMessageError(a?.error?.error_message||"Login fail"),this.isLoading=!1}})}getMenuData(){const n=this.localStorageService.getItem("permission");return n?[{title:"Product",icon:"shopping-cart",path:"/product",children:[{title:"Voucher",path:"/product/voucher",icon:"appstore"},{title:"Card",path:"/product/card",icon:"appstore"}]},{title:"Inventory",icon:"inventory",path:"/inventory",open:!1,children:[{title:"System Inventory",path:"/inventory"},{title:"Customer Inventory",path:"/inventory/customer"},{title:"Inventory Transfer",path:"/inventory/transfer"}]},{title:"Campaign",icon:"campaign",path:"/campaign",children:[{title:"Management",path:"/campaign/management"},{title:"Batch Reward",path:"/campaign/batch-reward"}]},{title:"Order",icon:"receipt",path:"/order",open:!1,children:[{title:"List Order",path:"/order/list"},{title:"H\u1ea1n m\u1ee9c giao d\u1ecbch",path:"/order/transaction_limit"}]},{title:"Home",icon:"home",path:"/section",open:!1,children:[{title:"Dynamic Section",path:"/section/list"}]},{title:"Flash Sale",icon:"flash_on",path:"/flash-sale",open:!1,children:[{title:"Management",path:"/flash-sale/list"},{title:"Statistic",path:"/flash-sale/statistic"}]},{title:"Permission-Roles",icon:"shop",path:"/permission",open:!1,children:[{title:"Role",path:"/role-permissions/permission"},{title:"Account",path:"/role-permissions/account"}]},{title:"Admin Management",icon:"admin_panel_setting",path:"/admin",open:!1,children:[{title:"Card Management",path:"/admin/card-management"}]},{title:"Customer",icon:"account_circle",path:"/customer",open:!1,children:[{title:"Customer History",path:"/customer/user-history"},{title:"Qu\u1ea3n l\xfd thi\u1ebft b\u1ecb",path:"/customer/device"},{title:"Danh s\xe1ch kh\xe1ch h\xe0ng",path:"/customer/list"}]}].map(o=>({...o,children:o.children?.filter(i=>this.hasSelectedAction(i,n))})).filter(o=>o.children&&o.children.length>0):[]}hasSelectedAction(n,r){const o=r.find(i=>i.sub_modules?.some(a=>a.path===n.path));return o&&o?.sub_modules?.some(i=>i.actions.some(a=>a.selected))||!1}processPermission(){const n=[{sub_modules:[{actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1}],name_vi:"Voucher",name_en:"Voucher",parent:"Product",path:"/product/voucher",selected:!0},{actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1}],name_vi:"Card",name_en:"Card",parent:"Card",path:"/product/card",selected:!0}],name_vi:"Product",name_en:"Product",parent:"Product",selected:!0},{sub_modules:[{actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}],name_vi:"System Inventory",name_en:"System Inventory",parent:"Inventory",path:"/inventory",selected:!0},{actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}],name_vi:"Customer Inventory",name_en:"Customer Inventory",parent:"Inventory",path:"/inventory/customer",selected:!0},{actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}],name_vi:"Inventory",name_en:"Inventory",parent:"Inventory Transfer",path:"/inventory/transfer",selected:!0}],name_vi:"Inventory",name_en:"Inventory",code:"Inventory"},{name_vi:"Campaign",name_en:"Campaign",code:"Campaign",sub_modules:[{name_vi:"Management",name_en:"Management",parent:"Campaign",path:"/campaign/management",actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}],selected:!0},{name_vi:"Statistic",name_en:"Statistic",parent:"Campaign",path:"/campaign/statistic",actions:[{code:"view",name_en:"View",name_vi:"Xem",selected:!0}],selected:!0}]},{name_vi:"Flash Sale",name_en:"Flash Sale",code:"Flash Sale",sub_modules:[{name_vi:"Management",name_en:"Management",parent:"Flash Sale",path:"/flash-sale/list",actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}],selected:!0},{name_vi:"Statistic",name_en:"Statistic",parent:"Flash Sale",path:"/flash-sale/statistic",actions:[{code:"view",name_en:"View",name_vi:"Xem",selected:!0}],selected:!0}]},{name_vi:"Order",name_en:"Order",code:"Order",sub_modules:[{name_vi:"List Order",name_en:"List Order",parent:"Order",path:"/order/list",actions:[{code:"view",name_en:"View",name_vi:"Xem",selected:!0}],selected:!0},{name_vi:"H\u1ea1n m\u1ee9c giao d\u1ecbch",name_en:"H\u1ea1n m\u1ee9c giao d\u1ecbch",parent:"Order",path:"/order/transaction_limit",actions:[{code:"view",name_en:"View",name_vi:"Xem",selected:!0}],selected:!0}]},{name_vi:"Home",name_en:"Home",parent:"Home",sub_modules:[{name_vi:"Dynamic Section",name_en:"Dynamic Section",parent:"Home",path:"/section/list",actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}],selected:!0}]},{name_vi:"Permission-Roles",name_en:"Permission-Roles",parent:"Role",selected:!1,sub_modules:[{name_vi:"Role",name_en:"Role",parent:"Role",path:"/role-permissions/permission",actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!1,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!1,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!1,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!1,order:4}],selected:!1},{name_vi:"Account",name_en:"Account",parent:"Role",path:"/role-permissions/account",selected:!1,actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!1,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!1,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!1,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!1,order:4}]}]},{name_vi:"Admin Management",name_en:"Admin Management",parent:"Admin",selected:!0,sub_modules:[{name_vi:"Card Management",name_en:"Card Management",parent:"Admin",path:"/admin/card-management",selected:!0,actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}]}]},{name_vi:"Customer",name_en:"Customer",parent:"Customer",selected:!0,sub_modules:[{name_vi:"User History",name_en:"User History",parent:"Customer",path:"/customer/user-history",selected:!0,actions:[{description:"",code:"add",name_en:"Create",name_vi:"Th\xeam",selected:!0,order:3},{description:"",code:"edit",name_en:"Edit",name_vi:"S\u1eeda",selected:!0,order:2},{description:"",code:"view",name_en:"View",name_vi:"Xem",selected:!0,order:1},{code:"delete",name_en:"Delete",name_vi:"X\xf3a",selected:!0,order:4}]}]}];this.flattenPermissions(n),this.localStorageService.setItem("permission",n)}flattenPermissions(n){let r=[];return n.forEach(o=>{const{name_vi:i,name_en:a,parent:d}=o;o?.sub_modules?.forEach(_=>{const{path:X,actions:f}=_;f?.length&&f?.forEach(R=>{r.push({...R,name_vi:i,name_en:a,parent:d,path:X})})})}),this.localStorageService.setItem(j.$M.FUNCTIONS,r),r}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}static#e=this.\u0275fac=function(r){return new(r||c)(e.\u0275\u0275directiveInject(s.NonNullableFormBuilder))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:c,selectors:[["icom-libs-components-login"]],standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:27,vars:12,consts:[[1,"head","flex","justify-center"],["alt","",1,"logo",3,"src"],[1,"container","mx-auto","p-4","max-w-md","mt-10","bg-white","rounded-lg","shadow-md","border","overflow-hidden"],[1,"space-y-4",3,"formGroup","ngSubmit"],[1,"form-group"],["nzErrorTip","enter your username.",1,"text-left"],["nzPrefixIcon","user",3,"nzSize"],["type","text","formControlName","userName","nz-input","","placeholder","Please input your username",3,"placeholder"],["nzErrorTip","enter your password.",1,"text-left"],["nzPrefixIcon","lock",3,"nzSize","nzSuffix"],["autocomplete","on","formControlName","password","nz-input","","placeholder","Password",3,"type","placeholder"],["suffixTemplate",""],[1,"flex","justify-center"],["nz-button","","nzSize","default",1,"login-form-button",2,"width","auto","padding","5px 30px",3,"nzType","nzLoading"],[1,"flex","items-center","justify-between","mt-4"],[1,"w-1/5","border-b","dark:border-gray-600","lg:w-1/4"],["href","#",1,"text-xs","text-center","text-gray-500","uppercase"],[1,"fixed","bottom-0","right-0","mb-2","mr-2","text-gray-500","text-xs"],["nz-icon","",1,"text-base",3,"nzType","click"]],template:function(r,o){if(1&r&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"img",1),e.\u0275\u0275pipe(2,"icomLibsCoreGetEnv"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",2)(4,"label"),e.\u0275\u0275text(5,"Login"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"form",3),e.\u0275\u0275listener("ngSubmit",function(){return o.submitForm()}),e.\u0275\u0275elementStart(7,"nz-form-item",4)(8,"nz-form-control",5)(9,"nz-input-group",6),e.\u0275\u0275element(10,"input",7),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(11,"nz-form-item",4)(12,"nz-form-control",8)(13,"nz-input-group",9),e.\u0275\u0275element(14,"input",10),e.\u0275\u0275template(15,E,1,1,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(17,"div",12)(18,"button",13),e.\u0275\u0275text(19,"SIGN IN"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"div",14),e.\u0275\u0275element(21,"span",15),e.\u0275\u0275elementStart(22,"a",16),e.\u0275\u0275text(23,"or login with"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"span",15),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(25,"div",17),e.\u0275\u0275text(26," Version v1.3.4.1\n"),e.\u0275\u0275elementEnd()),2&r){const i=e.\u0275\u0275reference(16);e.\u0275\u0275advance(1),e.\u0275\u0275property("src",e.\u0275\u0275pipeBind1(2,10,"banner"),e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",o.validateForm),e.\u0275\u0275advance(3),e.\u0275\u0275property("nzSize","large"),e.\u0275\u0275advance(1),e.\u0275\u0275property("placeholder","Please input your username"),e.\u0275\u0275advance(3),e.\u0275\u0275property("nzSize","large")("nzSuffix",i),e.\u0275\u0275advance(1),e.\u0275\u0275property("type",o.passwordVisible?"text":"password")("placeholder","Password"),e.\u0275\u0275advance(4),e.\u0275\u0275property("nzType","primary")("nzLoading",o.isLoading)}},dependencies:[s.FormsModule,s.\u0275NgNoValidate,s.DefaultValueAccessor,s.NgControlStatus,s.NgControlStatusGroup,l.NzFormModule,p.NzColDirective,p.NzRowDirective,l.NzFormItemComponent,l.NzFormControlComponent,D.Bp,s.ReactiveFormsModule,s.FormGroupDirective,s.FormControlName,w.NzTabsModule,p.NzGridModule,g.NzButtonModule,g.NzButtonComponent,L.\u0275NzTransitionPatchDirective,v.NzWaveDirective,m.NzInputModule,m.NzInputDirective,m.NzInputGroupComponent,m.NzInputGroupWhitSuffixOrPrefixDirective,v.NzWaveModule,M.NzCheckboxModule,h.NzIconModule,h.NzIconDirective,S.NzNotificationModule],styles:[".container-login[_ngcontent-%COMP%]{width:100%;min-height:100%;background-size:100%;background-color:#c4cdcd}.container-login[_ngcontent-%COMP%]   .lang[_ngcontent-%COMP%]{width:100%;height:40px;text-align:right}.container-login[_ngcontent-%COMP%]   .lang[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:24px;padding:12px;font-size:18px;cursor:pointer}.container-login[_ngcontent-%COMP%]   .content-layout[_ngcontent-%COMP%]{padding:32px 0 0;text-align:center}.container-login[_ngcontent-%COMP%]   .content-layout[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.container-login[_ngcontent-%COMP%]   .content-layout[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{margin-right:16px}.container-login[_ngcontent-%COMP%]   .content-layout[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{position:relative;font-weight:600;font-size:33px;font-family:Myriad Pro,Helvetica Neue,Arial,Helvetica,sans-serif;vertical-align:middle}.container-login[_ngcontent-%COMP%]   .content-layout[_ngcontent-%COMP%]   .desc[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:40px}.login-form-wrap[_ngcontent-%COMP%]{width:368px;margin:0 auto}@media screen and (max-width: 375px){.login-form-wrap[_ngcontent-%COMP%]{padding:0 15px}}.login-form-wrap[_ngcontent-%COMP%]   .login-form-margin[_ngcontent-%COMP%]{margin-bottom:18px}.login-form-wrap[_ngcontent-%COMP%]   .login-form-forgot[_ngcontent-%COMP%]{float:right}.login-form-wrap[_ngcontent-%COMP%]   .login-form-button[_ngcontent-%COMP%]{width:100%}.login-form-wrap[_ngcontent-%COMP%]   .other-login[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:200px}.login-form-wrap[_ngcontent-%COMP%]   .other-login[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}.login-form-wrap[_ngcontent-%COMP%]   .other-login[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#1890ff;cursor:pointer}.login-form-wrap[_ngcontent-%COMP%]   .other-way[_ngcontent-%COMP%]{display:flex;justify-content:space-between}label[_ngcontent-%COMP%]{display:flex;font-family:Cambria,Cochin,Georgia,Times,Times New Roman,serif;font-weight:700;font-size:35px;margin:0 0 40px 165px}.logo[_ngcontent-%COMP%]{margin:40px 0 -10px}button[_ngcontent-%COMP%]{margin-top:10px}"]})}return c})()}}]);