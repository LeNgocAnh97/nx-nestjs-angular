(self.webpackChunkicom=self.webpackChunkicom||[]).push([[6961],{67786:(T,y,o)=>{o.d(y,{E:()=>e});var u=o(36151),f=o(248);let e=(()=>{class c{constructor(p,l){this.el=p,this.permissionService=l}ngOnInit(){this.permissionService.getPermission(this.action)||this.el.nativeElement.style.setProperty("display","none","important")}static#e=this.\u0275fac=function(l){return new(l||c)(u.\u0275\u0275directiveInject(u.ElementRef),u.\u0275\u0275directiveInject(f.$))};static#t=this.\u0275dir=u.\u0275\u0275defineDirective({type:c,selectors:[["","icomLibsHasPermissionDirective",""]],inputs:{action:"action"},standalone:!0})}return c})()},67652:(T,y,o)=>{o.d(y,{EC:()=>p,JC:()=>f,Jj:()=>e,KB:()=>u,l0:()=>c,uv:()=>C});const u=["FLASH_SALE","QUICK_BUTTONS","MYPOINT_HOT","TRACK_ELECTRICITY","ALERT_THRESHOLD"],f=()=>[{value:"Th\xe1ng 1",id:1},{value:"Th\xe1ng 2",id:2},{value:"Th\xe1ng 3",id:3},{value:"Th\xe1ng 4",id:4},{value:"Th\xe1ng 5",id:5},{value:"Th\xe1ng 6",id:6},{value:"Th\xe1ng 7",id:7},{value:"Th\xe1ng 8",id:8},{value:"Th\xe1ng 9",id:9},{value:"Th\xe1ng 10",id:10},{value:"Th\xe1ng 11",id:11},{value:"Th\xe1ng 12",id:12}],e=()=>[{value:"Ng\xe0y 1",id:1},{value:"Ng\xe0y 2",id:2},{value:"Ng\xe0y 3",id:3},{value:"Ng\xe0y 4",id:4},{value:"Ng\xe0y 5",id:5},{value:"Ng\xe0y 6",id:6},{value:"Ng\xe0y 7",id:7},{value:"Ng\xe0y 8",id:8},{value:"Ng\xe0y 9",id:9},{value:"Ng\xe0y 10",id:10},{value:"Ng\xe0y 11",id:11},{value:"Ng\xe0y 12",id:12},{value:"Ng\xe0y 13",id:13},{value:"Ng\xe0y 14",id:14},{value:"Ng\xe0y 15",id:15},{value:"Ng\xe0y 16",id:16},{value:"Ng\xe0y 17",id:17},{value:"Ng\xe0y 18",id:18},{value:"Ng\xe0y 19",id:19},{value:"Ng\xe0y 20",id:20},{value:"Ng\xe0y 21",id:21},{value:"Ng\xe0y 22",id:22},{value:"Ng\xe0y 23",id:23},{value:"Ng\xe0y 24",id:24},{value:"Ng\xe0y 25",id:25},{value:"Ng\xe0y 26",id:26},{value:"Ng\xe0y 27",id:27},{value:"Ng\xe0y 28",id:28},{value:"Ng\xe0y 29",id:29},{value:"Ng\xe0y 30",id:30},{value:"Ng\xe0y 31",id:31}],c=()=>[{value:"Th\u1ee9 2",id:1},{value:"Th\u1ee9 3",id:2},{value:"Th\u1ee9 4",id:3},{value:"Th\u1ee9 5",id:4},{value:"Th\u1ee9 6",id:5},{value:"Th\u1ee9 7",id:6},{value:"Ch\u1ee7 nh\u1eadt",id:0}],C=()=>[{value:"0 gi\u1edd",id:0},{value:"1 gi\u1edd",id:1},{value:"2 gi\u1edd",id:2},{value:"3 gi\u1edd",id:3},{value:"4 gi\u1edd",id:4},{value:"5 gi\u1edd",id:5},{value:"6 gi\u1edd",id:6},{value:"7 gi\u1edd",id:7},{value:"8 gi\u1edd",id:8},{value:"9 gi\u1edd",id:9},{value:"10 gi\u1edd",id:10},{value:"11 gi\u1edd",id:11},{value:"12 gi\u1edd",id:12},{value:"13 gi\u1edd",id:13},{value:"14 gi\u1edd",id:14},{value:"15 gi\u1edd",id:15},{value:"16 gi\u1edd",id:16},{value:"17 gi\u1edd",id:17},{value:"18 gi\u1edd",id:18},{value:"19 gi\u1edd",id:19},{value:"20 gi\u1edd",id:20},{value:"21 gi\u1edd",id:21},{value:"22 gi\u1edd",id:22},{value:"23 gi\u1edd",id:23}],p=()=>[{value:"Ng\u1eebng k\xedch ho\u1ea1t",id:"INACTIVE"},{value:"K\xedch ho\u1ea1t",id:"ACTIVE"}]},96961:(T,y,o)=>{o.r(y),o.d(y,{IComLibsSectionDetailComponent:()=>X});var u=o(49671),f=o(79466),e=o(36151),c=o(93484),C=o(13391),p=o(44729),l=o(33635),z=o(14817),L=o(57317),M=o(87757),_=o(63801),S=o(38831),I=o(67056),V=o(59600),j=o(47332),N=o(60202),R=o(37586),x=o(15311),m=o(67652),k=o(8111),D=o(16283),b=o(18019),F=o(32936),H=o(53750),P=o(91872),A=o(66049),B=o(67786),O=o(27493),E=o(8581),w=o(47809),G=o(54829);function U(r,h){if(1&r&&(e.\u0275\u0275elementStart(0,"form",6)(1,"div",7)(2,"div",8),e.\u0275\u0275element(3,"formly-form",9),e.\u0275\u0275elementEnd()()()),2&r){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("formGroup",t.form),e.\u0275\u0275advance(3),e.\u0275\u0275property("model",t.model)("fields",t.fields)("form",t.form)("options",t.options)}}function Y(r,h){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",11),e.\u0275\u0275listener("click",function(n){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.handlerCancel(n))}),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"H\u1ee7y"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}2&r&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("action","add"))}function K(r,h){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",12),e.\u0275\u0275listener("click",function(n){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.handlerSave(n))}),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"L\u01b0u"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&r){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("action","edit")("nzLoading",t.isLoading)}}function W(r,h){1&r&&(e.\u0275\u0275elementStart(0,"nz-space"),e.\u0275\u0275template(1,Y,4,1,"ng-container",10),e.\u0275\u0275template(2,K,4,2,"ng-container",10),e.\u0275\u0275elementEnd())}function J(r,h){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",11),e.\u0275\u0275listener("click",function(n){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.handlerEdit(n))}),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"S\u1eeda"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}2&r&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("action","edit"))}function Z(r,h){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",13),e.\u0275\u0275listener("click",function(n){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(a.handlerRemove(n))}),e.\u0275\u0275elementStart(2,"span"),e.\u0275\u0275text(3,"X\xf3a"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&r){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("action","delete")("nzLoading",t.isLoading)("nzDanger",!0)}}function $(r,h){1&r&&(e.\u0275\u0275elementStart(0,"nz-space"),e.\u0275\u0275template(1,J,4,1,"ng-container",10),e.\u0275\u0275template(2,Z,4,3,"ng-container",10),e.\u0275\u0275elementEnd())}function Q(r,h){if(1&r){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"nz-page-header",1),e.\u0275\u0275listener("nzBack",function(){e.\u0275\u0275restoreView(t);const n=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(n.handlerCancel())}),e.\u0275\u0275elementStart(1,"nz-page-header-title"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"nz-page-header-content",2),e.\u0275\u0275template(4,U,4,5,"form",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"nz-page-header-footer",4),e.\u0275\u0275template(6,W,3,0,"nz-space",5),e.\u0275\u0275template(7,$,3,0,"nz-space",5),e.\u0275\u0275elementEnd()()}if(2&r){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.data.name||"T\u1ea1o m\u1edbi"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.shouldRender),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","edit"===t.mode||"add"===t.mode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","only_view"!==t.mode&&"edit"!==t.mode&&"add"!==t.mode)}}let X=(()=>{class r{startTimeValidator(t){const i=t.parent?.value?.start_time,n=t.parent?.value?.end_time;return i&&n&&P(n).isBefore(P(i).add(5,"minute"))?{startTimeInvalid5Minutes:!0}:null}constructor(){var t=this;this.form=new c.FormGroup({}),this.options={},this.route=(0,e.inject)(N.ActivatedRoute),this.cdr=(0,e.inject)(e.ChangeDetectorRef),this.modalService=(0,e.inject)(R.NzModalService),this.router=(0,e.inject)(N.Router),this.localStorage=(0,e.inject)(O.n),this.iComLibsServicesProjectDynamicHomeService=(0,e.inject)(p.KL),this.iComLibsServicesProductService=(0,e.inject)(p.k),this.IComMessageService=(0,e.inject)(H.Qi),this.icomLibsDynamicComponentService=(0,e.inject)(f.G),this.initialDataLoaded=!1,this.isFirstChange=!0,this.destroyRef=(0,e.inject)(e.DestroyRef),this.fields=[],this.shouldRender=!0,this.mode="view",this.form.get("name")?.valueChanges.pipe((0,l.distinctUntilChanged)()).subscribe(()=>{this.form.get("name")?.updateValueAndValidity()}),this.route.queryParams.pipe((0,A.takeUntilDestroyed)(this.destroyRef)).subscribe(function(){var i=(0,u.Z)(function*(n){if(n){if(t.mode=n.mode,!n.id)return t.data={content_conf:{status:{value:[]}}},t.model=(0,b.cloneDeep)(t.data),t.setFields(),t.updateFieldReadonlyStatus(),void(t.options={formState:{disabled:!1,required:!1,mainModel:t.model}});const a=n?.id||"",s=yield(0,l.lastValueFrom)(t.iComLibsServicesProjectDynamicHomeService.detail(a));t.data=s?.data||{},m.KB.includes(t.data?.type||"aaa")&&(t.mode="only_view"),t.model=(0,b.cloneDeep)(t.data),t.setFields(),t.updateFieldReadonlyStatus(),t.initialDataLoaded=!0,t.options={formState:{disabled:!1,required:!1,mainModel:t.model}},t.cdr?.detectChanges()}});return function(n){return i.apply(this,arguments)}}())}firstLetterUppercaseValidator(t){return t.value&&!/^\s*[A-Z\xc1\xc0\u1ea2\xc3\u1ea0\u0102\u1eae\u1eb0\u1eb2\u1eb4\u1eb6\xc2\u1ea4\u1ea6\u1ea8\u1eaa\u1eac\xc9\xc8\u1eba\u1ebc\u1eb8\xca\u1ebe\u1ec0\u1ec2\u1ec4\u1ec6\xcd\xcc\u1ec8\u0128\u1eca\xd3\xd2\u1ece\xd5\u1ecc\xd4\u1ed0\u1ed2\u1ed4\u1ed6\u1ed8\u01a0\u1eda\u1edc\u1ede\u1ee0\u1ee2\xda\xd9\u1ee6\u0168\u1ee4\u01af\u1ee8\u1eea\u1eec\u1eee\u1ef0\xdd\u1ef2\u1ef6\u1ef8\u1ef4\u0110].*/.test(t.value)?{firstLetterUppercase:!0}:null}setFields(){const i=this.localStorage.getTokenData().working_site_id;console.log(i),this.fields=[{fieldGroupClassName:"flex flex-col",className:"basis-1/2",key:"",wrappers:["group"],props:{label:"Th\xf4ng tin chung"},expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"name",className:"basis-4/12",type:"input-custom",props:{label:"T\xean",required:!0,maxLength:30,placeholder:"Nh\u1eadp t\xean",readonly:!0},validators:{firstLetterUppercase:{expression:n=>null===this.firstLetterUppercaseValidator(n),message:(n,a)=>"T\xean ph\u1ea3i b\u1eaft \u0111\u1ea7u b\u1eb1ng m\u1ed9t ch\u1eef c\xe1i vi\u1ebft hoa."},validation:[{name:"noWhitespace",options:{errorPath:"value"}}]}},{key:"display_conf.start_time",type:"date",props:{label:"T\u1eeb",ShowTime:!0,required:!0,datepickerOptions:{nzFormat:"dd/MM/yyyy HH:mm"},readonly:!0,format:"dd-MM-yyyy HH:mm",placeholder:"DD-MM-YYYY hh:mm",change:(n,a)=>{n?.parent?.fieldGroup?.find(d=>"display_conf.end_time"===d.key)&&this.form.get("display_conf.end_time")?.updateValueAndValidity()}},validators:{validation:[this.startTimeValidator]}},{key:"display_conf.end_time",type:"date",props:{label:"\u0110\u1ebfn",required:!0,ShowTime:!0,format:"dd-MM-yyyy HH:mm",placeholder:"DD-MM-YYYY hh:mm",datepickerOptions:{nzFormat:"dd/MM/yyyy HH:mm"},readonly:!0,change:(n,a)=>{n?.parent?.fieldGroup?.find(d=>"display_conf.start_time"===d.key)&&this.form.get("display_conf.start_time")?.updateValueAndValidity()}},validators:{validation:[this.startTimeValidator]}},{key:"display_conf.months",type:"select-custom",defaultValue:[],props:{label:"Theo th\xe1ng",multiple:!0,viewValue:"value",readonly:!0,labelProp:"value",valueProp:"id",options:(0,m.JC)(),placeholder:"Ch\u1ecdn th\xe1ng"}},{key:"display_conf.days",type:"select-custom",defaultValue:[],props:{label:"Theo ng\xe0y",multiple:!0,viewValue:"value",readonly:!0,labelProp:"value",valueProp:"id",options:(0,m.Jj)(),placeholder:"Ch\u1ecdn ng\xe0y"}},{key:"display_conf.weekdays",type:"select-custom",defaultValue:[],props:{label:"Theo th\u1ee9",multiple:!0,readonly:!0,viewValue:"value",labelProp:"value",valueProp:"id",options:(0,m.l0)(),placeholder:"Ch\u1ecdn th\u1ee9"}},{key:"display_conf.hours",type:"select-custom",defaultValue:[],props:{label:"Theo gi\u1edd",multiple:!0,readonly:!0,viewValue:"value",labelProp:"value",valueProp:"id",options:(0,m.uv)(),placeholder:"Ch\u1ecdn gi\u1edd"}}]},{fieldGroupClassName:"flex flex-col mt-4",className:"basis-1/2 pl-4 mt-4",key:"",wrappers:["group"],expressions:{"props.disabled":"formState.disabled"},fieldGroup:[{key:"display_conf.membership_rank",type:"select-custom",defaultValue:[],props:{label:"H\u1ea1ng h\u1ed9i vi\xean",viewValue:"value",labelProp:"value",readonly:!0,valueProp:"id",multiple:!0,options:this.iComLibsServicesProjectDynamicHomeService.listMembersShip().pipe((0,l.map)(n=>n?.data))}},{key:"display_conf.city",type:"select-custom",defaultValue:[],props:{label:"T\u1ec9nh/ th\xe0nh ph\u1ed1",viewValue:"value",labelProp:"value",valueProp:"id",multiple:!0,readonly:!0,options:this.iComLibsServicesProjectDynamicHomeService.listCity().pipe((0,l.map)(n=>n?.data))}},{key:"status",type:"radio-custom",defaultValue:"ACTIVE",props:{label:"Tr\u1ea1ng th\xe1i",readonly:!0,viewValue:"value",labelProp:"value",valueProp:"id",options:[{value:"K\xedch ho\u1ea1t",id:"ACTIVE"},{value:"Ng\u1eebng k\xedch ho\u1ea1t",id:"INACTIVE"}]}},{key:"note",type:"textarea-custom",props:{label:"Ghi ch\xfa",rows:5,placeholder:"Nh\u1eadp n\u1ed9i dung",readonly:!0,maxLength:500}}]},{fieldGroupClassName:"flex-col",key:"",wrappers:["group"],props:{label:"N\u1ed9i dung hi\u1ec3n th\u1ecb"},expressions:{"props.disabled":"formState.disabled"},className:"w-full",fieldGroup:[{key:"type",type:"select-custom",className:"w-[500px]",props:{label:"\u0110\u1ed1i t\u01b0\u1ee3ng",viewValue:"value",required:!0,readonly:!0,labelProp:"value",placeholder:"Ch\u1ecdn \u0111\u1ed1i t\u01b0\u1ee3ng hi\u1ec3n th\u1ecb",valueProp:"id",options:this.iComLibsServicesProjectDynamicHomeService.listContentType("edit"===this.mode||"add"===this.mode?{screen_type:"SECTION_CREATE"}:{}).pipe((0,l.map)(n=>{const a=n.data.map(s=>({...s,placeholder:`T\xecm ki\u1ebfm ${s.value}`,...this.getApiServiceByIdType(s.id)}));return console.log(a),a}))},hooks:{onInit:n=>{const a=n?.form;n?.formControl?.valueChanges?.pipe((0,l.distinctUntilChanged)()).subscribe(s=>{a?.patchValue({layout:"",content_conf:{status:{name:"",value:[]}}},{emitEvent:!0})})}}},{key:"layout",type:"radio-custom",props:{viewValue:"value",labelProp:"value",valueProp:"id",readonly:!0,label:"D\u1ea1ng hi\u1ec3n th\u1ecb",options:[]},hooks:{onInit:n=>{const a=n?.parent?.parent?.form?.get("type");a&&(n.props.options=a.valueChanges.pipe((0,l.startWith)(a.value),(0,l.concatMap)(s=>this.iComLibsServicesProjectDynamicHomeService.listLayoutByContentType({content_type:s||n?.parent?.parent?.form?.value?.type}).pipe((0,l.map)(v=>0===v?.data?.length?(n.className="hidden",void(n={...n})):(n.props.required=!0,n.className="basis-2/12 flex",v.data.map((g,q)=>({...g,disabled:g.disable}))))))))}},hideExpression:n=>!n?.type||!n?.type||m.KB.includes(n.type)},{key:"content_conf.no_items",type:"nz-input-number",className:"basis-2/12 flex",defaultValue:E.N.defaultDisplay||5,props:{label:"S\u1ed1 l\u01b0\u1ee3ng hi\u1ec3n th\u1ecb",type:"number",required:!0,readonly:!0,min:1,max:10},hideExpression:(n,a,s)=>!n?.type||"MY_VOUCHERS"!==n?.type},{key:"content_conf",hideExpression:(n,a,s)=>!a?.mainModel?.type||m.KB.includes(a?.mainModel?.type)||"MY_VOUCHERS"===a?.mainModel?.type||"EP_TRACK_ELECTRICITY"===a?.mainModel?.type||"EP_ALERT_THRESHOLD"===a?.mainModel?.type,fieldGroupClassName:"flex-col",fieldGroup:[{key:"status.name",type:"radio-custom",props:{label:"Tr\u1ea1ng th\xe1i",options:[],readonly:!0,viewValue:"value",labelProp:"value",valueProp:"id"},hooks:{onInit:n=>{const a=n?.parent?.parent?.form?.get("type");a&&(n.props.options=a.valueChanges.pipe((0,l.startWith)(a.value),(0,l.filter)(()=>!(this.isFirstChange&&!n.props.readonly&&(this.isFirstChange=!1,1))),(0,l.concatMap)(s=>this.iComLibsServicesProjectDynamicHomeService.listStatusByContentType({content_type:s}).pipe((0,l.map)(d=>{if(d?.data?.length)return n.className="basis-2/12 flex",!1===this.initialDataLoaded&&n.formControl.setValue(d?.data[0].id),this.initialDataLoaded&&(this.initialDataLoaded=!1),d.data.map(v=>({...v}));n.className="hidden"})))))}}},{key:"no_items",type:"nz-input-number",className:"basis-2/12 flex",defaultValue:E.N.defaultDisplay||5,props:{label:"S\u1ed1 l\u01b0\u1ee3ng hi\u1ec3n th\u1ecb",type:"number",required:!0,readonly:!0,min:0,max:10},hideExpression:(n,a,s)=>(console.log(a?.mainModel?.content_conf?.status?.name),!a?.mainModel?.type||"BANNERS"===a?.mainModel?.type||"EP_BANNERS"===a?.mainModel?.type||"selection"===a?.mainModel?.content_conf?.status?.name)},{key:"hidden_name",type:"checkbox",defaultValue:!this.model?.content_conf?.hidden_name,props:{readonly:!0,disabled:!0,label:"Hi\u1ec3n th\u1ecb t\xean section"},hideExpression:(n,a,s)=>!a?.mainModel?.type||"BANNERS"!==a?.mainModel?.type&&"EP_BANNERS"!==a?.mainModel?.type},{key:"slider_speed",type:"nz-input-number",className:"basis-2/12 flex",defaultValue:3,props:{readonly:!0,label:"T\u1ed1c \u0111\u1ed9 tr\u01b0\u1ee3t trong slide (gi\xe2y)",type:"number",required:!0,min:2,max:5},hideExpression:(n,a,s)=>!a?.mainModel?.type||"BANNERS"!==a?.mainModel?.type&&"EP_BANNERS"!==a?.mainModel?.type},{key:"status.value",type:"dropdown-table",defaultValue:[],props:{columns:[{name:"STT",width:"10%",field:"index",type:"index"},{name:"T\xean",width:"30%",field:"value",type:"text"},{name:"H\xe0nh \u0111\u1ed9ng",width:"20%",field:"actions",type:"action"}],placeholder:"",readonly:!0,listOptionDropdown:null,changeItems:n=>{this.model?.content_conf?.status&&(this.model.content_conf.status.value=n||[])}},hideExpression:(n,a,s)=>!a?.mainModel?.type||"selection"!==a?.mainModel?.content_conf?.status?.name,hooks:{onInit:n=>{const a=n.parent?.parent?.fieldGroup?.find(s=>"type"===s.key);a?.formControl&&a.formControl?.valueChanges.pipe((0,l.startWith)(a?.formControl?.value)).subscribe(s=>{a?.props?.options?.subscribe(d=>{const v=d.find(g=>g.id===s);n.props&&(n.props.placeholder=v?.placeholder),console.log("vao"),n.props&&(n.props.listOptionDropdown=()=>v?.apiObs.pipe((0,l.map)(g=>g.data))),console.log(n),n={...n}})})}}}]}]}],"20984"===i&&(this.fields[1].fieldGroup=this.fields[1]?.fieldGroup?.filter(n=>"display_conf.membership_rank"!==n.key&&"display_conf.city"!==n.key),this.fields[1]?.fieldGroup?.unshift({key:"display_conf.area",type:"select-custom",defaultValue:[],props:{label:"Khu v\u1ef1c",viewValue:"value",labelProp:"value",valueProp:"id",multiple:!0,readonly:!0,options:this.iComLibsServicesProjectDynamicHomeService.listArea().pipe((0,l.map)(n=>n?.data))}})),this.fields=[...this.fields]}handlerCancel(t){t?.stopPropagation(),t?.preventDefault(),"view"!==this.mode&&"only_view"!==this.mode?this.modalService.confirm({nzTitle:this.model?.id?"B\u1ea1n c\xf3 h\u1ee7y b\u1ecf thao t\xe1c ?":"B\u1ea1n c\xf3 mu\u1ed1n h\u1ee7y th\xeam m\u1edbi menu \u0111\u1ed9ng kh\xf4ng?",nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzMaskClosable:!1,nzClosable:!0,nzOnOk:()=>this.router.navigateByUrl("section/list"),nzCancelText:"\u0110\xf3ng"},"info"):this.router.navigateByUrl("section/list")}handlerRemove(t){t.stopPropagation(),this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a ${this.data?.name} ?`,nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDeleteSection.bind(this,this.data),nzCancelText:"H\u1ee7y b\u1ecf"},"error")}processDeleteSection(t){return(0,l.lastValueFrom)(this.iComLibsServicesProjectDynamicHomeService.delete(t?.id||"")).then(()=>{this.IComMessageService.showAlertMessageDone("Thao t\xe1c th\xe0nh c\xf4ng."),this.router.navigateByUrl("section/list")}).catch(i=>{this.IComMessageService.showAlertMessageError(i?.error?.error_message||"Thao t\xe1c th\u1ea5t b\u1ea1i")})}validate(){return!(!this.model?.content_conf?.status?.value?.length&&"selection"===this.model?.content_conf?.status?.name&&(this.IComMessageService.showAlertMessageError("Tr\u1ea1ng th\xe1i l\xe0 T\xf9y ch\u1ecdn b\u1eaft bu\u1ed9c ph\u1ea3i th\xeam d\u1eef li\u1ec7u."),1))}trimFormFields(){const t=this.model;Object.keys(t).forEach(i=>{"string"==typeof t[i]&&(t[i]=t[i].trim())})}handlerSave(t){var i=this;return(0,u.Z)(function*(){if(t.stopPropagation(),t.preventDefault(),i.trimFormFields(),console.log(i.form),i.form.invalid)(0,k.c2)(i.form);else if(i.validate()){i.model&&i.model.content_conf&&void 0!==i.model.content_conf.hidden_name&&(i.model.content_conf.hidden_name=!i.model.content_conf.hidden_name);try{i.isLoading=!0,i.data?.id?yield(0,l.lastValueFrom)(i.iComLibsServicesProjectDynamicHomeService.edit(i.model)):yield(0,l.lastValueFrom)(i.iComLibsServicesProjectDynamicHomeService.create(i.model)),i.IComMessageService.showAlertMessageDone(i.data?.id?"S\u1eeda m\u1edbi menu \u0111\u1ed9ng th\xe0nh c\xf4ng.":"T\u1ea1o m\u1edbi menu \u0111\u1ed9ng th\xe0nh c\xf4ng."),i.router.navigateByUrl("section/list")}catch(n){console.log(n),i.IComMessageService.showAlertMessageError(n?.error?.error_message||i.data?.id?"S\u1eeda menu \u0111\u1ed9ng th\u1ea5t b\u1ea1i.":"T\u1ea1o m\u1edbi menu \u0111\u1ed9ng th\u1ea5t b\u1ea1i.")}finally{i.isLoading=!1,i.cdr.detectChanges()}}})()}forceRerender(){this.shouldRender=!1,this.cdr?.detectChanges(),setTimeout(()=>{this.shouldRender=!0,this.cdr?.detectChanges()})}handlerEdit(t){t.stopPropagation(),t.preventDefault(),this.mode="edit",this.isFirstChange=!0,this.model=(0,b.cloneDeep)(this.data),this.setFields(),this.updateFieldReadonlyStatus(),this.initialDataLoaded=!0,this.forceRerender(),this.options={formState:{disabled:!1,required:!1,mainModel:this.model}}}getApiServiceByIdType(t){switch(console.log(t),t){case"BRANDS":return{placeholder:"Th\xeam theo t\xean th\u01b0\u01a1ng hi\u1ec7u",apiObs:this.iComLibsServicesProductService.getBrands()};case"POINT_PARTNERS":return{placeholder:"Th\xeam theo \u0111\u1ed1i t\xe1c ho\xe0n \u0111i\u1ec3m",apiObs:this.iComLibsServicesProductService.getPointPartner()};case"CAMPAIGNS":return{placeholder:"Th\xeam theo t\xean campaign",apiObs:this.iComLibsServicesProductService.getCampaign()};case"PRODUCTS":return{placeholder:"Th\xeam theo m\xe3, t\xean s\u1ea3n ph\u1ea9m",apiObs:this.iComLibsServicesProductService.getSearchProduct()};case"BANNERS":return{placeholder:"Th\xeam theo t\xean banner",apiObs:this.iComLibsServicesProductService.getBanners()};case"EP_CAMPAIGNS":return{placeholder:"Th\xeam theo t\xean campaign",apiObs:this.iComLibsServicesProjectDynamicHomeService.getCampaign({limit:99999,offset:1})};case"EP_BANNERS":return{placeholder:"Th\xeam theo t\xean banner",apiObs:this.iComLibsServicesProjectDynamicHomeService.getBanners({limit:99999,offset:1})};case"EP_PRODUCTS":return{placeholder:"Th\xeam theo m\xe3, t\xean s\u1ea3n ph\u1ea9m",apiObs:this.iComLibsServicesProjectDynamicHomeService.getVouchers({limit:99999,offset:1})};default:return(0,l.of)()}}updateFieldReadonlyStatus(){let t=!0;("edit"===this.mode||"add"===this.mode)&&(t=!1),this.fields.forEach(i=>{this.setReadonlyForField(i,t)})}setReadonlyForField(t,i){t.fieldGroup?t.fieldGroup.forEach(n=>this.setReadonlyForField(n,i)):t.props&&(t.props.readonly=i,t.props.disabled=i)}static#e=this.\u0275fac=function(i){return new(i||r)};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-custom-form"]],inputs:{data:"data",mode:"mode"},standalone:!0,features:[e.\u0275\u0275StandaloneFeature],decls:1,vars:1,consts:[["class","h-full w-full flex flex-col !absolute top-0 left-0 !py-4 !pl-4 !pr-0 !bg-[#f0f2f5]","nzBackIcon","",3,"nzBack",4,"ngIf"],["nzBackIcon","",1,"h-full","w-full","flex","flex-col","!absolute","top-0","left-0","!py-4","!pl-4","!pr-0","!bg-[#f0f2f5]",3,"nzBack"],[1,"w-full","h-full","flex","overflow-auto","!py-0","!pl-0","!pr-4","flex-col"],["nz-form","",3,"formGroup",4,"ngIf"],[1,"flex","justify-end","mb-4","mr-8"],[4,"ngIf"],["nz-form","",3,"formGroup"],[1,"flex","flex-col"],[1,"w-full","items-center","test"],[3,"model","fields","form","options"],[4,"nzSpaceItem"],["icomLibsHasPermissionDirective","","nz-button","","nzType","default",3,"action","click"],["icomLibsHasPermissionDirective","","nz-button","","nzType","primary",3,"action","nzLoading","click"],["icomLibsHasPermissionDirective","","nz-button","","nzType","primary",3,"action","nzLoading","nzDanger","click"]],template:function(i,n){1&i&&e.\u0275\u0275template(0,Q,8,4,"nz-page-header",0),2&i&&e.\u0275\u0275property("ngIf",n.data)},dependencies:[C.FormlyModule,C.FormlyForm,c.ReactiveFormsModule,c.\u0275NgNoValidate,c.NgControlStatusGroup,c.FormGroupDirective,z.CommonModule,z.NgIf,j.NzTypographyModule,_.NzPageHeaderModule,_.NzPageHeaderComponent,_.NzPageHeaderTitleDirective,_.NzPageHeaderContentDirective,_.NzPageHeaderFooterDirective,S.NzSpaceModule,S.NzSpaceComponent,S.NzSpaceItemDirective,V.NzTabsModule,M.NzIconModule,L.NzCardModule,I.NzStepsModule,x.NzFormModule,x.NzFormDirective,D.NzButtonModule,D.NzButtonComponent,w.\u0275NzTransitionPatchDirective,G.NzWaveDirective,F.NzDescriptionsModule,B.E],styles:[".test[_ngcontent-%COMP%]     formly-group{display:flex;flex-wrap:wrap}"],changeDetection:0})}return r})()}}]);