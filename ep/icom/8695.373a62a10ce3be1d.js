(self.webpackChunkicom=self.webpackChunkicom||[]).push([[8695],{58695:(D,c,n)=>{n.r(c),n.d(c,{IcomLibCustomerListComponent:()=>j});var p=n(49671),e=n(36151),f=n(93484),v=n(44729),g=n(74843),a=n(14817),y=n(60202),C=n(33635),x=n(37586),b=n(53750),m=n(8111),h=n(8581),u=n(91872);function S(s,F){if(1&s){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"icom-libs-core-components-table",3),e.\u0275\u0275listener("icomFunctionControl",function(l){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.handlerFunctionControl(l))}),e.\u0275\u0275elementEnd()}if(2&s){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("columns",t.columns)("loadFn",t.loadData)("fields",t.fields)("model",t.model)("form",t.form)("ignoreButtonAdd",!0)("functionParse",t.functionParse)}}let j=(()=>{class s{constructor(t,o){var l=this;this.datePipe=t,this.modalService=o,this.form=new f.FormGroup({}),this.iComLibsServicesProjectAdminUserService=(0,e.inject)(v.lF),this.iComMessageService=(0,e.inject)(b.Qi),this.router=(0,e.inject)(y.Router),this.loadData=i=>((0,m.xh)(i,"last_login_start,last_login_end"),this.iComLibsServicesProjectAdminUserService.getListDevices(i)),this.functionParse=i=>i?.map(r=>({...r,...r.creator_info})),this.functionExportFile=function(){var i=(0,p.Z)(function*(r,d){(0,m.cT)(`${h.N.apiGatewayUrl}${h.N.suffixAdmin}/v2.0/export/activity_logs`,"MauFileExportLichSuThaoTac",l.iComMessageService,r,!1,!0,d)});return function(r,d){return i.apply(this,arguments)}}(),this.columns=[],this.fields=[]}ngOnInit(){const t=u().format("YYYY-MM-DD"),o=u(t).subtract(3,"month").format("YYYY-MM-DD");this.model={last_login_start:o,last_login_end:t},this.fields=[{className:"flex flex-col",fieldGroupClassName:"flex w-full justify-between",fieldGroup:[{key:"fullName",type:"text",className:"basis-6/12",props:{label:"H\u1ecd t\xean",placeholder:"Nh\u1eadp h\u1ecd t\xean"}},{key:"phoneNumber",type:"text",className:"basis-6/12",props:{label:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",placeholder:"Nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i"}}]},{key:"customerGroup",type:"select",props:{label:"Nh\xf3m kh\xe1ch h\xe0ng",placeholder:"Ch\u1ecdn nh\xf3m kh\xe1ch h\xe0ng",nzAllowClear:!0,options:[{label:"Nh\xf3m mobilphone",value:"Nh\xf3m mobilphone"}]}},{key:"dateRange",type:"icom-range-picker",props:{label:"Th\u1eddi gian \u0111\u0103ng k\xfd",nzShowTime:!0,format:"dd/MM/yyyy HH:mm"}},{key:"status",type:"select",props:{label:"Tr\u1ea1ng th\xe1i",placeholder:"Ch\u1ecdn tr\u1ea1ng th\xe1i",nzAllowClear:!0,options:[{label:"\u0110ang ho\u1ea1t \u0111\u1ed9ng",value:"\u0110ang ho\u1ea1t \u0111\u1ed9ng"},{label:"Kh\xf3a",value:"Kh\xf3a"},{label:"Ch\u1edd x\u1eed l\xfd",value:"Ch\u1edd x\u1eed l\xfd"},{label:"\u0110\xe3 x\xf3a",value:"\u0110\xe3 x\xf3a"}]}}],this.columns=[{title:"STT",type:"index"},{title:"H\u1ecd t\xean",key:"fullName",type:"text"},{title:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i",key:"phoneNumber",type:"text"},{title:"Nh\xf3m kh\xe1ch h\xe0ng",key:"customerGroup",type:"text"},{title:"Th\u1eddi gian \u0111\u0103ng k\xfd",key:"dateRange",type:"text",pipe:"time"},{title:"Tr\u1ea1ng th\xe1i",key:"status",type:"text"},{title:"Ghi ch\xfa",key:"note",type:"text"},{key:"action",type:"icon",iconType:"lock",callback:this.deleteItem.bind(this)}]}deleteItem(t){this.modalService.confirm({nzTitle:`B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n xo\xe1 thi\u1ebft b\u1ecb ${t?.app_name} ?`,nzOkText:"\u0110\u1ed3ng \xfd",nzOkType:"primary",nzOkDanger:!0,nzMaskClosable:!1,nzClosable:!1,nzOnOk:this.processDeleteSection.bind(this,t),nzCancelText:"H\u1ee7y b\u1ecf"},"error")}processDeleteSection(t){return(0,C.lastValueFrom)(this.iComLibsServicesProjectAdminUserService.removeDevice(t.device_key||"")).then(()=>{this.iComMessageService.showAlertMessageDone("X\xf3a thi\u1ebft b\u1ecb th\xe0nh c\xf4ng."),this.eventFunctionControl.reset()}).catch(o=>{this.iComMessageService.showAlertMessageError(o?.error?.error_message)})}handlerFunctionControl(t){this.eventFunctionControl=t}static#e=this.\u0275fac=function(o){return new(o||s)(e.\u0275\u0275directiveInject(a.DatePipe),e.\u0275\u0275directiveInject(x.NzModalService))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:s,selectors:[["icom-libs-admin-user-history"]],standalone:!0,features:[e.\u0275\u0275ProvidersFeature([a.DecimalPipe,a.DatePipe]),e.\u0275\u0275StandaloneFeature],decls:3,vars:1,consts:[[1,"flex","w-full","h-full","flex-col"],["nz-row","",1,"w-full","pr-4","h-full",2,"justify-content","end","padding-right","8px"],[3,"columns","loadFn","fields","model","form","ignoreButtonAdd","functionParse","icomFunctionControl",4,"ngIf"],[3,"columns","loadFn","fields","model","form","ignoreButtonAdd","functionParse","icomFunctionControl"]],template:function(o,l){1&o&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,S,1,7,"icom-libs-core-components-table",2),e.\u0275\u0275elementEnd()()),2&o&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",l.loadData))},dependencies:[g.d,a.NgIf],encapsulation:2,changeDetection:0})}return s})()}}]);