(self.webpackChunkicom=self.webpackChunkicom||[]).push([[5545],{75545:(Ee,$,v)=>{v.r($),v.d($,{FORMLY_CONFIG:()=>k,FieldArrayType:()=>fe,FieldType:()=>M,FieldWrapper:()=>de,FormlyConfig:()=>_,FormlyField:()=>L,FormlyForm:()=>ue,FormlyFormBuilder:()=>D,FormlyModule:()=>ve,\u0275FormlyAttributes:()=>pe,\u0275FormlyGroup:()=>Y,\u0275FormlyTemplate:()=>Z,\u0275FormlyValidationMessage:()=>he,\u0275clone:()=>g,\u0275defineHiddenProp:()=>f,\u0275getFieldValue:()=>C,\u0275hasKey:()=>p,\u0275observe:()=>d,\u0275reverseDeepMerge:()=>x});var a=v(36151),u=v(93484),y=v(33635),b=v(65893),V=v(14817),J=v(32478);const X=["container"];function ee(n,s){}function te(n,s){1&n&&a.\u0275\u0275element(0,"formly-field",1),2&n&&a.\u0275\u0275property("field",s.$implicit)}const se=["*"],N=["fieldComponent"];function ne(n,s,e){if(s.id)return s.id;let t=s.type;return!t&&s.template&&(t="template"),t instanceof a.Type&&(t=t.prototype.constructor.name),[n,t,s.key,e].join("_")}function p(n){return!E(n.key)&&""!==n.key&&(!Array.isArray(n.key)||n.key.length>0)}function O(n){if(!p(n))return[];if(n._keyPath?.key!==n.key){let s=[];if("string"==typeof n.key){const e=-1===n.key.indexOf("[")?n.key:n.key.replace(/\[(\w+)\]/g,".$1");s=-1!==e.indexOf(".")?e.split("."):[e]}else s=Array.isArray(n.key)?n.key.slice(0):[`${n.key}`];f(n,"_keyPath",{key:n.key,path:s})}return n._keyPath.path.slice(0)}const j=["required","pattern","minLength","maxLength","min","max"];function R(n,s){let e=O(n);if(0===e.length)return;let t=n;for(;t.parent;)t=t.parent,e=[...O(t),...e];if(void 0===s&&n.resetOnHide){const r=e.pop();delete e.reduce((o,l)=>o[l]||{},t.model)[r]}else!function ie(n,s,e){for(let t=0;t<s.length-1;t++){const r=s[t];(!n[r]||!F(n[r]))&&(n[r]=/^\d+$/.test(s[t+1])?[]:{}),n=n[r]}n[s[s.length-1]]=g(e)}(t.model,e,s)}function C(n){let s=n.parent?n.parent.model:n.model;for(const e of O(n)){if(!s)return s;s=s[e]}return s}function x(n,...s){return s.forEach(e=>{for(const t in e)E(n[t])||oe(n[t])?n[t]=g(e[t]):ae(n[t],e[t])&&x(n[t],e[t])}),n}function E(n){return null==n}function T(n){return void 0===n}function oe(n){return""===n}function I(n){return"function"==typeof n}function ae(n,s){return F(n)&&F(s)&&Object.getPrototypeOf(n)===Object.getPrototypeOf(s)&&!(Array.isArray(n)||Array.isArray(s))}function F(n){return null!=n&&"object"==typeof n}function g(n){if(!F(n)||(0,y.isObservable)(n)||n instanceof a.TemplateRef||n.changingThisBreaksApplicationSecurity||-1!==["RegExp","FileList","File","Blob"].indexOf(n.constructor.name))return n;if(n instanceof Set)return new Set(n);if(n instanceof Map)return new Map(n);if(n instanceof Uint8Array)return new Uint8Array(n);if(n instanceof Uint16Array)return new Uint16Array(n);if(n instanceof Uint32Array)return new Uint32Array(n);if(n._isAMomentObject&&I(n.clone))return n.clone();if(n instanceof u.AbstractControl)return null;if(n instanceof Date)return new Date(n.getTime());if(Array.isArray(n))return n.slice(0).map(t=>g(t));const s=Object.getPrototypeOf(n);let e=Object.create(s);return e=Object.setPrototypeOf(e,s),Object.keys(n).reduce((t,r)=>{const i=Object.getOwnPropertyDescriptor(n,r);return i.get?Object.defineProperty(t,r,i):t[r]=g(n[r]),t},e)}function f(n,s,e){Object.defineProperty(n,s,{enumerable:!1,writable:!0,configurable:!0}),n[s]=e}function G(n,s,e){let t=[];const r=()=>{t.forEach(o=>o()),t=[]},i=d(n,s,({firstChange:o,currentValue:l})=>{!o&&e(),r(),F(l)&&"Object"===l.constructor.name&&Object.keys(l).forEach(c=>{t.push(G(n,[...s,c],e))})});return()=>{i.unsubscribe(),r()}}function d(n,s,e){n._observers||f(n,"_observers",{});let t=n;for(let l=0;l<s.length-1;l++)(!t[s[l]]||!F(t[s[l]]))&&(t[s[l]]=/^\d+$/.test(s[l+1])?[]:{}),t=t[s[l]];const r=s[s.length-1],i=s.join(".");n._observers[i]||(n._observers[i]={value:t[r],onChange:[]});const o=n._observers[i];if(t[r]!==o.value&&(o.value=t[r]),e&&-1===o.onChange.indexOf(e)&&(o.onChange.push(e),e({currentValue:o.value,firstChange:!0}),o.onChange.length>=1&&F(t))){const{enumerable:l}=Object.getOwnPropertyDescriptor(t,r)||{enumerable:!0};Object.defineProperty(t,r,{enumerable:l,configurable:!0,get:()=>o.value,set:c=>{if(c!==o.value){const m=o.value;o.value=c,o.onChange.forEach(h=>h({previousValue:m,currentValue:c,firstChange:!1}))}}})}return{setValue(l,c=!0){if(l===o.value)return;const m=o.value;o.value=l,o.onChange.forEach(h=>{h!==e&&c&&h({previousValue:m,currentValue:l,firstChange:!1})})},unsubscribe(){o.onChange=o.onChange.filter(l=>l!==e),0===o.onChange.length&&delete n._observers[i]}}}function U(n,s){if(s=Array.isArray(s)?s.join("."):s,n.fieldGroup)for(let e=0,t=n.fieldGroup.length;e<t;e++){const r=n.fieldGroup[e],i=Array.isArray(r.key)?r.key.join("."):r.key;if(i===s)return r;if(r.fieldGroup&&(E(i)||0===s.indexOf(`${i}.`))){const o=U(r,E(i)?s:s.slice(i.length+1));if(o)return o}}}function W(n){n._componentRefs?.forEach(s=>{s instanceof a.ComponentRef?s.injector.get(a.ChangeDetectorRef).markForCheck():s.markForCheck()})}function Q(n){const s=t=>t.hide||t.expressions?.hide||t.hideExpression;let e=!n.resetOnHide||!s(n);if(!s(n)&&n.resetOnHide){let t=n.parent;for(;t&&!s(t);)t=t.parent;e=!t||!s(t)}return!e}const k=new a.InjectionToken("FORMLY_CONFIG");let _=(()=>{class n{constructor(){this.types={},this.validators={},this.wrappers={},this.messages={},this.extras={checkExpressionOn:"modelChange",lazyRender:!0,resetFieldOnHide:!0,renderFormlyFieldElement:!0,showError:e=>e.formControl?.invalid&&(e.formControl?.touched||e.options.parentForm?.submitted||!!e.field.validation?.show)},this.extensions={},this.presets={},this.extensionsByPriority={}}addConfig(e){e.types&&e.types.forEach(t=>this.setType(t)),e.validators&&e.validators.forEach(t=>this.setValidator(t)),e.wrappers&&e.wrappers.forEach(t=>this.setWrapper(t)),e.validationMessages&&e.validationMessages.forEach(t=>this.addValidatorMessage(t.name,t.message)),e.extensions&&this.setSortedExtensions(e.extensions),e.extras&&(this.extras={...this.extras,...e.extras}),e.presets&&(this.presets={...this.presets,...e.presets.reduce((t,r)=>({...t,[r.name]:r.config}),{})})}setType(e){Array.isArray(e)?e.forEach(t=>this.setType(t)):(this.types[e.name]||(this.types[e.name]={name:e.name}),["component","extends","defaultOptions","wrappers"].forEach(t=>{e.hasOwnProperty(t)&&(this.types[e.name][t]=e[t])}))}getType(e,t=!1){if(e instanceof a.Type)return{component:e,name:e.prototype.constructor.name};if(!this.types[e]){if(t)throw new Error(`[Formly Error] The type "${e}" could not be found. Please make sure that is registered through the FormlyModule declaration.`);return null}return this.mergeExtendedType(e),this.types[e]}getMergedField(e={}){const t=this.getType(e.type);if(!t)return;t.defaultOptions&&x(e,t.defaultOptions);const r=t.extends&&this.getType(t.extends).defaultOptions;r&&x(e,r),e?.optionsTypes&&e.optionsTypes.forEach(o=>{const l=this.getType(o).defaultOptions;l&&x(e,l)});const i=this.resolveFieldTypeRef(e);i?.instance?.defaultOptions&&x(e,i.instance.defaultOptions),!e.wrappers&&t.wrappers&&(e.wrappers=[...t.wrappers])}resolveFieldTypeRef(e={}){const t=this.getType(e.type);if(!t)return null;if(!t.component||t._componentRef)return t._componentRef;const{_viewContainerRef:r,_injector:i}=e.options;if(!r||!i)return null;const o=r.createComponent(t.component,{injector:i});f(t,"_componentRef",o);try{o.destroy()}catch(l){console.error(`An error occurred while destroying the Formly component type "${e.type}"`,l)}return t._componentRef}setWrapper(e){this.wrappers[e.name]=e,e.types&&e.types.forEach(t=>{this.setTypeWrapper(t,e.name)})}getWrapper(e){if(e instanceof a.Type)return{component:e,name:e.prototype.constructor.name};if(!this.wrappers[e])throw new Error(`[Formly Error] The wrapper "${e}" could not be found. Please make sure that is registered through the FormlyModule declaration.`);return this.wrappers[e]}setTypeWrapper(e,t){this.types[e]||(this.types[e]={}),this.types[e].wrappers||(this.types[e].wrappers=[]),-1===this.types[e].wrappers.indexOf(t)&&this.types[e].wrappers.push(t)}setValidator(e){this.validators[e.name]=e}getValidator(e){if(!this.validators[e])throw new Error(`[Formly Error] The validator "${e}" could not be found. Please make sure that is registered through the FormlyModule declaration.`);return this.validators[e]}addValidatorMessage(e,t){this.messages[e]=t}getValidatorMessage(e){return this.messages[e]}setSortedExtensions(e){e.forEach(t=>{const r=t.priority??1;this.extensionsByPriority[r]={...this.extensionsByPriority[r],[t.name]:t.extension}}),this.extensions=Object.keys(this.extensionsByPriority).map(Number).sort((t,r)=>t-r).reduce((t,r)=>({...t,...this.extensionsByPriority[r]}),{})}mergeExtendedType(e){if(!this.types[e].extends)return;const t=this.getType(this.types[e].extends);this.types[e].component||(this.types[e].component=t.component),this.types[e].wrappers||(this.types[e].wrappers=t.wrappers)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),D=(()=>{class n{constructor(e,t,r,i){this.config=e,this.injector=t,this.viewContainerRef=r,this.parentForm=i}buildForm(e,t=[],r,i){this.build({fieldGroup:t,model:r,form:e,options:i})}build(e){if(!this.config.extensions.core)throw new Error("NgxFormly: missing `forRoot()` call. use `forRoot()` when registering the `FormlyModule`.");e.parent||this._setOptions(e),function re(n,s){const e=n._updateTreeValidity.bind(n);n._updateTreeValidity=()=>{},s(),n._updateTreeValidity=e}(e.form,()=>{if(this._build(e),!e.parent||e.fieldArray){const t=e.options;e.parent&&Q(e)&&t._hiddenFieldsForCheck?.push(e),t.checkExpressions?.(e,!0),t._detectChanges?.(e)}})}_build(e){if(!e)return;const t=Object.values(this.config.extensions);t.forEach(r=>r.prePopulate?.(e)),t.forEach(r=>r.onPopulate?.(e)),e.fieldGroup?.forEach(r=>this._build(r)),t.forEach(r=>r.postPopulate?.(e))}_setOptions(e){e.form=e.form||new u.FormGroup({}),e.model=e.model||{},e.options=e.options||{};const t=e.options;t._viewContainerRef||f(t,"_viewContainerRef",this.viewContainerRef),t._injector||f(t,"_injector",this.injector),t.build||(t._buildForm=()=>{console.warn("Formly: 'options._buildForm' is deprecated since v6.0, use 'options.build' instead."),this.build(e)},t.build=(r=e)=>(this.build(r),r)),!t.parentForm&&this.parentForm&&(f(t,"parentForm",this.parentForm),d(t,["parentForm","submitted"],({firstChange:r})=>{r||t.detectChanges(e)}))}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275inject(_),a.\u0275\u0275inject(a.Injector),a.\u0275\u0275inject(a.ViewContainerRef,8),a.\u0275\u0275inject(u.FormGroupDirective,8))},n.\u0275prov=a.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function H(n,s=!1){const e=n.formControl,t=e._fields?e._fields.indexOf(n):-1;-1!==t&&e._fields.splice(t,1);const r=e.parent;if(!r)return;const i={emitEvent:s};if(r instanceof u.FormArray){const o=r.controls.findIndex(l=>l===e);-1!==o&&r.removeAt(o,i)}else if(r instanceof u.FormGroup){const o=O(n),l=o[o.length-1];r.get([l])===e&&r.removeControl(l,i)}e.setParent(null)}function K(n){return n.formControl?n.formControl:!1===n.shareFormControl?null:n.form?.get(O(n))}function S(n,s,e=!1){if((s=s||n.formControl)._fields||f(s,"_fields",[]),-1===s._fields.indexOf(n)&&s._fields.push(n),!n.formControl&&s){f(n,"formControl",s),s.setValidators(null),s.setAsyncValidators(null),n.props.disabled=!!n.props.disabled;const l=d(n,["props","disabled"],({firstChange:c,currentValue:m})=>{c||(m?n.formControl.disable():n.formControl.enable())});s instanceof u.FormControl&&s.registerOnDisabledChange(l.setValue)}if(!n.form||!p(n))return;let t=n.form;const r=O(n),i=C(n);(!E(s.value)||!E(i))&&s.value!==i&&s instanceof u.FormControl&&s.patchValue(i);for(let l=0;l<r.length-1;l++){const c=r[l];t.get([c])||t.setControl(c,new u.FormGroup({}),{emitEvent:e}),t=t.get([c])}const o=r[r.length-1];!n._hide&&t.get([o])!==s&&t.setControl(o,s,{emitEvent:e})}function P(n,s=!1){const e=n.status,t=n.value;n.updateValueAndValidity({emitEvent:!1,onlySelf:s}),e!==n.status&&n.statusChanges.emit(n.status),t!==n.value&&n.valueChanges.emit(n.value)}function z(n){delete n?._fields,n.setValidators(null),n.setAsyncValidators(null),(n instanceof u.FormGroup||n instanceof u.FormArray)&&Object.values(n.controls).forEach(s=>z(s))}let Z=(()=>{class n{constructor(e){this.ref=e}ngOnChanges(){this.name=this.name||"formly-group"}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275directiveInject(a.TemplateRef))},n.\u0275dir=a.\u0275\u0275defineDirective({type:n,selectors:[["","formlyTemplate",""]],inputs:{name:["formlyTemplate","name"]},features:[a.\u0275\u0275NgOnChangesFeature]}),n})(),B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=a.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n})(),L=(()=>{class n{constructor(e,t,r,i,o){this.config=e,this.renderer=t,this._elementRef=r,this.hostContainerRef=i,this.form=o,this.hostObservers=[],this.componentRefs=[],this.hooksObservers=[],this.detectFieldBuild=!1,this.valueChangesUnsubscribe=()=>{}}get containerRef(){return this.config.extras.renderFormlyFieldElement?this.viewContainerRef:this.hostContainerRef}get elementRef(){return this.config.extras.renderFormlyFieldElement?this._elementRef:this.componentRefs?.[0]instanceof a.ComponentRef?this.componentRefs[0].location:null}ngAfterContentInit(){this.triggerHook("afterContentInit")}ngAfterViewInit(){this.triggerHook("afterViewInit")}ngDoCheck(){this.detectFieldBuild&&this.field&&this.field.options&&this.render()}ngOnInit(){this.triggerHook("onInit")}ngOnChanges(e){this.triggerHook("onChanges",e)}ngOnDestroy(){this.resetRefs(this.field),this.hostObservers.forEach(e=>e.unsubscribe()),this.hooksObservers.forEach(e=>e()),this.valueChangesUnsubscribe(),this.triggerHook("onDestroy")}renderField(e,t,r=[]){if(this.containerRef===e&&(this.resetRefs(this.field),this.containerRef.clear(),r=this.field?.wrappers),r?.length>0){const[i,...o]=r,{component:l}=this.config.getWrapper(i),c=e.createComponent(l);this.attachComponentRef(c,t),d(c.instance,["fieldComponent"],({currentValue:m,previousValue:h,firstChange:w})=>{if(m){if(h&&h._lContainer===m._lContainer)return;const A=h?h.detach():null;A&&!A.destroyed?m.insert(A):this.renderField(m,t,o),!w&&c.changeDetectorRef.detectChanges()}})}else if(t?.type){const i=this.form?.templates?.find(l=>l.name===t.type);let o;if(i)o=e.createEmbeddedView(i.ref,{$implicit:t});else{const{component:l}=this.config.getType(t.type,!0);o=e.createComponent(l)}this.attachComponentRef(o,t)}}triggerHook(e,t){if(("onInit"===e||"onChanges"===e&&t.field&&!t.field.firstChange)&&(this.valueChangesUnsubscribe(),this.valueChangesUnsubscribe=this.fieldChanges(this.field)),this.field?.hooks?.[e]&&(!t||t.field)){const r=this.field.hooks[e](this.field);if((0,y.isObservable)(r)&&-1!==["onInit","afterContentInit","afterViewInit"].indexOf(e)){const i=r.subscribe();this.hooksObservers.push(()=>i.unsubscribe())}}"onChanges"===e&&t.field&&(this.resetRefs(t.field.previousValue),this.render())}attachComponentRef(e,t){this.componentRefs.push(e),t._componentRefs.push(e),e instanceof a.ComponentRef&&Object.assign(e.instance,{field:t})}render(){if(this.field){if(!this.field.options)return void(this.detectFieldBuild=!0);this.detectFieldBuild=!1,this.hostObservers.forEach(e=>e.unsubscribe()),this.hostObservers=[d(this.field,["hide"],({firstChange:e,currentValue:t})=>{const r=this.containerRef;!1===this.config.extras.lazyRender?(e&&this.renderField(r,this.field),(!e||e&&t)&&this.elementRef&&this.renderer.setStyle(this.elementRef.nativeElement,"display",t?"none":"")):t?(r.clear(),this.field.className&&this.renderer.removeAttribute(this.elementRef.nativeElement,"class")):(this.renderField(r,this.field),this.field.className&&this.renderer.setAttribute(this.elementRef.nativeElement,"class",this.field.className)),!e&&this.field.options.detectChanges(this.field)}),d(this.field,["className"],({firstChange:e,currentValue:t})=>{(!e||e&&t)&&(!this.config.extras.lazyRender||!0!==this.field.hide)&&this.elementRef&&this.renderer.setAttribute(this.elementRef.nativeElement,"class",t)}),...["touched","pristine","status"].map(e=>d(this.field,["formControl",e],({firstChange:t})=>!t&&W(this.field)))]}}resetRefs(e){e&&(e._localFields?e._localFields=[]:f(this.field,"_localFields",[]),e._componentRefs?e._componentRefs=e._componentRefs.filter(t=>-1===this.componentRefs.indexOf(t)):f(this.field,"_componentRefs",[])),this.componentRefs=[]}fieldChanges(e){if(!e)return()=>{};const t=[G(e,["props"],()=>e.options.detectChanges(e))];e.options&&t.push(G(e.options,["formState"],()=>e.options.detectChanges(e)));for(const i of Object.keys(e._expressions||{})){const o=d(e,["_expressions",i],({currentValue:l,previousValue:c})=>{c?.subscription&&(c.subscription.unsubscribe(),c.subscription=null),(0,y.isObservable)(l.value$)&&(l.subscription=l.value$.subscribe())});t.push(()=>{e._expressions[i]?.subscription&&e._expressions[i].subscription.unsubscribe(),o.unsubscribe()})}for(const i of[["focus"],["template"],["fieldGroupClassName"],["validation","show"]]){const o=d(e,i,({firstChange:l})=>!l&&e.options.detectChanges(e));t.push(()=>o.unsubscribe())}if(e.formControl&&!e.fieldGroup){const i=e.formControl;let o=i.valueChanges.pipe((0,b.distinctUntilChanged)((h,w)=>!(h!==w||Array.isArray(h)||F(h))));i.value!==C(e)&&(o=o.pipe((0,b.startWith)(i.value)));const{updateOn:l,debounce:c}=e.modelOptions;(!l||"change"===l)&&c?.default>0&&(o=i.valueChanges.pipe((0,b.debounceTime)(c.default)));const m=o.subscribe(h=>{i._fields?.length>1&&i instanceof u.FormControl&&i.patchValue(h,{emitEvent:!1,onlySelf:!0}),e.parsers?.forEach(w=>h=w(h)),h===e.formControl.value?(p(e)&&R(e,h),e.options.fieldChanges.next({value:h,field:e,type:"valueChanges"})):e.formControl.setValue(h)});t.push(()=>m.unsubscribe())}let r=[];return d(e,["_localFields"],({currentValue:i})=>{r.forEach(o=>o()),r=(i||[]).map(o=>this.fieldChanges(o))}),()=>{t.forEach(i=>i()),r.forEach(i=>i())}}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275directiveInject(_),a.\u0275\u0275directiveInject(a.Renderer2),a.\u0275\u0275directiveInject(a.ElementRef),a.\u0275\u0275directiveInject(a.ViewContainerRef),a.\u0275\u0275directiveInject(B,8))},n.\u0275cmp=a.\u0275\u0275defineComponent({type:n,selectors:[["formly-field"]],viewQuery:function(e,t){if(1&e&&a.\u0275\u0275viewQuery(X,7,a.ViewContainerRef),2&e){let r;a.\u0275\u0275queryRefresh(r=a.\u0275\u0275loadQuery())&&(t.viewContainerRef=r.first)}},inputs:{field:"field"},features:[a.\u0275\u0275NgOnChangesFeature],decls:2,vars:0,consts:[["container",""]],template:function(e,t){1&e&&a.\u0275\u0275template(0,ee,0,0,"ng-template",null,0,a.\u0275\u0275templateRefExtractor)},styles:["[_nghost-%COMP%]:empty{display:none}"]}),n})(),ue=(()=>{class n{constructor(e,t,r,i){this.builder=e,this.config=t,this.ngZone=r,this.fieldTemplates=i,this.modelChange=new a.EventEmitter,this.field={type:"formly-group"},this._modelChangeValue={},this.valueChangesUnsubscribe=()=>{}}set form(e){this.field.form=e}get form(){return this.field.form}set model(e){this.config.extras.immutable&&this._modelChangeValue===e||this.setField({model:e})}get model(){return this.field.model}set fields(e){this.setField({fieldGroup:e})}get fields(){return this.field.fieldGroup}set options(e){this.setField({options:e})}get options(){return this.field.options}set templates(e){this.fieldTemplates.templates=e}ngDoCheck(){"changeDetectionCheck"===this.config.extras.checkExpressionOn&&this.checkExpressionChange()}ngOnChanges(e){e.fields&&this.form&&z(this.form),(e.fields||e.form||e.model&&this._modelChangeValue!==e.model.currentValue)&&(this.valueChangesUnsubscribe(),this.builder.build(this.field),this.valueChangesUnsubscribe=this.valueChanges())}ngOnDestroy(){this.valueChangesUnsubscribe()}checkExpressionChange(){this.field.options.checkExpressions?.(this.field)}valueChanges(){this.valueChangesUnsubscribe();const e=this.field.options.fieldChanges.pipe((0,b.filter)(({field:t,type:r})=>p(t)&&"valueChanges"===r),(0,b.switchMap)(()=>function ce(n){return n instanceof a.\u0275NoopNgZone}(this.ngZone)?(0,y.of)(null):this.ngZone.onStable.asObservable().pipe((0,b.take)(1)))).subscribe(()=>this.ngZone.runGuarded(()=>{this.checkExpressionChange(),this.modelChange.emit(this._modelChangeValue=g(this.model))}));return()=>e.unsubscribe()}setField(e){this.config.extras.immutable?this.field={...this.field,...g(e)}:Object.keys(e).forEach(t=>this.field[t]=e[t])}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275directiveInject(D),a.\u0275\u0275directiveInject(_),a.\u0275\u0275directiveInject(a.NgZone),a.\u0275\u0275directiveInject(B))},n.\u0275cmp=a.\u0275\u0275defineComponent({type:n,selectors:[["formly-form"]],contentQueries:function(e,t,r){if(1&e&&a.\u0275\u0275contentQuery(r,Z,4),2&e){let i;a.\u0275\u0275queryRefresh(i=a.\u0275\u0275loadQuery())&&(t.templates=i)}},inputs:{form:"form",model:"model",fields:"fields",options:"options"},outputs:{modelChange:"modelChange"},features:[a.\u0275\u0275ProvidersFeature([D,B]),a.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[[3,"field"]],template:function(e,t){1&e&&a.\u0275\u0275element(0,"formly-field",0),2&e&&a.\u0275\u0275property("field",t.field)},dependencies:[L],encapsulation:2,changeDetection:0}),n})(),pe=(()=>{class n{constructor(e,t,r){this.renderer=e,this.elementRef=t,this.uiAttributesCache={},this.uiEvents={listeners:[],events:["click","keyup","keydown","keypress","focus","blur","change"],callback:(i,o)=>{switch(i){case"focus":return this.onFocus(o);case"blur":return this.onBlur(o);case"change":return this.onChange(o);default:return this.props[i](this.field,o)}}},this.document=r}get props(){return this.field.props||{}}get fieldAttrElements(){return this.field?._elementRefs||[]}ngOnChanges(e){e.field&&(this.field.name&&this.setAttribute("name",this.field.name),this.uiEvents.listeners.forEach(t=>t()),this.uiEvents.events.forEach(t=>{(this.props?.[t]||-1!==["focus","blur","change"].indexOf(t))&&this.uiEvents.listeners.push(this.renderer.listen(this.elementRef.nativeElement,t,r=>this.uiEvents.callback(t,r)))}),this.props?.attributes&&d(this.field,["props","attributes"],({currentValue:t,previousValue:r})=>{r&&Object.keys(r).forEach(i=>this.removeAttribute(i)),t&&Object.keys(t).forEach(i=>{null!=t[i]&&this.setAttribute(i,t[i])})}),this.detachElementRef(e.field.previousValue),this.attachElementRef(e.field.currentValue),1===this.fieldAttrElements.length&&(!this.id&&this.field.id&&this.setAttribute("id",this.field.id),this.focusObserver=d(this.field,["focus"],({currentValue:t})=>{this.toggleFocus(t)}))),e.id&&this.setAttribute("id",this.id)}ngDoCheck(){if(!this.uiAttributes){const e=this.elementRef.nativeElement;this.uiAttributes=[...j,"tabindex","placeholder","readonly","disabled","step"].filter(t=>!e.hasAttribute||!e.hasAttribute(t))}for(let e=0;e<this.uiAttributes.length;e++){const t=this.uiAttributes[e],r=this.props[t];this.uiAttributesCache[t]!==r&&(!this.props.attributes||!this.props.attributes.hasOwnProperty(t.toLowerCase()))&&(this.uiAttributesCache[t]=r,r||0===r?this.setAttribute(t,!0===r?t:`${r}`):this.removeAttribute(t))}}ngOnDestroy(){this.uiEvents.listeners.forEach(e=>e()),this.detachElementRef(this.field),this.focusObserver?.unsubscribe()}toggleFocus(e){const t=this.fieldAttrElements?this.fieldAttrElements[0]:null;if(!t||!t.nativeElement.focus)return;const r=!!this.document.activeElement&&this.fieldAttrElements.some(({nativeElement:i})=>this.document.activeElement===i||i.contains(this.document.activeElement));e&&!r?Promise.resolve().then(()=>t.nativeElement.focus()):!e&&r&&Promise.resolve().then(()=>t.nativeElement.blur())}onFocus(e){this.focusObserver?.setValue(!0),this.props.focus?.(this.field,e)}onBlur(e){this.focusObserver?.setValue(!1),this.props.blur?.(this.field,e)}onHostChange(e){e instanceof Event||this.onChange(e)}onChange(e){this.props.change?.(this.field,e),this.field.formControl?.markAsDirty()}attachElementRef(e){e&&(-1===e._elementRefs?.indexOf(this.elementRef)?e._elementRefs.push(this.elementRef):f(e,"_elementRefs",[this.elementRef]))}detachElementRef(e){const t=e?._elementRefs?this.fieldAttrElements.indexOf(this.elementRef):-1;-1!==t&&e._elementRefs.splice(t,1)}setAttribute(e,t){this.renderer.setAttribute(this.elementRef.nativeElement,e,t)}removeAttribute(e){this.renderer.removeAttribute(this.elementRef.nativeElement,e)}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275directiveInject(a.Renderer2),a.\u0275\u0275directiveInject(a.ElementRef),a.\u0275\u0275directiveInject(V.DOCUMENT))},n.\u0275dir=a.\u0275\u0275defineDirective({type:n,selectors:[["","formlyAttributes",""]],hostBindings:function(e,t){1&e&&a.\u0275\u0275listener("change",function(i){return t.onHostChange(i)})},inputs:{field:["formlyAttributes","field"],id:"id"},features:[a.\u0275\u0275NgOnChangesFeature]}),n})(),M=(()=>{class n{constructor(){this.field={}}set _formlyControls(e){this.field._localFields=e.map(r=>r.control._fields||[]).flat().filter(r=>r.formControl!==this.field.formControl)}get model(){return this.field.model}get form(){return this.field.form}get options(){return this.field.options}get key(){return this.field.key}get formControl(){return this.field.formControl}get props(){return this.field.props||{}}get to(){return this.props}get showError(){return this.options.showError(this)}get id(){return this.field.id}get formState(){return this.options?.formState||{}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=a.\u0275\u0275defineDirective({type:n,viewQuery:function(e,t){if(1&e&&a.\u0275\u0275viewQuery(u.NgControl,5),2&e){let r;a.\u0275\u0275queryRefresh(r=a.\u0275\u0275loadQuery())&&(t._formlyControls=r)}},inputs:{field:"field"}}),n})(),Y=(()=>{class n extends M{}return n.\u0275fac=function(){let s;return function(t){return(s||(s=a.\u0275\u0275getInheritedFactory(n)))(t||n)}}(),n.\u0275cmp=a.\u0275\u0275defineComponent({type:n,selectors:[["formly-group"]],hostVars:2,hostBindings:function(e,t){2&e&&a.\u0275\u0275classMap(t.field.fieldGroupClassName||"")},features:[a.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:se,decls:2,vars:1,consts:[[3,"field",4,"ngFor","ngForOf"],[3,"field"]],template:function(e,t){1&e&&(a.\u0275\u0275projectionDef(),a.\u0275\u0275template(0,te,1,1,"formly-field",0),a.\u0275\u0275projection(1)),2&e&&a.\u0275\u0275property("ngForOf",t.field.fieldGroup)},dependencies:[L,V.NgForOf],encapsulation:2,changeDetection:0}),n})(),he=(()=>{class n{constructor(e){this.config=e}ngOnChanges(){const e=j.map(t=>`templateOptions.${t}`);this.errorMessage$=(0,y.merge)(this.field.formControl.statusChanges,this.field.options?this.field.options.fieldChanges.pipe((0,b.filter)(({field:t,type:r,property:i})=>t===this.field&&"expressionChanges"===r&&(-1!==i.indexOf("validation")||-1!==e.indexOf(i)))):(0,y.of)(null)).pipe((0,b.startWith)(null),(0,b.switchMap)(()=>(0,y.isObservable)(this.errorMessage)?this.errorMessage:(0,y.of)(this.errorMessage)))}get errorMessage(){const e=this.field.formControl;for(const t in e.errors)if(e.errors.hasOwnProperty(t)){let r=this.config.getValidatorMessage(t);if(F(e.errors[t])){if(e.errors[t].errorPath)return;e.errors[t].message&&(r=e.errors[t].message)}return this.field.validation?.messages?.[t]&&(r=this.field.validation.messages[t]),this.field.validators?.[t]?.message&&(r=this.field.validators[t].message),this.field.asyncValidators?.[t]?.message&&(r=this.field.asyncValidators[t].message),"function"==typeof r?r(e.errors[t],this.field):r}}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275directiveInject(_))},n.\u0275cmp=a.\u0275\u0275defineComponent({type:n,selectors:[["formly-validation-message"]],inputs:{field:"field"},features:[a.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,template:function(e,t){1&e&&(a.\u0275\u0275text(0),a.\u0275\u0275pipe(1,"async")),2&e&&a.\u0275\u0275textInterpolate(a.\u0275\u0275pipeBind1(1,1,t.errorMessage$))},dependencies:[V.AsyncPipe],encapsulation:2,changeDetection:0}),n})(),fe=(()=>{class n extends M{onPopulate(e){p(e)&&S(e,K(e)||new u.FormArray([],{updateOn:e.modelOptions.updateOn})),e.fieldGroup=e.fieldGroup||[];const t=Array.isArray(e.model)?e.model.length:0;if(e.fieldGroup.length>t)for(let r=e.fieldGroup.length-1;r>=t;--r)H(e.fieldGroup[r],!0),e.fieldGroup.splice(r,1);for(let r=e.fieldGroup.length;r<t;r++){const i={...g("function"==typeof e.fieldArray?e.fieldArray(e):e.fieldArray)};null!==i.key&&(i.key=`${r}`),e.fieldGroup.push(i)}}add(e,t,{markAsDirty:r}={markAsDirty:!0}){e=e??this.field.fieldGroup.length,this.model||R(this.field,[]),this.model.splice(e,0,t?g(t):void 0),this._build(),r&&this.formControl.markAsDirty()}remove(e,{markAsDirty:t}={markAsDirty:!0}){this.model.splice(e,1);const r=this.field.fieldGroup[e];this.field.fieldGroup.splice(e,1),this.field.fieldGroup.forEach((i,o)=>this.updateArrayElementKey(i,`${o}`)),H(r,!0),this._build(),t&&this.formControl.markAsDirty()}_build(){(this.field.formControl._fields??[this.field]).forEach(t=>this.options.build(t)),this.options.fieldChanges.next({field:this.field,value:C(this.field),type:"valueChanges"})}updateArrayElementKey(e,t){if(p(e))e.key=t;else if(e.fieldGroup?.length)for(let r=0;r<e.fieldGroup.length;r++)this.updateArrayElementKey(e.fieldGroup[r],t)}}return n.\u0275fac=function(){let s;return function(t){return(s||(s=a.\u0275\u0275getInheritedFactory(n)))(t||n)}}(),n.\u0275dir=a.\u0275\u0275defineDirective({type:n,features:[a.\u0275\u0275InheritDefinitionFeature]}),n})(),de=(()=>{class n extends M{set _formlyControls(e){}set _staticContent(e){this.fieldComponent=e}}return n.\u0275fac=function(){let s;return function(t){return(s||(s=a.\u0275\u0275getInheritedFactory(n)))(t||n)}}(),n.\u0275dir=a.\u0275\u0275defineDirective({type:n,viewQuery:function(e,t){if(1&e&&(a.\u0275\u0275viewQuery(N,5,a.ViewContainerRef),a.\u0275\u0275viewQuery(N,7,a.ViewContainerRef)),2&e){let r;a.\u0275\u0275queryRefresh(r=a.\u0275\u0275loadQuery())&&(t.fieldComponent=r.first),a.\u0275\u0275queryRefresh(r=a.\u0275\u0275loadQuery())&&(t._staticContent=r.first)}},features:[a.\u0275\u0275InheritDefinitionFeature]}),n})(),me=(()=>{class n extends M{constructor(e){super(),this.sanitizer=e,this.innerHtml={}}get template(){return this.field&&this.field.template!==this.innerHtml.template&&(this.innerHtml={template:this.field.template,content:this.props.safeHtml?this.sanitizer.bypassSecurityTrustHtml(this.field.template):this.field.template}),this.innerHtml.content}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275directiveInject(J.DomSanitizer))},n.\u0275cmp=a.\u0275\u0275defineComponent({type:n,selectors:[["formly-template"]],features:[a.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"innerHtml"]],template:function(e,t){1&e&&a.\u0275\u0275element(0,"div",0),2&e&&a.\u0275\u0275property("innerHtml",t.template,a.\u0275\u0275sanitizeHtml)},encapsulation:2,changeDetection:0}),n})();class be{onPopulate(s){if(s._expressions)return;f(s,"_expressions",{}),d(s,["hide"],({currentValue:t,firstChange:r})=>{f(s,"_hide",!!t),(!r||r&&!0===t)&&(s.props.hidden=t,s.options._hiddenFieldsForCheck.push(s))}),s.hideExpression&&d(s,["hideExpression"],({currentValue:t})=>{s._expressions.hide=this.parseExpressions(s,"hide","boolean"==typeof t?()=>t:t)});const e=(t,r)=>{"string"==typeof r||I(r)?s._expressions[t]=this.parseExpressions(s,t,r):r instanceof y.Observable&&(s._expressions[t]={value$:r.pipe((0,b.tap)(i=>{this.evalExpr(s,t,i),s.options._detectChanges(s)}))})};s.expressions=s.expressions||{};for(const t of Object.keys(s.expressions))d(s,["expressions",t],({currentValue:r})=>{e(t,I(r)?(...i)=>r(s,i[3]):r)});s.expressionProperties=s.expressionProperties||{};for(const t of Object.keys(s.expressionProperties))d(s,["expressionProperties",t],({currentValue:r})=>e(t,r))}postPopulate(s){if(!s.parent&&!s.options.checkExpressions){let e=!1;s.options.checkExpressions=(t,r)=>{if(e)return;e=!0;const i=this.checkExpressions(t,r),o=s.options;o._hiddenFieldsForCheck.sort(l=>l.hide?-1:1).forEach(l=>this.changeHideState(l,l.hide,!r)),o._hiddenFieldsForCheck=[],i&&this.checkExpressions(s),e=!1},s.options._checkField=(t,r)=>{console.warn("Formly: 'options._checkField' is deprecated since v6.0, use 'options.checkExpressions' instead."),s.options.checkExpressions(t,r)}}}parseExpressions(s,e,t){let r,i;if(s.parent&&["hide","props.disabled"].includes(e)){const o=l=>"hide"===e?l.hide:l.props.disabled;r=()=>{let l=s.parent;for(;l.parent&&!o(l);)l=l.parent;return o(l)}}return"string"==typeof(t=t||(()=>!1))&&(t=function ye(n,s){try{return Function(...s,`return ${n};`)}catch(e){console.error(e)}}(t,["model","formState","field"])),{callback:o=>{try{const l=function ge(n,s,e){return"function"==typeof n?n.apply(s,e):!!n}(r?(...c)=>r(s)||t(...c):t,{field:s},[s.model,s.options.formState,s,o]);return!(!o&&(i===l||F(l)&&!(0,y.isObservable)(l)&&JSON.stringify(l)===JSON.stringify(i))||(i=l,this.evalExpr(s,e,l),0))}catch(l){throw l.message=`[Formly Error] [Expression "${e}"] ${l.message}`,l}}}}checkExpressions(s,e=!1){if(!s)return!1;let t=!1;if(s._expressions)for(const r of Object.keys(s._expressions))s._expressions[r].callback?.(e)&&(t=!0);return s.fieldGroup?.forEach(r=>this.checkExpressions(r,e)&&(t=!0)),t}changeDisabledState(s,e){s.fieldGroup&&s.fieldGroup.filter(t=>!t._expressions.hasOwnProperty("props.disabled")).forEach(t=>this.changeDisabledState(t,e)),p(s)&&s.props.disabled!==e&&(s.props.disabled=e)}changeHideState(s,e,t){if(s.fieldGroup&&s.fieldGroup.filter(r=>r&&!r._expressions.hide).forEach(r=>this.changeHideState(r,e,t)),s.formControl&&p(s)){f(s,"_hide",!(!e&&!s.hide));const r=s.formControl;r._fields?.length>1&&P(r),!0!==e||r._fields&&!r._fields.every(i=>!!i._hide)?!1===e&&(s.resetOnHide&&!T(s.defaultValue)&&T(C(s))&&R(s,s.defaultValue),S(s,void 0,!0),s.resetOnHide&&s.fieldArray&&s.fieldGroup?.length!==s.model?.length&&s.options.build(s)):(H(s,!0),t&&s.resetOnHide&&(R(s,void 0),s.formControl.reset({value:void 0,disabled:s.formControl.disabled}),s.options.fieldChanges.next({value:void 0,field:s,type:"valueChanges"}),s.fieldGroup&&s.formControl instanceof u.FormArray&&(s.fieldGroup.length=0)))}s.options.fieldChanges&&s.options.fieldChanges.next({field:s,type:"hidden",value:e})}evalExpr(s,e,t){if(0===e.indexOf("model.")){const r=e.replace(/^model\./,""),i=s.fieldGroup?s:s.parent;let o=s?.key===r?s.formControl:s.form.get(r);!o&&s.get(r)&&(o=s.get(r).formControl),R({key:r,parent:i,model:s.model},t),o&&(!E(o.value)||!E(t))&&o.value!==t&&o.patchValue(t)}else{try{let r=s;const i=this._evalExpressionPath(s,e),o=i.length-1;for(let l=0;l<o;l++)r=r[i[l]];r[i[o]]=t}catch(r){throw r.message=`[Formly Error] [Expression "${e}"] ${r.message}`,r}["templateOptions.disabled","props.disabled"].includes(e)&&p(s)&&this.changeDisabledState(s,t)}this.emitExpressionChanges(s,e,t)}emitExpressionChanges(s,e,t){s.options.fieldChanges&&s.options.fieldChanges.next({field:s,type:"expressionChanges",property:e,value:t})}_evalExpressionPath(s,e){if(s._expressions[e]&&s._expressions[e].paths)return s._expressions[e].paths;let t=[];return-1===e.indexOf("[")?t=e.split("."):e.split(/[[\]]{1,2}/).filter(r=>r).forEach(r=>{const i=r.match(/['|"](.*?)['|"]/);i?t.push(i[1]):t.push(...r.split(".").filter(o=>o))}),s._expressions[e]&&(s._expressions[e].paths=t),t}}class Fe{constructor(s){this.config=s}onPopulate(s){this.initFieldValidation(s,"validators"),this.initFieldValidation(s,"asyncValidators")}initFieldValidation(s,e){const t=[];if("validators"===e&&!(s.hasOwnProperty("fieldGroup")&&!p(s))&&t.push(this.getPredefinedFieldValidation(s)),s[e])for(const r of Object.keys(s[e]))"validation"===r?t.push(...s[e].validation.map(i=>this.wrapNgValidatorFn(s,i))):t.push(this.wrapNgValidatorFn(s,s[e][r],r));f(s,"_"+e,t)}getPredefinedFieldValidation(s){let e=[];return j.forEach(t=>d(s,["props",t],({currentValue:r,firstChange:i})=>{e=e.filter(o=>o!==t),"required"===t&&null!=r&&"boolean"!=typeof r&&console.warn(`Formly: Invalid prop 'required' of type '${typeof r}', expected 'boolean' (Field:${s.key}).`),null!=r&&!1!==r&&e.push(t),!i&&s.formControl&&P(s.formControl)})),t=>0===e.length?null:u.Validators.compose(e.map(r=>()=>{const i=s.props[r];switch(r){case"required":return u.Validators.required(t);case"pattern":return u.Validators.pattern(i)(t);case"minLength":const o=u.Validators.minLength(i)(t),l=this.config.getValidatorMessage("minlength")||s.validation?.messages?.minlength?"minlength":"minLength";return o?{[l]:o.minlength}:null;case"maxLength":const c=u.Validators.maxLength(i)(t),m=this.config.getValidatorMessage("maxlength")||s.validation?.messages?.maxlength?"maxlength":"maxLength";return c?{[m]:c.maxlength}:null;case"min":return u.Validators.min(i)(t);case"max":return u.Validators.max(i)(t);default:return null}}))(t)}wrapNgValidatorFn(s,e,t){let r;if("string"==typeof e&&(r=g(this.config.getValidator(e))),"object"==typeof e&&e.name&&(r=g(this.config.getValidator(e.name)),e.options&&(r.options=e.options)),"object"==typeof e&&e.expression){const{expression:i,...o}=e;r={name:t,validation:i,options:Object.keys(o).length>0?o:null}}return"function"==typeof e&&(r={name:t,validation:e}),i=>{const o=r.validation(i,s,r.options);return function le(n){return!!n&&"function"==typeof n.then}(o)?o.then(l=>this.handleResult(s,t?!!l:l,r)):(0,y.isObservable)(o)?o.pipe((0,b.map)(l=>this.handleResult(s,t?!!l:l,r))):this.handleResult(s,t?!!o:o,r)}}handleResult(s,e,{name:t,options:r}){"boolean"==typeof e&&(e=e?null:{[t]:r||!0});const i=s.formControl;return i?._childrenErrors?.[t]?.(),F(e)&&Object.keys(e).forEach(o=>{const l=e[o].errorPath?e[o].errorPath:r?.errorPath,c=l?s.formControl.get(l):null;if(c){const{errorPath:m,...h}=e[o];c.setErrors({...c.errors||{},[o]:h}),!i._childrenErrors&&f(i,"_childrenErrors",{}),i._childrenErrors[o]=()=>{const{[o]:w,...A}=c.errors||{};c.setErrors(0===Object.keys(A).length?null:A)}}}),e}}class Ce{prePopulate(s){this.root||(this.root=s),s.parent&&Object.defineProperty(s,"form",{get:()=>s.parent.formControl,configurable:!0})}onPopulate(s){s.hasOwnProperty("fieldGroup")&&!p(s)?f(s,"formControl",s.form):this.addFormControl(s)}postPopulate(s){if(this.root===s&&(this.root=null,this.setValidators(s)&&s.parent)){let t=s.parent;for(;t;)(p(t)||!t.parent)&&P(t.formControl,!0),t=t.parent}}addFormControl(s){let e=K(s);if(!s.fieldArray){if(e){if(e instanceof u.FormControl){const t=p(s)?C(s):s.defaultValue;e.defaultValue=t}}else{const t={updateOn:s.modelOptions.updateOn};if(s.fieldGroup)e=new u.FormGroup({},t);else{const r=p(s)?C(s):s.defaultValue;e=new u.FormControl({value:r,disabled:!!s.props.disabled},{...t,initialValueIsDefault:!0})}}S(s,e)}}setValidators(s,e=!1){!1===e&&p(s)&&s.props?.disabled&&(e=!0);let t=!1;if(s.fieldGroup?.forEach(r=>r&&this.setValidators(r,e)&&(t=!0)),p(s)||!s.parent||!p(s)&&!s.fieldGroup){const{formControl:r}=s;if(r&&(p(s)&&r instanceof u.FormControl&&(e&&r.enabled&&(r.disable({emitEvent:!1,onlySelf:!0}),t=!0),!e&&r.disabled&&(r.enable({emitEvent:!1,onlySelf:!0}),t=!0)),null===r.validator&&this.hasValidators(s,"_validators")&&(r.setValidators(()=>{const i=u.Validators.compose(this.mergeValidators(s,"_validators"));return i?i(r):null}),t=!0),null===r.asyncValidator&&this.hasValidators(s,"_asyncValidators")&&(r.setAsyncValidators(()=>{const i=u.Validators.composeAsync(this.mergeValidators(s,"_asyncValidators"));return i?i(r):(0,y.of)(null)}),t=!0),t)){P(r,!0);let i=r.parent;for(let o=1;o<O(s).length;o++)i&&(P(i,!0),i=i.parent)}}return t}hasValidators(s,e){const t=s.formControl;return!!(t?._fields?.length>1&&t._fields.some(r=>r[e].length>0)||s[e].length>0)||s.fieldGroup?.some(r=>r?.fieldGroup&&!p(r)&&this.hasValidators(r,e))}mergeValidators(s,e){const t=[],r=s.formControl;return r?._fields?.length>1?r._fields.filter(i=>!i._hide).forEach(i=>t.push(...i[e])):s[e]&&t.push(...s[e]),s.fieldGroup&&s.fieldGroup.filter(i=>i?.fieldGroup&&!p(i)).forEach(i=>t.push(...this.mergeValidators(i,e))),t}}class _e{constructor(s){this.config=s,this.formId=0}prePopulate(s){const e=s.parent;this.initRootOptions(s),this.initFieldProps(s),e&&(Object.defineProperty(s,"options",{get:()=>e.options,configurable:!0}),Object.defineProperty(s,"model",{get:()=>p(s)&&s.fieldGroup?C(s):e.model,configurable:!0})),Object.defineProperty(s,"get",{value:t=>U(s,t),configurable:!0}),this.getFieldComponentInstance(s).prePopulate?.(s)}onPopulate(s){this.initFieldOptions(s),this.getFieldComponentInstance(s).onPopulate?.(s),s.fieldGroup&&s.fieldGroup.forEach((e,t)=>{e&&(Object.defineProperty(e,"parent",{get:()=>s,configurable:!0}),Object.defineProperty(e,"index",{get:()=>t,configurable:!0})),this.formId++})}postPopulate(s){this.getFieldComponentInstance(s).postPopulate?.(s)}initFieldProps(s){s.props??(s.props=s.templateOptions),Object.defineProperty(s,"templateOptions",{get:()=>s.props,set:e=>s.props=e,configurable:!0})}initRootOptions(s){if(s.parent)return;const e=s.options;s.options.formState=s.options.formState||{},e.showError||(e.showError=this.config.extras.showError),e.fieldChanges||f(e,"fieldChanges",new y.Subject),e._hiddenFieldsForCheck||(e._hiddenFieldsForCheck=[]),e._markForCheck=t=>{console.warn("Formly: 'options._markForCheck' is deprecated since v6.0, use 'options.detectChanges' instead."),e.detectChanges(t)},e._detectChanges=t=>{t._componentRefs&&W(t),t.fieldGroup?.forEach(r=>r&&e._detectChanges(r))},e.detectChanges=t=>{t.options.checkExpressions?.(t),e._detectChanges(t)},e.resetModel=t=>{t=g(t??e._initialModel),s.model&&(Object.keys(s.model).forEach(r=>delete s.model[r]),Object.assign(s.model,t||{})),d(e,["parentForm","submitted"]).setValue(!1,!1),e.build(s),s.form.reset(s.model)},e.updateInitialValue=t=>e._initialModel=g(t??s.model),s.options.updateInitialValue()}initFieldOptions(s){x(s,{id:ne(`formly_${this.formId}`,s,s.index),hooks:{},modelOptions:{},validation:{messages:{}},props:s.type&&p(s)?{label:"",placeholder:"",disabled:!1}:{}}),this.config.extras.resetFieldOnHide&&!1!==s.resetOnHide&&(s.resetOnHide=!0),"formly-template"!==s.type&&(s.template||s.expressions?.template||s.expressionProperties?.template)&&(s.type="formly-template"),!s.type&&s.fieldGroup&&(s.type="formly-group"),s.type&&this.config.getMergedField(s),p(s)&&!T(s.defaultValue)&&T(C(s))&&!Q(s)&&R(s,s.defaultValue),s.wrappers=s.wrappers||[]}getFieldComponentInstance(s){const e=()=>{let t=this.config.resolveFieldTypeRef(s);const r=s._componentRefs?.slice(-1)[0];return r instanceof a.ComponentRef&&r?.componentType===t?.componentType&&(t=r),t?.instance};return s._proxyInstance||f(s,"_proxyInstance",new Proxy({},{get:(t,r)=>e()?.[r],set:(t,r,i)=>e()[r]=i})),s._proxyInstance}}function q(n){return{types:[{name:"formly-group",component:Y},{name:"formly-template",component:me}],extensions:[{name:"core",extension:new _e(n),priority:-250},{name:"field-validation",extension:new Fe(n),priority:-200},{name:"field-form",extension:new Ce,priority:-150},{name:"field-expression",extension:new be,priority:-100}]}}let ve=(()=>{class n{constructor(e,t=[]){t&&t.forEach(r=>e.addConfig(r))}static forRoot(e={}){return{ngModule:n,providers:[{provide:k,multi:!0,useFactory:q,deps:[_]},{provide:k,useValue:e,multi:!0},_,D]}}static forChild(e={}){return{ngModule:n,providers:[{provide:k,multi:!0,useFactory:q,deps:[_]},{provide:k,useValue:e,multi:!0},D]}}}return n.\u0275fac=function(e){return new(e||n)(a.\u0275\u0275inject(_),a.\u0275\u0275inject(k,8))},n.\u0275mod=a.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=a.\u0275\u0275defineInjector({imports:[[V.CommonModule]]}),n})()}}]);