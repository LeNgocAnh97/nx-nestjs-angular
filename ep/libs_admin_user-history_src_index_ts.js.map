{"version":3,"file":"libs_admin_user-history_src_index_ts.js","mappings":"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","names":["i0","_r2","ctx_r1","handlerAdd","$event","ctx_r3","handlerFunctionControl","ctx_r0","columns","loadData","fields","model","form","functionExportFile","functionParse","IcomLibInventoryListComponent","constructor","datePipe","modalService","this","FormGroup","iComLibsServicesProjectAdminUserService","inject","IComLibsServicesProjectAdminUserService","productService","IComLibsServicesProductService","iComMessageService","IComMessageService","router","Router","params","getUserHistoryList","map","item","creator_info","uploadFile","environment","apiGatewayUrl","suffixAdmin","ngOnInit","endDate","dayjs","format","startDate","subtract","start_time","end_time","className","fieldGroupClassName","fieldGroup","key","type","props","placeholder","viewValue","labelProp","label","valueProp","options","getActivityFeatures","pipe","result","data","expressions","hide","defaultValue","nzAllowClear","getActivityActions","title","pipeArgs","length","omission","actions","name","callback","viewItem","bind","condition","editItem","navigateByUrl","id","_id","deleteItem","confirm","nzTitle","code","nzOkText","nzOkType","nzOkDanger","nzMaskClosable","nzClosable","nzCancelText","event","eventFunctionControl","static","t","i1","i2","core","Xpm","selectors","standalone","features","DecimalPipe","DatePipe","decls","vars","consts","template","rf","ctx","IcomLibInventoryListComponent_icom_libs_core_components_table_2_Template","IcomLibsCoreTableComponent","NgIf","encapsulation","changeDetection"],"sourceRoot":"webpack:///","sources":["./libs/admin/user-history/src/list/list.component.html","./libs/admin/user-history/src/list/list.component.ts"],"sourcesContent":["<div class=\"flex w-full h-full flex-col\">\n  <div nz-row class=\" w-full pr-4 h-full\" style=\"justify-content: end; padding-right: 8px;\">\n    <icom-libs-core-components-table\n      *ngIf=\"loadData\"\n      [columns]=\"columns\"\n      [loadFn]=\"loadData\"\n      [fields]=\"fields\"\n      [model]=\"model\"\n      [form]=\"form\"\n      [displayExportFile]=\"true\"\n      [ignoreButtonAdd]=\"true\"\n      [functionExportFile]=\"functionExportFile\"\n      [functionParse]=\"functionParse\"\n      (icomAdd)=\"handlerAdd()\"\n      (icomFunctionControl)=\"handlerFunctionControl($event)\"\n    ></icom-libs-core-components-table>\n  </div>\n</div>\n\n\n","import { ChangeDetectionStrategy, Component, OnInit, inject } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { FormlyFieldConfig } from '@ngx-formly/core';\nimport { IComLibsServicesProductService, IComLibsServicesProjectAdminUserService } from '@icom/services/projects';\nimport { IcomLibsCoreTableComponent } from '@icom/components/table';\nimport { DatePipe, DecimalPipe, NgIf } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { map } from 'rxjs';\nimport { NzModalService } from 'ng-zorro-antd/modal';\nimport { IComMessageService } from '@icom/services/common';\nimport { uploadFile } from '@icom/defines';\nimport { environment } from 'libs/core/environments/environment';\nimport * as dayjs from 'dayjs';\n@Component({\n  selector: 'icom-libs-admin-user-history',\n  templateUrl: './list.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  standalone: true,\n  imports: [\n    IcomLibsCoreTableComponent,\n    NgIf,\n    \n  ],\n  providers: [DecimalPipe, DatePipe]\n})\nexport class IcomLibInventoryListComponent implements OnInit {\n  form = new FormGroup({});\n  model: any;\n  columns: any[];\n\n  private eventFunctionControl: any;\n\n  protected iComLibsServicesProjectAdminUserService = inject(IComLibsServicesProjectAdminUserService);\n  protected productService = inject(IComLibsServicesProductService);\n  protected iComMessageService = inject(IComMessageService);\n  \n  fields: FormlyFieldConfig[];\n\n  protected router = inject(Router);\n\n  constructor(\n    private datePipe: DatePipe,\n    private modalService: NzModalService,\n\n  ) {\n    this.columns = [];\n    this.fields = [];\n  }\n\n  ngOnInit(): void {\n    const endDate = dayjs().format('YYYY-MM-DD');\n    const startDate = dayjs(endDate).subtract(3, 'month').format('YYYY-MM-DD');\n    \n    this.model = {\n      start_time: startDate,\n      end_time: endDate\n    };\n    this.fields = [\n      {\n        className: 'flex flex-col',\n        fieldGroupClassName: 'flex w-full justify-center',\n        fieldGroup: [\n          {\n            key: 'search',\n            type: 'search-input',\n            className: 'mb-4 basis-6/12',\n            props: {\n              type: 'text',\n              placeholder: 'Tìm kiếm theo số điện thoại, nội dung',\n\n            },\n          },\n        ]\n      },\n      {\n        className: 'flex flex-row flex-wrap',\n        fieldGroupClassName: 'flex w-full',\n        fieldGroup: [\n          {\n            key: 'feature_code',\n            type: 'select-custom',\n            className: 'flex-1',\n            props: {\n              viewValue: 'feature_text',\n              labelProp: 'feature_text',\n              label: 'Tính năng',\n              valueProp: 'feature_code',\n              placeholder: 'Chọn tính năng',\n              options: this.iComLibsServicesProjectAdminUserService.getActivityFeatures().pipe(\n                map(result => {\n                  return result?.data;\n                })\n              )\n            },\n            expressions: {\n              hide: '!formState.hidden'\n            },\n          },\n          {\n            key: 'start_time',\n            className: 'flex-1', \n            defaultValue: this.model.start_time, \n            type: 'date',\n            props: {\n              label: 'Từ',\n              nzAllowClear: false,\n              placeholder: 'DD/MM/YYYY',\n              format: 'dd-MM-yyyy',\n\n            },\n            expressions: { hide: '!formState.hidden' },\n          },\n        ],\n      },\n      {\n        className: 'flex flex-row flex-wrap',\n        fieldGroupClassName: 'flex w-full',\n        fieldGroup: [\n          {\n            key: 'action_code',\n            type: 'select-custom',\n            className: 'flex-1 ',\n            props: {\n              placeholder: 'Kho chuyển',\n              label: 'Thao tác',\n              viewValue: 'action_text',\n              labelProp: 'action_text',\n              valueProp: 'action_code',\n              options: this.iComLibsServicesProjectAdminUserService.getActivityActions().pipe(\n                map(result => {\n                  return result?.data;\n                })\n              )\n            },\n            expressions: {\n              hide: '!formState.hidden'\n            },\n          },\n          {\n            key: 'end_time',\n            className: 'flex-1', \n            type: 'date',\n            defaultValue: this.model.end_time, \n            props: {\n              label: 'Đến',\n              nzAllowClear: false,\n              placeholder: 'DD/MM/YYYY',\n              format: 'dd-MM-yyyy',\n            },\n            expressions: { hide: '!formState.hidden' },\n          },\n        ]\n      },\n    ];\n    this.columns = [\n      { title: 'STT', type: 'index' },\n      { title: 'Số điện thoại hội viên', key: 'username', type: 'text' },\n      { title: 'Tính năng', key: 'feature_text', type: 'text' },\n      { title: 'Thời gian', key: 'created_at', type: 'text', pipe: 'time' },\n      { title: 'Thao tác', key: 'action_text', type: 'text' },\n      {\n        title: 'Nội dung',\n        key: 'content',\n        type: 'text',\n        pipe: 'truncate',\n        pipeArgs: [{ length: 50, omission: '…' }]\n      },\n      { title: 'Địa chỉ IP', key: 'ip_address', type: 'text' },\n      { title: 'Thiết bị', key: 'device', type: 'text' },\n      { title: 'Hệ điều hành', key: 'operating_system', type: 'text' },\n      {\n        title: 'Thao tác',\n        key: 'actions',\n        type: 'action',\n        actions: [\n          {\n            name: 'Xem',\n            callback: this.viewItem.bind(this),\n            condition: () => {\n              return true;\n            }\n          },\n        ],\n      },\n    ];\n  }\n\n\n  loadData = (params: any) => {\n    return this.iComLibsServicesProjectAdminUserService.getUserHistoryList(params);\n  }\n\n  functionParse = (params: any) => {\n    return params?.map((item: any) => {\n      return {\n        ...item,\n        ...item.creator_info,\n      }\n    })\n  }\n\n  functionExportFile = (params: any) => {\n    uploadFile(`${environment.apiGatewayUrl}${environment.suffixAdmin}/v2.0/export/activity_logs`, 'MauFileExportLichSuThaoTac', this.iComMessageService\n    ,params, false, true);\n  }\n\n  editItem(data: any): void {\n    this.router.navigateByUrl(`inventory/transfer/detail?id=${data.id}&mode=edit`);\n  }\n\n  viewItem(data: any): void {\n    this.router.navigateByUrl(`admin/user-history/detail?id=${data._id}&mode=view`);\n  }\n\n  protected deleteItem(data: any) {\n    this.modalService.confirm(\n      {\n        nzTitle: `Bạn có chắc chắn muốn xóa ${data?.code} ?`,\n        nzOkText: 'Đồng ý',\n        nzOkType: 'primary',\n        nzOkDanger: true,\n        nzMaskClosable: false,\n        nzClosable: false,\n        // nzOnOk: this.processDeleteSection.bind(this, data),\n        nzCancelText: 'Hủy bỏ',\n      },\n      'error'\n    );\n  }\n\n  handlerAdd() {\n    this.router.navigateByUrl(`inventory/transfer/detail?mode=add`);\n  }\n\n  handlerFunctionControl(event: any) {\n    this.eventFunctionControl = event;\n  }\n}\n"],"x_google_ignoreList":[]}